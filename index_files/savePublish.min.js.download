define("savePublish/utils/failedPanelUtil",["lodash"],function(e){"use strict";return{extractDocumentErrorCode:function(t){return e.get(t,"document.errorCode")},extractDocumentErrorType:function(t){return e.get(t,"document.errorType")}}}),define("savePublish/constants/savePublishErrorPanelData",[],function(){"use strict";return{SITE_NAME_TAKEN_PANEL_DATA:{titleKey:"ERROR_SITE_NOT_RENAMED_TITLE_LABEL",description:"ERROR_SITE_NOT_RENAMED_BODY_SUBTITLE",steps:["ERROR_SITE_NOT_RENAMED_STEP1_TEXT","ERROR_SITE_NOT_RENAMED_STEP2_TEXT","ERROR_SITE_NOT_RENAMED_STEP3_TEXT"],stepsTitle:"ERROR_SITE_NOT_RENAMED_TRY_STEPS"},SAVE_DISABLED_ON_SERVER_PANEL_DATA:{titleKey:"SAVE_ERROR_TITLE_LABEL",description:"Save_Publish_ServerErrorLabel_OnSave",showSteps:!1,showFooterText:!1},USER_NOT_AUTHORIZED_FOR_SITE:{titleKey:"SAVE_ERROR_17_TITLE",description:"SAVE_ERROR_17_DESCRIPTION_HEADER",steps:["SAVE_ERROR_17_DESCRIPTION_STEP1","SAVE_ERROR_17_DESCRIPTION_STEP2","SAVE_ERROR_17_DESCRIPTION_STEP3"],helpMessage:"SAVE_ERROR_LEARN_MORE_LABEL",helpLinkMessage:"SAVE_ERROR_LEARN_MORE_LINK"},NOT_LOGGED_IN:{titleKey:"SAVE_ERROR_15_TITLE",description:"SAVE_ERROR_15_DESCRIPTION_HEADER",steps:["SAVE_ERROR_15_DESCRIPTION_STEP1","SAVE_ERROR_15_DESCRIPTION_STEP2","SAVE_ERROR_15_DESCRIPTION_STEP3"],helpMessage:"SAVE_ERROR_LEARN_MORE_LABEL",helpLinkMessage:"SAVE_ERROR_LEARN_MORE_LINK"},PUBLISH_DISABLED_ON_SERVER_PANEL_DATA:{titleKey:"PUBLISH_ERROR_TITLE_LABEL",description:"Save_Publish_ServerErrorLabel_OnPublish",showSteps:!1,showFooterText:!1},NAME_SITE_AGAIN_PANEL_DATA:{titleKey:"ERROR_NAME_SITE_AGAIN_TITLE_LABEL",description:"ERROR_NAME_SITE_AGAIN_SUBTITLE",steps:["ERROR_NAME_SITE_AGAIN_STEP1_TEXT","ERROR_NAME_SITE_AGAIN_STEP2_TEXT","ERROR_NAME_SITE_AGAIN_STEP3_TEXT"],stepsTitle:"ERROR_NAME_SITE_AGAIN_TRY_STEPS"},SAVE_ERROR_DEFAULT_PANEL_DATA:{titleKey:"SAVE_ERROR_TITLE_LABEL",description:"SAVE_PUBLISH_ERROR_BODY_DESCRIPTION",steps:["SAVE_PUBLISH_SAVE_ERROR_OPTION_1","SAVE_PUBLISH_SAVE_ERROR_OPTION_2"],stepsTitle:"SAVE_PUBLISH_ERROR_BODY_DESCRIPTION_BOLD",helpMessage:"SAVE_ERROR_LEARN_MORE_LABEL",helpLinkMessage:"SAVE_PUBLISH_ERROR_LEARN_MORE_LINK",helpLink:"8045e8e4-6f47-4913-8d74-6239f21fffec"},PUBLISH_ERROR_DEFAULT_PANEL_DATA:{titleKey:"PUBLISH_ERROR_TITLE_LABEL",description:"SAVE_PUBLISH_ERROR_BODY_DESCRIPTION",steps:["SAVE_PUBLISH_ERROR_OPTION_1","SAVE_PUBLISH_ERROR_OPTION_2"],helpMessage:"PUBLISH_ERROR_LEARN_MORE_LABEL",helpLinkMessage:"SAVE_PUBLISH_ERROR_LEARN_MORE_LINK",helpLink:"3de8a931-e665-4c9f-bcb3-7096ea89f9e3"},VALIDATION_ERROR:{titleKey:"AUTOSAVE_VALIDATION_ERROR_TITLE_LABEL",description:"AUTOSAVE_VALIDATION_ERROR_SENT1",showSteps:!1,helpMessage:"AUTOSAVE_ERROR_LEARN_MORE_LABEL",helpLinkMessage:"AUTOSAVE_ERROR_HELP_CENTER",helpLink:"c525bfda-f732-4fc1-9b9e-7a919d38721d",confirmLabel:"AUTOSAVE_VALIDATION_ERROR_BTN_RELOAD"}}}),define("savePublish/managers/saveManager",["lodash","core","util","savePublish/utils/failedPanelUtil","baseUI","stateManagement","savePublish/constants/savePublishErrorPanelData","experiment"],function(e,t,n,s,i,a,o,r){"use strict";function l(l,u){function p(){for(var t=l.documentServices.siteName.getUsed(),s=n.translate("Save_Publish_Site_Default_Name"),i=l.siteName.sanitize(s.slice(0,20).replace(/\-$/,"").replace(/_/g,"-")),a=1;e.includes(t,i);){var o="-"+a;i=s.slice(0,20-o.length).replace(/\-$/,"").replace(/_/g,"-")+o,a++}return i}function h(n,s){switch(s){case l.documentServices.errors.save.SITE_NAME_TAKEN:_(n,o.SITE_NAME_TAKEN_PANEL_DATA);break;case l.documentServices.errors.save.SAVE_PUBLISH_DISABLED_ON_SERVER:_(n,o.SAVE_DISABLED_ON_SERVER_PANEL_DATA);break;case l.documentServices.errors.save.NOT_LOGGED_IN:_(n,o.NOT_LOGGED_IN);break;case l.documentServices.errors.save.USER_NOT_AUTHORIZED_FOR_SITE:_(n,o.USER_NOT_AUTHORIZED_FOR_SITE);break;case l.documentServices.errors.save.DUPLICATE_COMPONENTS:case l.documentServices.errors.save.DATA_REFERENCE_MISMATCH:case l.documentServices.errors.save.MISSING_CONTAINERS:var i=e.partial(m,n);V=window.setInterval(i,t.constants.SAVE_PUBLISH.VALIDATION_ERROR_POPUP_INTERVAL),i();break;default:_(n,o.SAVE_ERROR_DEFAULT_PANEL_DATA)}}function m(t){if(!U([k.SAVE_FAILED])){var s=n.windowInteractionUtils.reloadPageWithoutQuestion;_(t,e.assign({},o.VALIDATION_ERROR,{onConfirm:s}))}}function d(t){return new Promise(function(n,s){var i="autosave"===t?s:n,a=e.partial(N,n,s,t);l.panelManager.openPanel(k.CONCURRENT_SAVE,{overrideSaveMethod:a,onCancel:i,origin:t},!0)})}function _(n,i){var a=t.bi.events.save.saveFailed,r=e.get(l.savePublish.getSiteState(),"isFirstSave"),c={errorCode:n&&s.extractDocumentErrorCode(n),biConfirm:r?a.First_Save_error_work_not_saved_error_ok_click:null,biHelp:r?a.First_Save_error_work_not_saved_error_help_center_link_click:null,biCancel:r?a.First_Save_error_work_not_saved_error_close_click:null},u=e({}).assign(i).defaults(o.SAVE_ERROR_DEFAULT_PANEL_DATA).assign(c).value();l.panelManager.openPanel(k.SAVE_FAILED,u,!0)}function S(t,n,s){return new Promise(function(i){if(l.account.isUserOwner()&&!l.wixStores.isSiteInWixStoreTestDrive()){var a=e.merge({},l.savePublish.getSiteState(),t);a.overrideTitle=n,a.overrideSubtitle=s,a.callback=i,l.panelManager.openPanel(k.SITE_WAS_SAVED,a,!0)}else i()})}function E(t){return new Promise(function(n,s){t=e(t).pick(["overrideTitle","overrideSubtitle"]).assign({defaultSiteName:p(),freeDomainPrefix:c.getFreeDomainPrefix(y.getState(),l.documentServices),connectDomainHandler:e.partial(f,t,n,s),freeDomainHandler:e.partial(b,t,n,s)}).value(),l.panelManager.openPanel(k.CHOOSE_DOMAIN,t,!0)})}function P(n){return new Promise(function(s){var i=l.savePublish.getSiteState();l.panelManager.openPanel("savePublish.panels.connectDomain",{title:"SAVE_SITE_SAVED_TITLE_TITLE",subtitle:"PREMIUM_TITLE_SUBTITLE",onConnectDomainFlowEnded:e.partial(s,n),isFirstSave:i.isFirstSave,isFirstPublish:!i.isSitePublished,isPremium:i.isSitePremium,flowId:t.constants.CONNECT_DOMAIN.FLOWS.SAVE},!0)})}function b(e,t,n,s){T(s,e.origin,e).then(function(e){if(!e.preventSiteWasSavedPanel)return S()}).then(t).catch(n)}function v(e){return new Promise(function(t,n){l.site.getSiteDomainInfo(function(s){var i={isDomainConnected:s.isDomainConnected,isSitePremium:s.isSitePremium};s.isDomainConnected&&s.isSitePremium&&s.sitePublishedDomain&&(i.domain=s.sitePublishedDomain,l.documentServices.generalInfo.setPublicUrl(s.sitePublishedDomain)),l.savePublish.setSitePremiumState(i),e.preventSiteWasSavedPanel?t(e):S(i,w.SITE_SAVED_WELCOME_BACK_TITLE,w.SITE_SAVED_WELCOME_BACK_SUBTITLE).then(t).catch(n)},function(){e.preventSiteWasSavedPanel?t(e):S().then(t)})})}function f(e,t,n){T(p(),e.origin,e).then(P).then(v).then(t).catch(n)}function I(e,t,n){function i(){l.savePublish.setSaveProgress(!1),l.bi.tryFlushingConditionedEvents()}return n=n||{},l.savePublish.isSaveInProgress()?Promise.reject():(l.savePublish.setSaveProgress(!0),window.clearInterval(V),l.savePublish.save(e,t,n).then(function(e){return i(),("publish"===t||n.isPublish)&&r.isOpen("se_fixPublishFlow")?{preventSiteWasSavedPanel:!0}:e||{}}).catch(function(e){i();var n=s.extractDocumentErrorType(e);if(n===l.documentServices.errors.save.CONCURRENT_SAVE)return d(t).then(function(){return{preventSiteWasSavedPanel:!0}});throw h(e,n),e}))}function N(e,t,s){"autosave"===s&&n.fedopsLogger.interactionStarted(n.fedopsLogger.INTERACTIONS.UI_SAVE),I(!0,s).then(function(e){if(!e.preventSiteWasSavedPanel)return S()}).then(e).catch(t)}function T(t,i,a){if(!l.savePublish.isSaveInProgress())return l.siteName.set(t),I(!0,i,a).then(function(t){return function(){var t=l.documentServices.generalInfo.getSiteId(),s=l.documentServices.generalInfo.getMetaSiteId(),i=n.url.parseUrl(window.location.href).query;delete i.siteId,i.metaSiteId=s;var a=e.template(H)({siteId:t});a=n.url.setUrlParams(a,i),n.windowInteractionUtils.replaceState({},"",a)}(),e.size(l.documentServices.wixapps.classics.getAllAppPartComps("blog"))>0&&l.documentServices.wixapps.classics.reloadApp("blog"),t},function(e){throw function(e){return l.documentServices.errors.save.SITE_NAME_TAKEN===s.extractDocumentErrorType(e)}(e)&&l.siteName.markAsUsed(t),e})}function A(){return new Promise(function(t){l.panelManager.openPanel(k.ON_BOARDING_MIGRATION,{onConfirm:t,onCancel:e.partial(t,"back_to_ADI")},!0)})}function g(){return l.documentServices.generalInfo.isSiteFromOnBoarding()}function O(){if(r.isOpen("se_fixPublishFlow")){var e=t.constants.USER_PREFS.SAVE.SHOW_CONNECT_DOMAIN;return a.userPreferences.selectors.getSessionUserPreferences(e)(l.store.getState())}}function C(e){if(r.isOpen("se_fixPublishFlow")){var n=t.constants.USER_PREFS.SAVE.SHOW_CONNECT_DOMAIN;l.store.dispatch(a.userPreferences.logic.setSessionUserPreferences(n,e))}}function R(n){var s=(n=n||{}).origin||"";if(!l.savePublish.canSaveOrPublish())return u.error("Site is being saved or published!"),Promise.resolve();if(r.isOpen("se_obMigrationFlow")&&!e.get(n,"forceOBMigration")&&g())return A().then(function(t){if("back_to_ADI"!==t)return R(e.defaults({forceOBMigration:!0},n))});var i=l.savePublish.getSiteState();if(i&&i.isFirstSave||O())return r.isOpen("googleDomain")&&c.doesUserOwnGoogleDomain()?T(p(),s,n).then(function(e){if(!e.preventSiteWasSavedPanel)return S()}):E(n).then(function(){C(!1)});return I(!1,n.origin).then(function(e){var n=t.constants.USER_PREFS.SAVE.SITE_SAVED_DONT_SHOW_AGAIN;if(!0!==a.userPreferences.selectors.getSessionUserPreferences(n)(l.store.getState())&&!e.preventSiteWasSavedPanel)return S({},"SAVE_SITE_SAVED_SMALL_TITLE_TITLE","SAVE_SITE_SAVED_SMALL_TITLE_SUBTITLE")})}function D(t,n){if(n=n||{},r.isOpen("se_obMigrationFlow")&&!e.get(n,"forceOBMigration")&&g())return A().then(function(s){if("back_to_ADI"!==s)return D(t,e.defaults({forceOBMigration:!0},n))});var s=l.savePublish.getSiteState();return s&&s.isFirstSave?T(p(),t,n).then(function(){C(!0)}):O()?E(n).then(function(){C(!1)}):I(!1,t,n)}function L(){function n(){l.documentServices.generalInfo.isFirstSave()&&(!l.savePublish.canSaveOrPublish()||U(a)||l.zoomMode.isInZoomMode()||(l.panelManager.openPanel(k.SAVE_REMINDER,{saveMethod:e.partial(R,l,{origin:"remember_to_save_active_save_popup"})},!0),window.clearTimeout(o)),window.setTimeout(n,t.constants.SAVE_PUBLISH.SAVE_REMINDER_TIMEOUT))}function s(){l.documentServices.generalInfo.isFirstSave()&&(!l.savePublish.canSaveOrPublish()||U(a)||l.zoomMode.isInZoomMode()||(i.tooltipManager.showForDuration("save-button-tooltip",t.constants.SAVE_PUBLISH.SAVE_TOOLTIP_DURATION),l.bi.event(t.bi.events.save.saveReminder.REMINDER_DISPLAYED,{origin:"save tool-tip"})),o=window.setTimeout(s,t.constants.SAVE_PUBLISH.SAVE_TOOLTIP_TIMEOUT))}var a=[k.SAVE_REMINDER,k.CHOOSE_DOMAIN];window.setTimeout(n,t.constants.SAVE_PUBLISH.SAVE_REMINDER_TIMEOUT);var o=window.setTimeout(s,t.constants.SAVE_PUBLISH.SAVE_TOOLTIP_TIMEOUT);r.isOpen("se_obMigrationFlow")&&e.invoke(l,"documentServices.generalInfo.isSiteFromOnBoarding")&&window.setTimeout(function(){i.tooltipManager.showForDuration("save-button-tooltip",t.constants.SAVE_PUBLISH.SAVE_TOOLTIP_DURATION)},2e3)}function U(t){return e.some(l.panelManager.getOpenPanels(),function(n){return e.includes(t,n.name)})}function M(t,n){function s(e,t){l.savePublish.setSaveProgress(!1),l.savePublish.setPublishProgress(!1),e&&e(t)}l.documentServices&&l.documentServices.generalInfo&&l.documentServices.generalInfo.getUserInfo().isStudio?(l.savePublish.isSaveInProgress()&&n(),l.savePublish.setSaveProgress(!0),l.savePublish.setPublishProgress(!0),function(){var t=l.documentServices.pages.getPageIdList();e.forEach(t,function(e){B(e,"desktop"),B(e,"mobile")})}(),l.savePublish.saveAsTemplate(e.partial(s,t),e.partial(s,n))):u.info("Failed saving as template. User has no permissions to save as template")}function B(e,t){var n=l.documentServices.pages.background.get(e,t);n&&!n.isPreset&&(n.isPreset=!0,l.pages.background.update(e,n,t))}var y=l.store,k={ON_BOARDING_MIGRATION:"savePublish.panels.save.onBoardingMigrationConfirmationPanel",CHOOSE_DOMAIN:"savePublish.panels.save.chooseDomainPanel",SITE_WAS_SAVED:"savePublish.panels.save.siteWasSavedPanel",SAVE_FAILED:"savePublish.panels.common.failPanel",CONCURRENT_SAVE:"savePublish.panels.save.concurrentSavePanel",SAVE_REMINDER:"savePublish.panels.save.saveReminderPanel"},w={SITE_SAVED_WELCOME_BACK_TITLE:"SAVE_SITE_SAVED_WELCOME_BACK_TITLE",SITE_SAVED_WELCOME_BACK_SUBTITLE:"SAVE_SITE_SAVED_WELCOME_BACK_SUBTITLE"},H=(n.serviceTopology.editorServerRoot||"//editor.wix.com/html/editor/web")+"/renderer/edit/<%= siteId %>",V=void 0;return{save:R,saveInBackground:D,saveAsTemplate:M,setTimerForSaveReminder:e.once(L),openConcurrentSavePanel:d,displayFailurePanelMatchingAnErrorType:h}}var c=a.domain.selectors;return l}),define("savePublish/managers/saveManagerWrapper",["lodash","util","savePublish/managers/saveManager"],function(e,t,n){"use strict";return function(s,i){var a=n(s,i);return{save:function(n){(n=n||{}).origin=n.origin||"";var s=n.callback||e.noop,i=n.onError||e.noop;"publish"!==n.origin&&t.fedopsLogger.interactionStarted(t.fedopsLogger.INTERACTIONS.UI_SAVE),a.save(n).then(function(){s(),"publish"!==n.origin&&t.fedopsLogger.interactionEnded(t.fedopsLogger.INTERACTIONS.UI_SAVE)}).catch(i)},saveInBackground:function(e,n,o,r){s.savePublish.canSaveOrPublish()?((r=r||{}).isPublish||(t.fedopsLogger.interactionStarted(t.fedopsLogger.INTERACTIONS.BG_SAVE),r.isSilent=!0),a.saveInBackground(o,r).then(function(){e(),r.isPublish||t.fedopsLogger.interactionEnded(t.fedopsLogger.INTERACTIONS.BG_SAVE)}).catch(n)):i.error("Site is being saved or published!")},saveAsTemplate:a.saveAsTemplate,setTimerForSaveReminder:e.once(a.setTimerForSaveReminder),openConcurrentSavePanel:function(e,n,s){a.openConcurrentSavePanel(s).then(function(n){t.fedopsLogger.interactionEnded(t.fedopsLogger.INTERACTIONS.UI_SAVE),e(n)}).catch(function(e){n(e)})},displayFailurePanelMatchingAnErrorType:a.displayFailurePanelMatchingAnErrorType}}}),define("savePublish/constants/constants",["experiment"],function(e){"use strict";function t(e,t){return/^config\d+$/.test(e)?Number(e.replace("config","")):t}var n=e.getValue("se_autosaveActionCount"),s=e.getValue("se_saveAfterAutosaveCount"),i=e.getValue("se_autosaveInterval");return n=t(n,2),s=t(s,3),i=t(i,5),{ERROR_CODES:{SAVE_PUBLISH_DISABLED_ON_SERVER:-10132},SAVE:{SAVE_FAILED_HELP_LINK:"8045e8e4-6f47-4913-8d74-6239f21fffec"},AUTOSAVE:{AUTOSAVE_TIMEOUT:i,AUTOSAVE_ACTION_COUNT:n,SAVE_AFTER_AUTOSAVE_COUNT:s,DEBOUNCE_WAIT:2},RENAME:{ERRORS:{SITE_NAME_TAKEN:-40003}}}}),define("savePublish/managers/autosaveManager",["lodash","util","core","experiment","constants","savePublish/constants/constants","savePublish/utils/failedPanelUtil"],function(e,t,n,s,i,a,o){"use strict";return function(r){function l(){var e=t.url.isQA(),n="true"===t.url.getParameterByName("forceAutosave");return e&&!n}function c(t){return e(["CONCURRENT_SAVE","CONCURRENT_AUTO_SAVE","SITE_STALE_STATE_FROM_AUTO_SAVE"]).map(e.propertyOf(r.documentServices.errors.save)).includes(o.extractDocumentErrorType(t))}function u(t,n){var s=void 0;s="autosave"===t?n?"autosaveSuccessCount":"autosaveFailCount":n?"autoFullSaveSuccessCount":"autoFullSaveFailCount",e.isNaN(Number(window.testApi[s]))&&(window.testApi[s]=0),window.testApi[s]++}function p(){r.savePublish.setDiffSaveProgress(!0),b()&&r.updateState({savingStatus:f.IN_PROGRESS})}function h(i,a){var o=i?f.DONE_FAILED:f.DONE_SUCCESS,l=i?f.IDLE:f.IDLE_SAVED;if(r.savePublish.setDiffSaveProgress(!1),b()&&(r.updateState({savingStatus:o}),window.setTimeout(function(){r.updateState({savingStatus:l})},n.constants.SAVE_PUBLISH.DURATION_TO_SHOW_RESULT)),i&&c(i)){var p=r.documentServices.getAutoSaveInfo();s.isOpen("showConcurrentAutosaveDialog")?r.saveManager.openConcurrentSavePanel(e.noop,E,"autosave"):p&&p.shouldRestoreDiffs||r.documentServices.initAutosave(S({enabled:!1}))}r.bi.event(n.bi.events.save.autosave.DIFF_SAVED,{type:a,success:!i}),t.url.isQA()&&"undefined"!=typeof window&&window.testApi&&u("autosave",!i),_()}function m(){b()&&(r.savePublish.setSaveProgress(!0),r.updateState({savingStatus:f.IN_PROGRESS}))}function d(i){var a=i?f.DONE_FAILED:f.DONE_SUCCESS,o=i?f.IDLE:f.IDLE_SAVED;b()&&(r.savePublish.setSaveProgress(!1),r.updateState({savingStatus:a}),window.setTimeout(function(){r.updateState({savingStatus:o})},n.constants.SAVE_PUBLISH.DURATION_TO_SHOW_RESULT)),i&&(c(i)&&s.isOpen("showConcurrentAutosaveDialog")?r.saveManager.openConcurrentSavePanel(e.noop,E,"autosave"):r.saveManager.displayFailurePanelMatchingAnErrorType(i)),t.url.isQA()&&"undefined"!=typeof window&&window.testApi&&u("autoFullSave",!i),_()}function _(){r.bi.tryFlushingConditionedEvents()}function S(t){return e.assign({},{enabled:!0},{onDiffSaveStarted:p,onDiffSaveFinished:h,onPartialSaveStarted:m,onPartialSaveFinished:d},a.AUTOSAVE,t)}function E(){t.windowInteractionUtils.reloadPageWithoutQuestion()}function P(){if(b()){var e=i.ROOT_COMPS.TOPBAR.DROP_PANELS.CUSTOM.AUTO_SAVE;r.topBarMenuBar.openDropDown(e),window.setTimeout(r.topBarMenuBar.closeDropDown.bind(r,e),n.constants.SAVE_PUBLISH.SITE_AUTO_SAVED_TOOLTIP_DURATION)}}function b(){var e=r.documentServices;if(!e)return!1;var t=e.getAutoSaveInfo(),n=t&&t.shouldAutoSave,i=v();return s.isOpen("se_autosaveUI")&&n&&!i}function v(){return r.documentServices.wixCode.isProvisioned()||r.developerMode.isEnabled()}var f=n.constants.PROGRESS_STATUS;return{init:function(e,t){var n=!e||e.enable,s=l()||v();if(n&&s)return!1;var i=S(e);r.documentServices.initAutosave(i);var a=r.documentServices.generalInfo.isSiteFromOnBoarding();return!t&&i.enabled&&b()&&!a&&P(),i},getAutosaveConfig:S,showSiteAutoSavedTooltipIfNeeded:P,shouldShowAutosaveUI:b,isAutomationWithoutAutosave:l}}}),define("savePublish/managers/mockSaveManager",["lodash","core","savePublish/constants/savePublishErrorPanelData","coreUtilsLib"],function(e,t,n,s){"use strict";function i(){for(var t=m.documentServices.siteName.getUsed(),n=m.documentServices.siteName.get(),s=n.slice(0,20),i=1;e.includes(t,s);){var a="-"+i;s=n.slice(0,20-a.length)+a,i++}return s}function a(){m.panelManager.openPanel(h.SAVE_FAILED,n.SAVE_ERROR_DEFAULT_PANEL_DATA,!0)}function o(t,n){var s=e.clone(d);s.isMockSave=!0,s.overrideTitle=t,s.overrideSubtitle=n,m.panelManager.openPanel(h.SITE_WAS_SAVED,s,!0)}function r(t){d.shouldSaveSucceed?(c(),function(t){d=e.merge(d||{},t)}({domain:p+t}),o()):a()}function l(){d.shouldSaveSucceed?(c(),function(){m.panelManager.openPanel("savePublish.panels.connectDomain",{title:"SAVE_SITE_SAVED_TITLE_TITLE",subtitle:"PREMIUM_TITLE_SUBTITLE",onConnectDomainFlowEnded:o.bind(this,"SAVE_SITE_SAVED_WELCOME_BACK_TITLE","SAVE_SITE_SAVED_WELCOME_BACK_SUBTITLE"),isFirstSave:!0,isFirstPublish:!0,isPremium:d.isSitePremium,flowId:t.constants.CONNECT_DOMAIN.FLOWS.SAVE},!0)}()):a()}function c(){s.log.info("First Save Was Performed!")}function u(t){function n(t){t.isDomainConnected||(t.domain=p+i()),function(t){d=e.clone(t)}(t),t.isFirstSave?function(){var e={defaultSiteName:i(),freeDomainPrefix:p,connectDomainHandler:l,freeDomainHandler:r};m.panelManager.openPanel(h.CHOOSE_DOMAIN,e,!0)}():t.shouldSaveSucceed?(s.log.info("Save Was Performed!"),o("SAVE_SITE_SAVED_SMALL_TITLE_TITLE","SAVE_SITE_SAVED_SMALL_TITLE_SUBTITLE")):a()}(m=t).panelManager.openPanel("savePublish.panels.save.saveConfigurationPanel",{onConfirm:n},!0)}var p="http://www.wix.com/",h={CHOOSE_DOMAIN:"savePublish.panels.save.chooseDomainPanel",SITE_WAS_SAVED:"savePublish.panels.save.siteWasSavedPanel",SAVE_FAILED:"savePublish.panels.common.failPanel",CONCURRENT_SAVE:"savePublish.panels.save.concurrentSavePanel"},m=null,d=null;return{save:u}}),define("savePublish/panels/publish/publishInnerPanelTypes",["core"],function(e){"use strict";var t=e.constants.USER_PREFS.PUBLISH;return{EMPTY:{name:"EMPTY"},SHOUTOUT:{name:"SHOUTOUT",userPref:t.SHOUTOUT_DONT_SHOW_AGAIN},CONNECT_DOMAIN:{name:"CONNECT_DOMAIN",userPref:t.CONNECT_DOMAIN_DONT_SHOW_AGAIN},GROW_BUSINESS:{name:"GROW_BUSINESS",userPref:t.GROW_BUSINESS_DONT_SHOW_AGAIN},MUSIC_PROMO:{name:"MUSIC_PROMO",userPref:t.MUSIC_PROMO_DONT_SHOW_AGAIN},PHOTOGRAPHY_PROMO:{name:"PHOTOGRAPHY_PROMO",userPref:t.PHOTOGRAPHY_PROMO_DONT_SHOW_AGAIN}}}),define("savePublish/managers/publishManager",["lodash","core","util","coreUtilsLib","savePublish/utils/failedPanelUtil","savePublish/constants/savePublishErrorPanelData","savePublish/panels/publish/publishInnerPanelTypes","stateManagement","experiment"],function(e,t,n,s,i,a,o,r,l){"use strict";function c(c){function p(){n.fedopsLogger.interactionEnded(n.fedopsLogger.INTERACTIONS.USER_PUBLISH_SITE)}function h(){function t(){function t(){!function(e,t){c.site.getSiteDomainInfo(function(t){var n=t.isDomainConnected,s=t.sitePublishedDomain;e({sitePremiumDomain:s,isDomainConnected:n})},t)}(function(t){S(e.assign(n,t)),d()},d),p()}var n={isFirstSave:c.documentServices.generalInfo.isFirstSave(),isPremiumUser:c.site.isPremium(),isFirstPublish:!c.documentServices.generalInfo.isSitePublished()};c.savePublish.publish().then(t,m)}c.savePublish.canSaveOrPublish()&&(c.account.isUserOwner()&&!c.wixStores.isSiteInWixStoreTestDrive()?(c.savePublish.setPublishProgress(!0),t()):c.savePublish.publish().then(function(){d(),p()},m))}function m(e){switch(i.extractDocumentErrorType(e)){case c.documentServices.errors.save.SAVE_PUBLISH_DISABLED_ON_SERVER:_(e,a.PUBLISH_DISABLED_ON_SERVER_PANEL_DATA);break;default:_(e,a.PUBLISH_ERROR_DEFAULT_PANEL_DATA)}d()}function d(){c.savePublish.setPublishProgress(!1)}function _(n,s){var o={errorCode:i.extractDocumentErrorCode(n),biConfirm:t.bi.events.publish.Publish_Work_not_Published_Error_ok_Click,biHelp:t.bi.events.publish.Publish_Work_not_Published_Error_Help_Center_Link_Click},r=e.chain(s).clone().defaults(a.PUBLISH_ERROR_DEFAULT_PANEL_DATA).assign(o).value();c.panelManager.openPanel(g,r,!0)}function S(t){var n=c.documentServices.generalInfo.getPublicUrl()||u.getFreeDomainPrefix(N.getState(),c.documentServices)+c.siteName.get();n=t.isDomainConnected?t.sitePremiumDomain:n;var s=function(e){var t=o.EMPTY;if(!e.isPremiumUser&&e.isDomainConnected)return t;var n=f();if(E()){var s=n[o.MUSIC_PROMO.name].dontShowAgain;t=!s||e.isFakePublish?o.MUSIC_PROMO:o.EMPTY}else if(P()){var i=n[o.PHOTOGRAPHY_PROMO.name].dontShowAgain;t=!i||e.isFakePublish?o.PHOTOGRAPHY_PROMO:o.EMPTY}else if(b(e))t=o.CONNECT_DOMAIN;else{var a=v(e,n);if(a.length){var r=c.store.getState().savePublish.publishPanelPromotionIndex;t=a[r%a.length]||o.EMPTY}}return t}(t);if(function(e){return!E()&&!P()&&!b(e)}(t)&&function(t){var n=c.store.getState(),s=v(t,f()),i=(n.savePublish.publishPanelPromotionIndex+1)%(s.length||1);c.updateState(e.merge({},n.savePublish,{savePublish:{publishPanelPromotionIndex:i}}))}(t),!e.isEqual(s,o.EMPTY)){var i={isFakePanel:t.isFakePublish,contentPanelType:s,configuration:t,currentDomain:c.site.getCurrentSiteDomain(),setDontShowPanelValue:function(e){return c.store.dispatch(r.userPreferences.logic.setSessionUserPreferences(s.userPref,e))},sitePublicUrl:n,closePanel:I};c.panelManager.openPanel(A,i,!0)}}function E(){return l.isOpen("musicPromotionFixed")&&c.promotions.music.isActive()}function P(){return l.isOpen("photographyPromotionFixed")&&c.promotions.photography.isActive()}function b(e){return e.isFirstPublish&&!e.isDomainConnected}function v(e,t){var n=[],s=function(e,t){var n=t[o.CONNECT_DOMAIN.name].dontShowAgain;return!e.isDomainConnected&&(!n||e.isFakePublish)}(e,t),i=function(e,t){var n=t[o.MUSIC_PROMO.name].dontShowAgain;return l.isOpen("musicPromotionRotation")&&c.promotions.music.isActive()&&(!n||e.isFakePublish)}(e,t),a=function(e,t){var n=t[o.PHOTOGRAPHY_PROMO.name].dontShowAgain;return l.isOpen("photographyPromotionRotation")&&c.promotions.photography.isActive()&&(!n||e.isFakePublish)}(e,t),r=function(e,t){var n=t[o.SHOUTOUT.name].dontShowAgain;return!e.isDomainConnected&&(!n||e.isFakePublish)}(e,t),u=function(e,t){var n=t[o.GROW_BUSINESS.name].dontShowAgain;return e.isPremiumUser&&e.isDomainConnected&&(!n||e.isFakePublish)}(e,t);return s&&n.push(o.CONNECT_DOMAIN),i&&n.push(o.MUSIC_PROMO),a&&n.push(o.PHOTOGRAPHY_PROMO),i||a||!r||n.push(o.SHOUTOUT),u&&n.push(o.GROW_BUSINESS),n}function f(){var t={},n=e.reject(o,o.EMPTY);return e.forEach(n,function(e){t[e.name]=function(e){return{dontShowThisAgainKey:e,dontShowAgain:r.userPreferences.selectors.getSessionUserPreferences(e)(c.store.getState())}}(e.userPref)}),t}function I(){return c.panelManager.closePanelByName(A)}var N=c.store,T="savePublish.panels.publish.config.publishConfigurationPanel",A="savePublish.panels.publish.publishSuccessPanel",g="savePublish.panels.common.failPanel";return{publish:h,saveAndPublish:function(e){if(n.fedopsLogger.interactionStarted(n.fedopsLogger.INTERACTIONS.USER_PUBLISH_SITE),c.savePublish.canSaveOrPublish())if(c.documentServices.generalInfo.isFirstSave()){var t={overrideTitle:"PUBLISH_BEFORE_SAVE_CHOOSE_DOMAIN_TITLE",overrideSubtitle:"PUBLISH_BEFORE_SAVE_CHOOSE_DOMAIN_SUBTITLE",callback:h,origin:"publish",isPublish:!0};c.saveManager.save(t)}else c.saveManager.saveInBackground(h,m,e,{isPublish:!0})},configureMockPostPublish:function(){c.panelManager.openPanel(T,{onConfirm:function(t){(t=e.assign({},t,{isFakePublish:!0})).shouldPublishSucceed&&!t.isSiteContributor?S(t):t.shouldPublishSucceed&&t.isSiteContributor?(s.log.info("Contributors dont get to see any post operations except failure."),d()):_()}})}}}var u=r.domain.selectors;return c}),define("savePublish/panels/connectDomain/connectDomainPanel.rt",["react","lodash","panels","util","baseUI","symbols"],function(e,t,n,s,i,a){"use strict";return function(){return e.createElement(n.frames.focusPanelFrame,{className:"connect-domain-panel save-publish-panel",panelName:this.props.panelName,shouldHideHeader:!0,frameClassName:"save-publish-panel-frame",keyboardShortcuts:this.getKeyboardShortcuts()},e.createElement("header",{className:"save-publish-panel-header"},e.createElement("button",{className:"close",onClick:function(){this.onClose(!1)}.bind(this)},e.createElement(a.symbol,{name:"headerCloseButton"})),e.createElement("span",{className:"title"},this.translateIfNeeded(this.props.title)),e.createElement("span",{className:"subtitle"},this.translateIfNeeded(this.props.subtitle))),e.createElement("div",{className:"actions"},e.createElement("a",{className:"action",onClick:this.connectToNewDomain,onMouseEnter:function(){this.hoverOnAction(1)}.bind(this),onMouseLeave:this.resetHoverOnAction},e.createElement("div",{className:"action-graphics"},e.createElement(i.symbol,{name:"connectNewDomain"})),e.createElement("div",{className:"action-title"},this.translateIfNeeded("PREMIUM_BUTTON_1")),this.isActionHovered(1)?null:e.createElement("div",{key:"optionArrow",className:"action-arrow"},e.createElement(i.symbol,{name:"arrowWithCircle"})),this.isActionHovered(1)?e.createElement("div",{key:"optionLink",className:"action-arrow"},e.createElement(i.symbol,{name:"openLinkInWindow"})):null),e.createElement("a",{className:"action",onClick:this.connectExistingDomain,onMouseEnter:function(){this.hoverOnAction(2)}.bind(this),onMouseLeave:this.resetHoverOnAction},e.createElement("div",{className:"action-graphics"},e.createElement(i.symbol,{name:"connectDomainLight"})),e.createElement("div",{className:"action-title"},this.translateIfNeeded("PREMIUM_BUTTON_2")),this.isActionHovered(2)?null:e.createElement("div",{key:"optionArrow",className:"action-arrow"},e.createElement(i.symbol,{name:"arrowWithCircle"})),this.isActionHovered(2)?e.createElement("div",{key:"optionLink",className:"action-arrow"},e.createElement(i.symbol,{name:"openLinkInWindow"})):null)),e.createElement("div",{className:"connect-domain-panel-footer"},e.createElement(i.button,{type:"button",label:"PREMIUM_BUTTON_LABEL",className:"maybe-later-button",onClick:this.maybeLater})))}}),define("savePublish/panels/connectDomain/connectDomainPanel",["create-react-class","prop-types","jquery","lodash","core","util","savePublish/panels/connectDomain/connectDomainPanel.rt"],function(e,t,n,s,i,a,o){"use strict";return e({displayName:"connectDomainPanel",mixins:[i.mixins.editorAPIMixin,a.translationMixin],propTypes:{isPremium:t.bool.isRequired,isFirstSave:t.bool,isFirstPublish:t.bool,title:t.string,subtitle:t.string,panelName:t.string,onConnectDomainFlowEnded:t.func,flowId:t.oneOf(s.values(i.constants.CONNECT_DOMAIN.FLOWS)).isRequired},getInitialState:function(){return{actionIndexHovered:-1}},connectToNewDomain:function(){var e=i.bi.events.save.siteWasSavedPanel.CONNECT_NEW_DOMAIN_CLICKED,t=this.openUpgrade.bind(this,"CONNECT_NEW_DOMAIN");this.props.isPremium&&(t=this.openConnectDomainInWindow.bind(this,"CONNECT_NEW_DOMAIN")),this.connectDomain(e,t)},connectExistingDomain:function(){var e=i.bi.events.save.siteWasSavedPanel.CONNECT_EXISTING_DOMAIN_CLICKED,t=this.openUpgrade.bind(this,"CONNECT_EXISTING_DOMAIN");this.props.isPremium&&(t=this.openConnectDomainInWindow.bind(this,"CONNECT_EXISTING_DOMAIN")),this.connectDomain(e,t)},connectDomain:function(e,t){this.props.isFirstSave&&this.getEditorAPI().bi.event(e);var n=this.listenToTabFocusIfNeeded();t.call(this),this.onClose(n)},listenToTabFocusIfNeeded:function(){if(this.props.onConnectDomainFlowEnded){var e=function(){this.getWindow().off("focus",e),this.props.onConnectDomainFlowEnded()}.bind(this);return this.getWindow().on("focus",this.onEditorFocus),!0}return!1},onEditorFocus:function(){this.getWindow().off("focus",this.onEditorFocus),this.props.onConnectDomainFlowEnded()},getReferralCode:function(e){var t="edhtml_";switch(this.props.flowId){case i.constants.CONNECT_DOMAIN.FLOWS.SAVE:t+="SAVE_FLOW_",t+=this.props.isFirstSave?"FIRST_SAVE_":"SECOND_SAVE_",t+=e;break;case i.constants.CONNECT_DOMAIN.FLOWS.TOP_BAR:t+="TOP_BAR_SITE_MENU_CONNECT_DOMAIN_"+e;break;case i.constants.CONNECT_DOMAIN.FLOWS.PUBLISH:t+="PUBLISH_FLOW_",t+=this.props.isFirstPublish?"FIRST_PUBLISH_":"SECOND_PUBLISH_",t+=e;break;case i.constants.CONNECT_DOMAIN.FLOWS.PUBLISH_BUTTON:t+="PUBLISH_FLOW_CONNECT_BUTTON_",t+=this.props.isFirstPublish?"FIRST_PUBLISH_":"SECOND_PUBLISH_",t+=e;break;default:t=null}return t},openUpgrade:function(e){var t=this.getReferralCode(e);this.getEditorAPI().account.upgrade(t)},openConnectDomainInWindow:function(e){var t=this.createURLWithParams("https://premium.wix.com/wix/api/domainConsole?siteGuid=<%= siteGUID %>&referralAdditionalInfo=<%= referralInfo %>",e);window.open(t)},createURLWithParams:function(e,t){var n=this.getReferralCode(t);return s.template(e)({siteGUID:this.getEditorAPI().documentServices.generalInfo.getSiteId(),referralInfo:n})},maybeLater:function(){this.getEditorAPI().bi.event(i.bi.events.save.siteWasSavedPanel.First_Save_Dialog_2_maybe_later_click),this.onClose(!1)},onClose:function(e){this.getEditorAPI().panelManager.closePanelByName(this.props.panelName),!e&&this.props.onConnectDomainFlowEnded&&this.props.onConnectDomainFlowEnded()},getWindow:function(){return n(window)},resetHoverOnAction:function(){this.hoverOnAction(-1)},hoverOnAction:function(e){this.setState({actionIndexHovered:e})},isActionHovered:function(e){return this.state.actionIndexHovered===e},getKeyboardShortcuts:function(){var e=this;return{enter:function(){e.maybeLater()},esc:function(){e.onClose(!1)}}},render:o})}),define("savePublish/panels/connectDomain/connectDomainInProgress.rt",["react","lodash","panels","util","baseUI","symbols"],function(e,t,n,s,i,a){"use strict";return function(){return e.createElement(n.frames.focusPanelFrame,{className:"connect-domain-in-progress-panel save-publish-panel",panelName:this.props.panelName,shouldHideHeader:!0,frameClassName:"save-publish-panel-frame",keyboardShortcuts:this.getShortcuts()},e.createElement("div",{className:"save-publish-panel-header"},e.createElement("div",{className:"title"},s.translate("PUBLISH_HANGON_TITLE")),e.createElement("div",{className:"subtitle"},s.translate("PUBLISH_HANGON_SUBTITLE")),e.createElement("button",{className:"close-button",onClick:this.onClose},e.createElement(a.symbol,{name:"headerCloseButton"}))),e.createElement("div",{className:"panel-content"},e.createElement("div",{className:"content-top-part"},e.createElement("div",{className:"content-graphics"},e.createElement(i.symbol,{name:"hangon"})),e.createElement("div",{className:"content-top-message"},"\n                ",s.translate("PUBLISH_HANGON_MAIN_TEXT"),"\n                ",e.createElement("span",{className:"public-url"},this.props.connectedDomainURL))),e.createElement("div",{className:"content-bottom-message"},"\n            ",s.translate("PUBLISH_HANGON_MEANTIME_TEXT"),"\n            ",e.createElement("a",{className:"content-bottom-message-link",onClick:this.openWorkingURL},s.translate("PUBLISH_HANGON_CLICKING_HERE_LINK")))),e.createElement("div",{className:"connect-domain-panel-footer"},e.createElement(i.button,{type:"button",className:"maybe-later-button",label:"PUBLISH_HANGON_DONE_BUTTON",onClick:this.onClose})))}}),define("savePublish/panels/connectDomain/connectDomainInProgress",["create-react-class","prop-types","savePublish/panels/connectDomain/connectDomainInProgress.rt"],function(e,t,n){"use strict";return e({displayName:"connectDomainInProgress",propTypes:{connectedDomainURL:t.string.isRequired,currentPublicURL:t.string.isRequired,panelName:t.string},getShortcuts:function(){return{esc:this.onClose,enter:this.onClose}},openWorkingURL:function(){window.open(this.props.currentPublicURL)},onClose:function(){this.getEditorAPI().panelManager.closePanelByName(this.props.panelName)},render:n})}),define("savePublish/panels/common/failPanel.rt",["react","lodash","util","baseUI","panels"],function(e,t,n,s,i){"use strict";return function(){return e.createElement(i.frames.messagePanelFrame,{panelName:this.props.panelName,className:"fail-panel",panelTitle:n.translate(this.props.titleKey),confirmLabel:this.getConfirmLabel(),footerText:this.props.showFooterText?this.getFooterText():null,keyboardShortcuts:this.getShortcuts()},e.createElement("div",{className:"content-wrapper"},e.createElement("div",{className:"icon"},e.createElement(s.symbol,{name:"plaster"})),-40108!==this.props.errorCode?e.createElement("div",{className:"textual",key:"errorNot-40108"},e.createElement("p",{className:"description",dangerouslySetInnerHTML:{__html:n.translate(this.props.description)}}),this.props.showSteps&&this.props.stepsTitle?e.createElement("div",{key:"stepsTitle",className:"steps-title"},n.translate(this.props.stepsTitle)):null,this.props.showSteps?e.createElement.apply(this,["ol",{key:"steps"},t.map(this.props.steps,function(t,s){return e.createElement("li",{key:t},n.translate(t))}.bind(this))]):null):null,-40108===this.props.errorCode?e.createElement("div",{className:"textual",key:"error-40108"},e.createElement("h3",{},n.translate("PUBLISH_ERROR_SITE_DELETED_TITLE")),e.createElement("p",{className:"description"},n.translate("PUBLISH_ERROR_SITE_DELETED_BODY"))):null))}}),define("savePublish/panels/common/failPanel",["lodash","react-dom-factories","create-react-class","prop-types","core","util","savePublish/panels/common/failPanel.rt"],function(e,t,n,s,i,a,o){"use strict";return n({displayName:"failPanel",mixins:[i.mixins.editorAPIMixin],propTypes:{titleKey:s.string.isRequired,description:s.string.isRequired,stepsTitle:s.string,steps:s.array.isRequired,helpMessage:s.string.isRequired,helpLinkMessage:s.string.isRequired,helpLink:s.string.isRequired,errorCode:s.number,biEvent:s.object,biParams:s.object,failHelpId:s.string,biConfirm:s.object,biHelp:s.object,biCancel:s.object,onConfirm:s.func,confirmLabel:s.string,panelName:s.string},getDefaultProps:function(){return{showSteps:!0,showFooterText:!0,panelName:"savePublish.panels.common.failPanel"}},getShortcuts:function(){var e=this;return{esc:function(){e.getEditorAPI().panelManager.closePanelByName(e.props.panelName),e.onCancel()},enter:function(){e.getEditorAPI().panelManager.closePanelByName(e.props.panelName),e.onConfirm()}}},getErrorCodeMessage:function(){return void 0!==this.props.errorCode&&null!==this.props.errorCode?" (Error Code: "+this.props.errorCode+")":""},getFooterText:function(){return-40108===this.props.errorCode?"":t.p({className:"fail-panel-help-text"},t.span({className:"text-part"},a.translate(this.props.helpMessage)),t.a({onClick:this.openHelpLink,className:"link-part"},a.translate(this.props.helpLinkMessage)),t.span({className:"error-code-part"},this.getErrorCodeMessage()))},getConfirmLabel:function(){return-40108===this.props.errorCode?"PUBLISH_ERROR_SITE_DELETED_LINK":this.props.confirmLabel||"SAVE_PUBLISH_ERROR_BUTTON_OK"},onCancel:function(){this.props.biCancel&&this.getEditorAPI().bi.event(this.props.biCancel)},onConfirm:function(){this.props.biConfirm&&this.getEditorAPI().bi.event(this.props.biConfirm),-40108!==this.props.errorCode?e.invoke(this.props,"onConfirm"):window.location="https://wix.com/"},openHelpLink:function(){var e=this.getEditorAPI();this.props.biHelp&&this.getEditorAPI().bi.event(this.props.biHelp);var t={panel_name:this.props.panelName,origin:i.constants.BI.HELP.ORIGIN.PANEL,learn_more:!0};e.panelManager.openHelpCenter(this.props.helpLink,null,t),e.panelManager.closePanelByName(this.props.panelName)},sendPanelLoadedBiEvent:function(){this.props.biEvent&&this.props.biParams&&this.getEditorAPI().bi.event(this.props.biEvent,this.props.biParams)},componentDidMount:function(){this.sendPanelLoadedBiEvent()},render:o})}),define("savePublish/panels/common/commonPanels",["savePublish/panels/common/failPanel"],function(e){"use strict";return{failPanel:e}}),define("savePublish/panels/save/chooseDomainPanel.rt",["react","lodash","panels","baseUI","symbols"],function(e,t,n,s,i){"use strict";return function(){return e.createElement(n.frames.focusPanelFrame,{className:"choose-domain-panel save-publish-panel",panelName:this.props.panelName,shouldHideHeader:!0,frameClassName:"save-publish-panel-frame",keyboardShortcuts:this.getKeyboardShortcuts()},e.createElement("header",{className:"save-publish-panel-header"},e.createElement("button",{className:"close",onClick:this.close},e.createElement(i.symbol,{name:"headerCloseButton"})),e.createElement("span",{className:"title"},this.getTitle()),e.createElement("span",{className:"subtitle"},this.getSubtitle())),function(){var n=this.getOptions()[this.DomainStates.FREE];return e.createElement("label",{className:t({"domain-option":!0,checked:this.state.domainChoice===this.DomainStates.FREE}).transform(function(e,t,n){t&&e.push(n)},[]).join(" ")},e.createElement("span",{className:"domain-option-label"},n.label),e.createElement("input",{className:"domain-option-radio-button",type:"radio",name:"domain-options",value:n.value,checked:this.state.domainChoice===n.value,onChange:function(e){this.handleDomainOptionSelected(e.value)}.bind(this,n)}),e.createElement("span",{}),e.createElement("div",{className:"domain-input"},e.createElement(s.domainInput,{value:n.domain,onChange:this.handleDomainChanged,prefix:n.prefix,isEditable:n.isEditable,domainValidator:n.domainValidator,biHandler:this.domainInputBiReporter})))}.apply(this,[]),function(){var n=this.getOptions()[this.DomainStates.BUY];return e.createElement("label",{className:t({"domain-option":!0,checked:this.state.domainChoice===this.DomainStates.BUY}).transform(function(e,t,n){t&&e.push(n)},[]).join(" ")},e.createElement("span",{className:"domain-option-label"},n.label),e.createElement("input",{className:"domain-option-radio-button",type:"radio",name:"domain-options",value:n.value,checked:this.state.domainChoice===n.value,onChange:function(e){this.handleDomainOptionSelected(e.value)}.bind(this,n)}),e.createElement("span",{}),e.createElement("span",{className:"connect-domain-example"},n.domain))}.apply(this,[]),e.createElement(s.button,{className:"choose-domain-action-button",shouldTranslate:!1,label:this.getActionButtonLabel(),onClick:this.handleAction,disabled:this.state.isActionDisabled}))}}),define("savePublish/panels/save/chooseDomainPanel",["create-react-class","prop-types","lodash","core","util","savePublish/panels/save/chooseDomainPanel.rt"],function(e,t,n,s,i,a){"use strict";return e({displayName:"chooseDomainPanel",mixins:[s.mixins.editorAPIMixin],propTypes:{defaultSiteName:t.string.isRequired,freeDomainPrefix:t.string.isRequired,freeDomainHandler:t.func.isRequired,connectDomainHandler:t.func.isRequired,overrideTitle:t.string,overrideSubtitle:t.string,panelName:t.string,isDomainConnected:t.bool,isSitePublished:t.bool},DomainStates:{FREE:"free",BUY:"buy"},getInitialState:function(){var e=this.getEditorAPI().siteName.validate(this.props.defaultSiteName);return{domainChoice:this.DomainStates.FREE,siteName:this.props.defaultSiteName,sanitizedSiteName:this.props.defaultSiteName,isActionDisabled:!e.success}},getTitle:function(){return i.translate(this.props.overrideTitle||"SAVE_CHOOSE_DOMAIN_TITLE_TITLE")},getSubtitle:function(){return i.translate(this.props.overrideSubtitle||"SAVE_CHOOSE_DOMAIN_TITLE_SUBTITLE")},getOptions:function(){var e={};return e[this.DomainStates.FREE]={value:"free",label:i.translate("SAVE_CHOOSE_DOMAIN_BODY_RADIO_BUTTON_1"),prefix:this.props.freeDomainPrefix,domain:this.state.siteName,isEditable:this.state.domainChoice===this.DomainStates.FREE,domainValidator:this.getEditorAPI().siteName.validate},e[this.DomainStates.BUY]={value:"buy",label:i.translate("SAVE_CHOOSE_DOMAIN_BODY_RADIO_BUTTON_2_LINE1"),domain:i.translate("SAVE_CHOOSE_DOMAIN_BODY_RADIO_BUTTON_2_LINE2"),isEditable:!1},e},getNextDomainOptionValue:function(){return this.state.domainChoice===this.DomainStates.FREE?this.DomainStates.BUY:this.DomainStates.FREE},getActionButtonLabel:function(){return i.translate("SAVE_CHOOSE_DOMAIN_BUTTON_SAVENCONTINUE")},handleDomainChanged:function(e){var t={};t.isActionDisabled=!e.isValid,t.siteName=e.value,t.sanitizedSiteName=e.sanitizedValue,this.setState(t)},handleDomainOptionSelected:function(e){if(!n.isEqual(this.state.domainChoice,e)){var t={domainChoice:e};if(e===this.DomainStates.BUY)t.isActionDisabled=!1,t.siteName=this.props.defaultSiteName,t.sanitizedSiteName=this.props.defaultSiteName;else{var s=this.getEditorAPI().siteName.validate(this.props.defaultSiteName);t.isActionDisabled=!s.success}this.setState(t),this.reportDomainClickedBI(e)}},handleAction:function(){if(this.reportActionButtonClickedBI(this.state.domainChoice),this.state.isActionDisabled)throw new Error("Should not get to handleAction if continue button is disabled");this.state.domainChoice===this.DomainStates.FREE?(this.close(),this.props.freeDomainHandler(this.state.sanitizedSiteName)):this.state.domainChoice===this.DomainStates.BUY&&(this.close(),this.props.connectDomainHandler())},reportActionButtonClickedBI:function(e){var t=this.getEditorAPI(),n=e===this.DomainStates.BUY?"connect your own domain":"free WIX domain";t.bi.event(s.bi.events.save.chooseDomainPanel.ACTION_BUTTON_CLICKED,{value_selected:n})},reportDomainClickedBI:function(e){var t=this.getEditorAPI(),n=e===this.DomainStates.BUY?"connect your own domain":"free WIX domain";t.bi.event(s.bi.events.save.chooseDomainPanel.DOMAIN_OPTION_CLICKED,{selection:n})},getUserStatus:function(){var e="";return this.props.isSitePublished||(e+="not_"),e+="published_",this.props.isDomainConnected||(e+="not_"),e+="connected"},domainInputBiReporter:function(e){var t={user_status:"not_published_not_connected",panel_name:this.props.panelName,save_or_publish:"save",is_first_save_or_publish:1};this.getEditorAPI().bi.event(s.bi.events.domainInput[e],t)},close:function(){this.getEditorAPI().panelManager.closePanelByName(this.props.panelName)},getKeyboardShortcuts:function(){var e=this;return{enter:function(){e.state.isActionDisabled||e.handleAction()},esc:function(){e.close()},tab:function(t){e.handleDomainOptionSelected(e.getNextDomainOptionValue()),t.preventDefault()}}},render:a})}),define("savePublish/panels/save/siteWasSavedPanel.rt",["react","lodash","panels","baseUI","baseUILib","util","symbols"],function(e,t,n,s,i,a,o){"use strict";return function(){function r(){var n=this.getInnerPanel();return e.createElement("div",{className:"wrapper"},e.createElement("div",{className:"domain-input"},e.createElement(s.domainInputWithEditButtons,this.getDomainInputProps())),this.shouldDisplayInnerPanel()?e.createElement(n,function(e,n){var s=t.assign({},e,n);return e.hasOwnProperty("style")&&(s.style=t.defaults(s.style,e.style)),e.hasOwnProperty("className")&&n.hasOwnProperty("className")&&(s.className=n.className+" "+e.className),s}({key:"innerPanel",className:"inner-panel "+this.getInnerPanelClass()},this.getInnerPanelProps())):null,e.createElement("div",{className:"site-saved-footer"},this.props.isFirstSave?null:e.createElement(i.Checkbox,{key:"dontShowAgainCheckbox",className:"dont-show-again",label:"SAVE_PUBLISH_DO_NOT_SHOW_AGAIN_LABEL",valueLink:{value:this.state.doNotShowAgain,requestChange:this.handleDontShowAgainClicked},labelAfterSymbol:!0}),this.props.isSitePremium&&!this.props.isDomainConnected&&this.props.isFirstSave?e.createElement("span",{key:"needHelpConnectingDomain",className:"help-connecting-domain"},a.translate("SAVE_SITE_SAVED_NEED_HELP_LABEL")+" ",e.createElement("a",{target:"_blank",href:a.translate("SAVE_SITE_SAVED_NEED_HELP_URL"),onClick:this.handleNeedHelpConnectingDomainClicked},a.translate("SAVE_SITE_SAVED_NEED_HELP_LINK"))):null,e.createElement("div",{className:"footer-buttons"},this.props.isSitePublished?e.createElement(s.button,{onClick:this.continueToPublish,key:"publishButton",className:"publish-button btn-confirm-secondary",label:"SAVE_SITE_SAVED_WHATS_NEXT_PUBLISH_LINK",disabled:this.state.isContinueDisabled}):null,e.createElement(s.button,{className:"continue-button btn-confirm-primary",label:"SAVE_SITE_SAVED_BUTTON_OK",onClick:this.continueEditing,disabled:this.state.isContinueDisabled}))))}return e.createElement(n.frames.focusPanelFrame,{className:this.getPanelClass(),panelName:this.props.panelName,shouldHideHeader:!0,frameClassName:"save-publish-panel-frame",keyboardShortcuts:this.getKeyboardShortcuts()},e.createElement("header",{className:"save-publish-panel-header"},e.createElement("button",{className:"close",onClick:this.close},e.createElement(o.symbol,{name:"headerCloseButton"})),e.createElement("span",{className:"title"},this.getPanelTitle()),e.createElement("span",{className:"subtitle"},this.getPanelSubtitle())),r.apply(this,[]))}}),define("savePublish/panels/content/generalContent.rt",["react","lodash","baseUILib","baseUI"],function(e,t,n,s){"use strict";return function(){return e.createElement("div",{className:this.getClassName()},e.createElement("div",{className:"main-title-wrapper"},e.createElement(n.Divider,{long:!0}),e.createElement("div",{className:"main-title"},this.translateIfNeeded(this.props.mainTitle)),e.createElement(n.Divider,{long:!0})),e.createElement("div",{className:"middle-spacer"}),e.createElement("div",{className:"bottom-section"},e.createElement("div",{className:"left-side"},this.props.symbolName?e.createElement(s.symbol,{name:this.props.symbolName,key:"symbol"}):null,this.props.imageSrc?e.createElement("img",{key:"image",src:this.props.imageSrc,style:this.props.imageStyle||{}}):null),e.createElement("div",{className:"right-side"},e.createElement("div",{className:"title"},this.translateIfNeeded(this.props.title)),this.props.subtitle?e.createElement("div",{key:"subtitle",className:"subtitle",dangerouslySetInnerHTML:{__html:this.translateIfNeeded(this.props.subtitle)}}):null,e.createElement("a",{className:"general-content-action",onClick:this.props.actionCallback},this.translateIfNeeded(this.props.actionLabel)))))}}),define("savePublish/panels/content/generalContent",["create-react-class","prop-types","util","savePublish/panels/content/generalContent.rt"],function(e,t,n,s){"use strict";return e({displayName:"generalContent",mixins:[n.translationMixin],propTypes:{symbolName:t.string,imageSrc:t.string,imageStyle:t.object,mainTitle:t.string.isRequired,title:t.string.isRequired,subtitle:t.string,actionCallback:t.func.isRequired,actionLabel:t.string.isRequired,className:t.string},getClassName:function(){return"general-content"+(this.props.className?" "+this.props.className:"")},render:s})}),define("savePublish/panels/content/connectDomain.rt",["react","lodash","savePublish/panels/content/generalContent"],function(e,t,n){"use strict";return function(){return e.createElement(n,function(e,n){var s=t.assign({},e,n);return e.hasOwnProperty("style")&&(s.style=t.defaults(s.style,e.style)),e.hasOwnProperty("className")&&n.hasOwnProperty("className")&&(s.className=n.className+" "+e.className),s}({className:"connect-domain-content "+this.props.className},this.getGeneralContentProps()))}}),define("savePublish/panels/content/connectDomain",["lodash","core","create-react-class","prop-types","util","savePublish/panels/content/connectDomain.rt","experiment"],function(e,t,n,s,i,a,o){"use strict";var r=o.isOpen("spanishUpgradeText")?"UPGRADE_NOW_FOR_SPAIN_ONLY":"SAVE_PUBLISH_WHATS_NEXT_UPGRADE_LINK";return n({displayName:"connectDomain",mixins:[t.mixins.editorAPIMixin],propTypes:{className:s.string,closePanel:s.func.isRequired,sitePublishedDomain:s.string,currentDomain:s.string,isDomainConnected:s.bool,isFirstPublish:s.bool,isSitePremium:s.bool,isFirstSave:s.bool,actionCallback:s.func,flowId:s.oneOf(e.values(t.constants.CONNECT_DOMAIN.FLOWS)).isRequired},getGeneralContentProps:function(){var t=this.getEditorAPI(),n={className:"",symbolName:"connectDomain",mainTitle:i.translate("SAVE_SITE_SAVED_WHATS_NEXT_LABEL"),title:i.translate("SAVE_PUBLISH_WHATS_NEXT_CONNECT_LINE1"),actionLabel:i.translate(this.props.isSitePremium?"SAVE_PUBLISH_WHATS_NEXT_CONNECT_LINK":r),shouldTranslate:!1,actionCallback:this.panelAction,subtitle:i.translate("SAVE_PUBLISH_WHATS_NEXT_CONNECT_LINE2")};return t.campaigns.personalSale.isActiveCampaign()&&!this.props.isSitePremium&&e.assign(n,{symbolName:"connectDomain_50",className:"personal-sale-campaign",subtitle:e.template(i.translate("SAVE_PUBLISH_WHATS_NEXT_PERSONAL_SALE_TEXT_DYNAMIC"))({discount:"50"})}),n},panelAction:function(){this.props.actionCallback&&this.props.actionCallback(),this.props.closePanel();this.isSiteBeingConnectedToDomain()?this.openConnectDomainInProgressPanel():!this.props.isDomainConnected&&this.props.isSitePremium?this.getEditorAPI().account.openConnectDomain(this.props.flowId):this.getEditorAPI().account.upgrade(this.getUpgradeReferralCode())},getUpgradeReferralCode:function(){var e="edhtml_";switch(this.props.flowId){case t.constants.CONNECT_DOMAIN.FLOWS.PUBLISH:e+="PUBLISH_FLOW_"+(this.props.isFirstPublish?"FIRST_PUBLISH":"SECOND_PUBLISH");break;case t.constants.CONNECT_DOMAIN.FLOWS.SAVE:e+="SAVE_FLOW_SECOND_SAVE_AND_PUBLISHED";break;default:e=null}return e},isSiteBeingConnectedToDomain:function(){return this.isUnconnectedDomainPremium()&&!e.isEmpty(this.props.sitePublishedDomain)&&!e.includes(this.props.sitePublishedDomain,"wix.com")},isUnconnectedDomainPremium:function(){return!this.props.isDomainConnected&&this.props.isSitePremium},openConnectDomainInProgressPanel:function(){this.getEditorAPI().panelManager.openPanel("savePublish.panels.connectDomainInProgress",{connectedDomainURL:this.props.sitePublishedDomain,currentPublicURL:this.props.currentDomain},!0)},render:a})}),define("savePublish/panels/content/publishContent.rt",["react","lodash","savePublish/panels/content/generalContent"],function(e,t,n){"use strict";return function(){return e.createElement(n,t.assign({},{className:this.getClassName()},this.getGeneralContentProps()))}}),define("savePublish/panels/content/publishContent",["create-react-class","prop-types","core","savePublish/panels/content/publishContent.rt"],function(e,t,n,s){"use strict";return e({displayName:"publishContent",mixins:[n.mixins.editorAPIMixin],propTypes:{closePanel:t.func.isRequired,publishMethod:t.func.isRequired,className:t.string,actionCallback:t.func},getClassName:function(){return"publish-site-content"+(this.props.className?" "+this.props.className:"")},getGeneralContentProps:function(){return{symbolName:"publishSite",mainTitle:"SAVE_SITE_SAVED_WHATS_NEXT_LABEL",title:"SAVE_SITE_SAVED_WHATS_NEXT_PUBLISH_LINE",actionLabel:"SAVE_SITE_SAVED_WHATS_NEXT_PUBLISH_LINK",actionCallback:this.publishSite}},publishSite:function(){this.props.closePanel(),this.props.publishMethod(),this.props.actionCallback&&this.props.actionCallback()},render:s})}),define("savePublish/panels/save/siteWasSavedPanel",["react","create-react-class","prop-types","lodash","core","util","stateManagement","savePublish/constants/constants","savePublish/constants/savePublishErrorPanelData","savePublish/panels/save/siteWasSavedPanel.rt","savePublish/panels/content/connectDomain","savePublish/panels/content/publishContent"],function(e,t,n,s,i,a,o,r,l,c,u,p){"use strict";function h(e){var t=e.lastIndexOf("/");return{prefix:e.slice(0,t+1),siteName:e.slice(t+1)}}var m={PUBLISH:"PUBLISH",CONNECT_DOMAIN:"CONNECT_DOMAIN"};return t({displayName:"siteWasSavedPanel",mixins:[e.addons.LinkedStateMixin,i.mixins.editorAPIMixin],propTypes:{domain:n.string.isRequired,isSitePremium:n.bool,isFirstSave:n.bool,isDomainConnected:n.bool,isSitePublished:n.bool,isMockSave:n.bool,overrideTitle:n.string,overrideSubtitle:n.string,panelName:n.string,callback:n.func},getInitialState:function(){var e={isContinueDisabled:!1,doNotShowAgain:null,domain:this.props.domain};return this.props.isFirstSave||(e.doNotShowAgain=!!o.userPreferences.selectors.getSessionUserPreferences(i.constants.USER_PREFS.SAVE.SITE_SAVED_DONT_SHOW_AGAIN)(this.getEditorAPI().store.getState())),e},getPanelTitle:function(){return a.translate(this.props.overrideTitle||"SAVE_SITE_SAVED_TITLE_TITLE")},getPanelSubtitle:function(){return a.translate(this.props.overrideSubtitle||"SAVE_SITE_SAVED_TITLE_SUBTITLE")},getDomainInputProps:function(){var e=void 0,t=this.state.domain;if(!this.props.isDomainConnected){var n=h(t);e={prefix:n.prefix,value:n.siteName,isEditable:!0,domainValidator:this.getEditorAPI().siteName.validate,domainHandler:this.props.isMockSave?null:this.renameSiteAndProcessResult,onChange:this.handleDomainEditingStatusChanged}}else e={value:t,isEditable:!1};return e.biHandler=this.domainInputBiReporter,e},getInnerPanelType:function(){return this.props.isSitePublished?this.props.isDomainConnected?void 0:m.CONNECT_DOMAIN:m.PUBLISH},getInnerPanel:function(){switch(this.getInnerPanelType()){case m.PUBLISH:return p;case m.CONNECT_DOMAIN:return u}},getPanelClass:function(){var e="site-was-saved-panel",t=this.getInnerPanelClass();return e+=t?" contains-"+t:"",this.props.isSitePremium&&this.props.isSitePublished&&this.props.isDomainConnected&&(e+=" narrow-domain-input"),e+" save-publish-panel"},getInnerPanelClass:function(){switch(this.getInnerPanelType()){case m.PUBLISH:return"publish-inner-panel";case m.CONNECT_DOMAIN:return"connect-domain-inner-panel"}},getInnerPanelProps:function(){var e={sitePublishedDomain:this.props.domain,isDomainConnected:this.props.isDomainConnected,isFirstPublish:!this.props.isSitePublished,isSitePremium:this.props.isSitePremium,isFirstSave:this.props.isFirstSave,flowId:i.constants.CONNECT_DOMAIN.FLOWS.SAVE,closePanel:this.close},t=this.getInnerPanelType(),n=this.getEditorAPI();switch(t){case m.PUBLISH:e.publishMethod=this.props.isMockSave?n.publishManager.configureMockPostPublish:n.publishManager.publish,this.props.isMockSave||(e.actionCallback=function(){this.reportPublishClickedBI(),this.getEditorAPI().bi.event(i.bi.events.publish.PUBLISH_CLICK,{origin:"saveSuccessPanel"})}.bind(this));break;case m.CONNECT_DOMAIN:this.props.isMockSave||(e.actionCallback=this.reportConnectDomainClickedBI)}return e},shouldDisplayInnerPanel:function(){return!this.props.isSitePublished||!this.props.isDomainConnected},continueToPublish:function(){a.fedopsLogger.interactionStarted(a.fedopsLogger.INTERACTIONS.USER_PUBLISH_SITE),this.props.isMockSave||(this.getEditorAPI().bi.event(i.bi.events.publish.PUBLISH_CLICK,{origin:"saveSuccessPanel"}),this.reportBIWithUserStatus(i.bi.events.save.siteWasSavedPanel.SECOND_SAVE_PUBLISH_NOW_BUTTON_CLICKED)),this.close(),this.getEditorAPI().publishManager.publish()},continueEditing:function(){if(this.props.isMockSave||(this.props.isFirstSave?this.getEditorAPI().bi.event(i.bi.events.save.siteWasSavedPanel.FIRST_SAVE_ACTION_BUTTON_CLICKED,{}):this.reportBIWithUserStatus(i.bi.events.save.siteWasSavedPanel.SECOND_SAVE_ACTION_BUTTON_CLICKED)),this.state.isContinueDisabled)throw new Error("Should not get to continueEditing if continue button is disabled");this.state.doNotShowAgain&&this.getEditorAPI().store.dispatch(o.userPreferences.logic.setSessionUserPreferences(i.constants.USER_PREFS.SAVE.SITE_SAVED_DONT_SHOW_AGAIN,this.state.doNotShowAgain)),this.close()},reportBIWithUserStatus:function(e){var t={user_status:this.getUserStatus()};this.getEditorAPI().bi.event(e,t)},getUserStatus:function(){var e="";return this.props.isSitePublished||(e+="not_"),e+="published_",this.props.isDomainConnected||(e+="not_"),e+="connected"},renameSiteAndProcessResult:function(e,t,n){var i=this.getEditorAPI();i.siteName.rename(e,function(){t()},function(e){var t=e&&e.errorCode;if(t===r.RENAME.ERRORS.SITE_NAME_TAKEN)n("SAVE_SITE_NAME_ALREADY_EXISTS");else{n();var a=s.chain(l.NAME_SITE_AGAIN_PANEL_DATA).clone().defaults(l.SAVE_ERROR_DEFAULT_PANEL_DATA).assign({errorCode:t}).value();i.panelManager.openPanel("savePublish.panels.common.failPanel",a,!0)}})},handleDomainEditingStatusChanged:function(e){var t={};if(e){var n=h(this.props.domain).prefix;t.isContinueDisabled=!1,t.domain=n+e}else t.isContinueDisabled=!0;this.setState(t)},handleNeedHelpConnectingDomainClicked:function(){this.getEditorAPI().bi.event(i.bi.events.save.siteWasSavedPanel.HELP_CONNECTING_DOMAIN_CLICKED,{})},handleDontShowAgainClicked:function(e){this.setState({doNotShowAgain:e}),this.getEditorAPI().bi.event(i.bi.events.save.siteWasSavedPanel.SECOND_SAVE_DONT_SHOW_AGAIN_CLICKED,{toggle:e,user_status:this.getUserStatus()})},reportPublishClickedBI:function(){this.getEditorAPI().bi.event(i.bi.events.save.siteWasSavedPanel.PUBLISH_NOW_CLICKED,{user_status:this.getUserStatus(),is_first_save:this.props.isFirstSave?1:0})},reportConnectDomainClickedBI:function(){this.getEditorAPI().bi.event(i.bi.events.save.siteWasSavedPanel.SECOND_SAVE_CONNECT_DOMAIN_CLICKED,{user_status:this.getUserStatus()})},domainInputBiReporter:function(e){if(!this.props.isMockSave){var t={user_status:this.getUserStatus(),panel_name:this.props.panelName,save_or_publish:"save",is_first_save_or_publish:this.props.isFirstSave?1:0};this.getEditorAPI().bi.event(i.bi.events.domainInput[e],t)}},componentWillUnmount:function(){this.props.callback&&this.props.callback()},close:function(){this.getEditorAPI().panelManager.closePanelByName(this.props.panelName)},getKeyboardShortcuts:function(){var e=this;return{enter:function(){e.state.isContinueDisabled||e.continueEditing()},esc:function(){e.close()}}},render:c})}),define("savePublish/panels/save/concurrentSavePanel.rt",["react","lodash","panels","baseUI","symbols","util"],function(e,t,n,s,i,a){"use strict";return function(){return e.createElement(n.frames.confirmationPanelFrame,{panelName:this.props.panelName,className:"concurrent-save-panel save-publish-panel",panelTitle:a.translate(this.getTitle()),keyboardShortcuts:this.getKeyboardShortcuts(),confirmLabel:this.getConfirmLabel(),cancelLabel:this.getCancelLabel(),onConfirm:this.overrideSave,onCancel:this.handleCancel,onClose:this.close},e.createElement("div",{className:"content-wrapper"},e.createElement("div",{className:"error-logo"},e.createElement(s.symbol,{name:"plaster"})),this.isAutosave()?null:e.createElement("div",{key:"withoutAutosave",className:"description-wrapper"},e.createElement("span",{className:"description-line",dangerouslySetInnerHTML:{__html:a.translate("SAVE_PUBLISH_MULTIPLE_TABS_ERRROR_TOOLTIP_LINE1")}}),e.createElement("span",{className:"description-line",dangerouslySetInnerHTML:{__html:a.translate("SAVE_PUBLISH_MULTIPLE_TABS_ERRROR_TOOLTIP_LINE2")}})),this.isAutosave()?e.createElement("div",{key:"withAutosave",className:"description-wrapper"},e.createElement("div",{className:"description-line initialPadding",dangerouslySetInnerHTML:{__html:a.translate(this.getBodyText()[0])}}),e.createElement("div",{className:"description-line initialPadding",dangerouslySetInnerHTML:{__html:a.translate(this.getBodyText()[1])}}),e.createElement("div",{className:"description-line initialPadding",dangerouslySetInnerHTML:{__html:a.translate(this.getBodyText()[2])}})):null))}}),define("savePublish/panels/save/concurrentSavePanel",["create-react-class","prop-types","core","savePublish/panels/save/concurrentSavePanel.rt","coreUtilsLib"],function(e,t,n,s,i){"use strict";return e({displayName:"concurrentSavePanel",mixins:[n.mixins.editorAPIMixin],propTypes:{overrideSaveMethod:t.func.isRequired,onCancel:t.func,panelName:t.string,origin:t.string},isAutosave:function(){return"autosave"===this.props.origin},getTitle:function(){return this.isAutosave()?"AUTOSAVE_ERROR_CONCURRENT_EDITING_TITLE":"SAVE_PUBLISH_MULTIPLE_TABS_ERRROR_TOOLTIP_TITLE"},getBodyText:function(){return this.isAutosave()?["AUTOSAVE_ERROR_CONCURRENT_EDITING_DESCRIPTION_HEADER","AUTOSAVE_ERROR_CONCURRENT_EDITING_DESCRIPTION_OPTION1","AUTOSAVE_ERROR_CONCURRENT_EDITING_DESCRIPTION_OPTION2"]:["SAVE_PUBLISH_MULTIPLE_TABS_ERRROR_TOOLTIP_LINE1","SAVE_PUBLISH_MULTIPLE_TABS_ERRROR_TOOLTIP_LINE2"]},getConfirmLabel:function(){return this.isAutosave()?"AUTOSAVE_ERROR_CONCURRENT_EDITING_BUTTON_LABEL":"SAVE_ERROR_CONCURRENT_EDITING_SAVE_BUTTON"},getCancelLabel:function(){return this.isAutosave()?"AUTOSAVE_ERROR_CONCURRENT_EDITING_LINK_LABEL":"SAVE_ERROR_CONCURRENT_EDITING_DONT_SAVE_BUTTON"},overrideSave:function(){this.props.overrideSaveMethod?(this.props.overrideSaveMethod(this.getEditorAPI),this.sendBI("save")):i.log.info("Mock Overriding Save"),this.close()},handleCancel:function(){this.props.overrideSaveMethod&&this.sendBI(this.isAutosave()?"update":"don't save"),this.close(),this.props.onCancel&&this.props.onCancel()},close:function(){this.getEditorAPI().panelManager.closePanelByName(this.props.panelName)},sendBI:function(e){var t=n.bi.events.save.saveFailed,s=this.isAutosave()?t.CONCURRENT_AUTOSAVE:t.CONCURRENT_SAVE;this.getEditorAPI().bi.event(s,{selection:e})},getKeyboardShortcuts:function(){var e=this;return{esc:function(){e.close()}}},render:s})}),define("savePublish/panels/save/saveConfigurationPanel.rt",["react","lodash","panels","baseUI","baseUILib"],function(e,t,n,s,i){"use strict";return function(){return e.createElement(n.frames.emptyPanelFrame,function(e,n){var s=t.assign({},e,n);return e.hasOwnProperty("style")&&(s.style=t.defaults(s.style,e.style)),e.hasOwnProperty("className")&&n.hasOwnProperty("className")&&(s.className=n.className+" "+e.className),s}({ref:"frame",className:"save-configuration-panel"},this.getFrameProps()),e.createElement("a",{className:"close-button",onClick:this.close},"x"),e.createElement("h2",{style:{textAlign:"center"}},"Save Testing Configuration"),e.createElement(i.Checkbox,{className:"checkbox-field",label:"First save",valueLink:this.linkState("isFirstSave"),shouldTranslate:!1,labelAfterSymbol:!0}),e.createElement(i.Checkbox,{className:"checkbox-field",label:"Save succeeds",valueLink:this.linkState("shouldSaveSucceed"),shouldTranslate:!1,labelAfterSymbol:!0}),e.createElement("p",{},e.createElement("br",{}),"Premium Interaction:"),e.createElement(i.Checkbox,{className:"checkbox-field",label:"Site is/upgraded-to premium",value:this.state.isSitePremium,onChange:this.premiumToggled,shouldTranslate:!1,labelAfterSymbol:!0}),e.createElement(i.Checkbox,{className:"checkbox-field",label:"Domain is/will-be connected",value:this.state.isDomainConnected,onChange:this.domainConnectedToggled,shouldTranslate:!1,labelAfterSymbol:!0}),e.createElement(s.textInput,{className:"domain-text-field",shouldTranslate:!1,label:"Custom Domain",valueLink:this.linkState("domain"),disabled:!this.state.isDomainConnected}),e.createElement(i.Checkbox,{className:"checkbox-field"+(this.state.isFirstSave?" disabled":""),label:"Site is published",valueLink:this.linkState("isSitePublished"),disabled:this.state.isFirstSave,shouldTranslate:!1,labelAfterSymbol:!0}),e.createElement("button",{className:"concurrent-save-button",shouldTranslate:!1,onClick:this.openConcurrentSave},"Concurrent Save"),e.createElement("button",{className:"save-reminder-button",shouldTranslate:!1,onClick:this.openSaveReminder},"Save Reminder"),e.createElement("div",{className:"save-configuration-footer"},e.createElement(s.button,{className:"confirm-button",shouldTranslate:!1,label:"Start Save",onClick:this.onConfirm})))}}),define("savePublish/panels/save/saveConfigurationPanel",["react","create-react-class","prop-types","core","savePublish/panels/save/saveConfigurationPanel.rt","coreUtilsLib"],function(e,t,n,s,i,a){"use strict";return t({displayName:"SaveConfigurationPanel",mixins:[e.addons.LinkedStateMixin,s.mixins.editorAPIMixin],propTypes:{onConfirm:n.func.isRequired,panelName:n.string},getInitialState:function(){return{isSitePremium:!1,isFirstSave:!0,isDomainConnected:!1,domain:"http://www.my-domain.com",isSitePublished:!1,shouldSaveSucceed:!0}},getFrameProps:function(){return{panelName:this.props.panelName}},openConcurrentSave:function(){this.getEditorAPI().panelManager.openPanel("savePublish.panels.save.concurrentSavePanel",{overrideSaveMethod:function(){a.log.info("Override Save")}},!0)},openSaveReminder:function(){this.getEditorAPI().panelManager.openPanel("savePublish.panels.save.saveReminderPanel",{saveMethod:this.onConfirm},!0)},componentWillUpdate:function(e,t){t.isFirstSave&&t.isSitePublished&&this.setState({isSitePublished:!1,isFirstSave:!0})},premiumToggled:function(){var e=!this.state.isSitePremium;this.setState({isSitePremium:e,isDomainConnected:!!e&&this.state.isDomainConnected})},domainConnectedToggled:function(){var e=!this.state.isDomainConnected;this.setState({isDomainConnected:e,isSitePremium:e||this.state.isSitePremium})},onConfirm:function(){this.props.onConfirm({isSitePremium:this.state.isSitePremium,isFirstSave:this.state.isFirstSave,isDomainConnected:this.state.isDomainConnected,domain:this.state.domain,isSitePublished:this.state.isSitePublished,shouldSaveSucceed:this.state.shouldSaveSucceed})},close:function(){this.getEditorAPI().panelManager.closePanelByName(this.props.panelName)},render:i})}),define("savePublish/panels/save/saveReminderPanel.rt",["react","lodash","util","baseUI","panels","experiment"],function(e,t,n,s,i,a){"use strict";return function(){return a.isOpen("disableSaveReminder")?null:e.createElement(i.frames.messagePanelFrame,{ref:"frame",key:"saveReminder",panelName:this.props.panelName,className:"save-reminder-panel save-publish-panel",panelTitle:n.translate("SAVE_REMINDER_MSG_TITLE"),confirmLabel:"SAVE_REMINDER_MSG_BUTTON",onConfirm:this.handleSave,keyboardShortcuts:this.getKeyboardShortcuts()},e.createElement("div",{className:"content-wrapper"},e.createElement("div",{className:"icon"},e.createElement(s.symbol,{name:"saveYourWork"})),e.createElement("div",{className:"message"},n.translate("SAVE_REMINDER_MSG_BODY"))))}}),define("savePublish/panels/save/saveReminderPanel",["create-react-class","prop-types","lodash","core","savePublish/panels/save/saveReminderPanel.rt"],function(e,t,n,s,i){"use strict";return e({displayName:"saveReminderPanel",mixins:[s.mixins.editorAPIMixin],propTypes:{saveMethod:t.func.isRequired,panelName:t.string},componentWillMount:function(){this.getEditorAPI().bi.event(s.bi.events.save.saveReminder.REMINDER_DISPLAYED,{origin:"pop up message"})},handleSave:function(){this.getEditorAPI().bi.event(s.bi.events.save.saveReminder.SAVE_CLICKED,{}),this.close(),this.props.saveMethod()},getKeyboardShortcuts:function(){var e=this;return{enter:function(){e.close(),e.handleSave()},esc:function(){e.close()}}},close:function(){this.getEditorAPI().panelManager.closePanelByName(this.props.panelName)},render:i})}),define("savePublish/panels/save/onBoardingMigrationConfirmationPanel.rt",["react","lodash","panels","baseUI"],function(e,t,n,s){"use strict";return function(){return e.createElement(n.frames.focusPanelFrame,{ref:"frame",key:"onBoardingMigrationConfirmationPanel",shouldHideHelp:!0,className:"save-on-boarding-site-confirm-panel",title:this.translateIfNeeded("ADI_EDITOR_MIGRATION_SAVEPOPUP_TITLE"),panelName:this.props.panelName},e.createElement("div",{className:"save-on-boarding-site-confirm-content"},e.createElement("div",{className:"image-container"},e.createElement(s.symbol,{name:"obMigrationBeforeSave"})),e.createElement("div",{className:"description-container"},e.createElement("span",{className:"description-text"},this.translateIfNeeded("ADI_EDITOR_MIGRATION_SAVEPOPUP_TEXT"))),e.createElement("div",{className:"footer-buttons"},e.createElement(s.button,{onClick:this.navigateToOnBoarding,className:"btn-confirm-secondary btn-md footer-button",label:"ADI_EDITOR_MIGRATION_SAVEPOPUP_BUTTON_ADI"}),e.createElement(s.button,{onClick:this.saveDocument,className:"btn-confirm-primary btn-md footer-button",label:"ADI_EDITOR_MIGRATION_SAVEPOPUP_BTN_SAVE"}))))}}),define("savePublish/panels/save/onBoardingMigrationConfirmationPanel",["create-react-class","prop-types","util","core","savePublish/panels/save/onBoardingMigrationConfirmationPanel.rt"],function(e,t,n,s,i){"use strict";function a(e,t){e.bi.event(s.bi.events.ON_BOARDING_MIGRATION.PANEL_ACTION_CLICKED,{action:t})}var o={NAVIGATE_TO_OB:"Go Back to Wix ADI",SAVE:"Save Changes"};return e({displayName:"onBoardingMigrationConfirmationPanel",propTypes:{panelName:t.string.isRequired,onConfirm:t.func.isRequired,onCancel:t.func},mixins:[n.translationMixin,s.mixins.editorAPIMixin],saveDocument:function(){a(this.getEditorAPI(),o.SAVE),this.props.onConfirm(),this.close()},navigateToOnBoarding:function(){this.props.onCancel(),a(this.getEditorAPI(),o.NAVIGATE_TO_OB),window.location=n.editorModel.onboardingEditorUrl},close:function(){this.getEditorAPI().panelManager.closePanelByName(this.props.panelName)},render:i})}),define("savePublish/panels/save/saveYourSitePanel.rt",["react","lodash","util","baseUI","panels"],function(e,t,n,s,i){"use strict";return function(){return e.createElement(i.frames.messagePanelFrame,{ref:"frame",panelName:this.props.panelName,className:"save-your-site-panel",panelTitle:n.translate(this.props.title),confirmLabel:"TOPBAR_SETTINGS_BUTTON_SAVE",onConfirm:this.handleSave,keyboardShortcuts:this.keyboardShortcuts},e.createElement("div",{className:"content-wrapper"},e.createElement("div",{className:"logo"},e.createElement(s.symbol,{name:"saveYourWork"})),e.createElement("div",{className:"message"},n.translate(this.props.messageBody))))}}),define("savePublish/panels/save/saveYourSitePanel",["create-react-class","prop-types","lodash","core","savePublish/panels/save/saveYourSitePanel.rt"],function(e,t,n,s,i){"use strict";return e({displayName:"saveYourSitePanel",mixins:[s.mixins.editorAPIMixin],propTypes:{title:t.string.isRequired,panelName:t.string,messageBody:t.string.isRequired},getInitialState:function(){return this.keyboardShortcuts={enter:this.handleSave,esc:this.close},{}},handleSave:function(){this.close();this.getEditorAPI().saveManager.save()},close:function(){this.getEditorAPI().panelManager.closePanelByName(this.props.panelName)},render:i})}),define("savePublish/panels/save/savePanels",["savePublish/panels/save/chooseDomainPanel","savePublish/panels/save/siteWasSavedPanel","savePublish/panels/save/concurrentSavePanel","savePublish/panels/save/saveConfigurationPanel","savePublish/panels/save/saveReminderPanel","savePublish/panels/save/onBoardingMigrationConfirmationPanel","savePublish/panels/save/saveYourSitePanel"],function(e,t,n,s,i,a,o){"use strict";return{chooseDomainPanel:e,siteWasSavedPanel:t,concurrentSavePanel:n,saveConfigurationPanel:s,saveReminderPanel:i,onBoardingMigrationConfirmationPanel:a,saveYourSitePanel:o}}),define("savePublish/panels/publish/config/publishConfigurationPanel.rt",["react","lodash","panels","baseUI","baseUILib"],function(e,t,n,s,i){"use strict";return function(){return e.createElement(n.frames.emptyPanelFrame,{className:"save-configuration-panel",panelName:this.props.panelName},e.createElement("a",{className:"close-button",onClick:this.close},"x"),e.createElement("h2",{style:{textAlign:"center"}},"Publish Testing Configuration"),e.createElement(i.Checkbox,{className:"checkbox-field",label:"Is Contributor to site",valueLink:this.linkState("isSiteContributor"),shouldTranslate:!1,labelAfterSymbol:!0}),e.createElement(i.Checkbox,{className:"checkbox-field",label:"Did Publish Succeed",valueLink:this.linkState("shouldPublishSucceed"),shouldTranslate:!1,labelAfterSymbol:!0}),e.createElement(i.Checkbox,{className:"checkbox-field",label:"Site is Premium",valueLink:this.linkState("isPremiumUser"),shouldTranslate:!1,labelAfterSymbol:!0}),e.createElement(i.Checkbox,{className:"checkbox-field",label:"First Publish",valueLink:this.linkState("isFirstPublish"),shouldTranslate:!1,labelAfterSymbol:!0}),e.createElement(i.Checkbox,{className:"checkbox-field",label:"Is Domain Connected",valueLink:this.linkState("isDomainConnected"),shouldTranslate:!1,labelAfterSymbol:!0}),e.createElement(s.textInput,{className:"domain-text-field",shouldTranslate:!1,label:"Site address (Domain Name)",valueLink:this.linkState("sitePremiumDomain")}),e.createElement(s.button,{className:"confirm-button",disabled:!this.state.isPremiumUser&&this.state.isDomainConnected&&this.state.shouldPublishSucceed,shouldTranslate:!1,label:"Start Publish",onClick:this.onConfirm}))}}),define("savePublish/panels/publish/config/publishConfigurationPanel",["react","create-react-class","prop-types","core","savePublish/panels/publish/config/publishConfigurationPanel.rt"],function(e,t,n,s,i){"use strict";return t({displayName:"publishConfigurationPanel",mixins:[e.addons.LinkedStateMixin,s.mixins.editorAPIMixin],propTypes:{onConfirm:n.func.isRequired,panelName:n.string},getInitialState:function(){return{isSiteContributor:!1,isFirstPublish:!0,isDomainConnected:!1,isPremiumUser:!0,shouldPublishSucceed:!0,sitePremiumDomain:"http://www.published-site-domain.com"}},onConfirm:function(){this.props.onConfirm({isSiteContributor:this.state.isSiteContributor,isFirstPublish:this.state.isFirstPublish,isDomainConnected:this.state.isDomainConnected,sitePremiumDomain:this.state.sitePremiumDomain,isPremiumUser:this.state.isPremiumUser,shouldPublishSucceed:this.state.shouldPublishSucceed})},close:function(){this.getEditorAPI().panelManager.closePanelByName(this.props.panelName)},render:i})}),define("savePublish/panels/publish/content/postPublishPromotePanel.rt",["react","lodash","baseUILib","baseUI"],function(e,t,n,s){"use strict";return function(){return e.createElement("div",{className:"panel-shout-out"},e.createElement("div",{className:"promote-title-wrapper"},e.createElement(n.Divider,{long:!0}),e.createElement("div",{className:"promote-title"},this.getTitle()),e.createElement(n.Divider,{long:!0})),e.createElement.apply(this,["div",{className:"promotion-content"},t.map(this.getPanelContent(),function(t,n){return e.createElement("div",{className:"promote"},t.symbol?e.createElement("div",{key:"promotionSymbol-"+t.key,className:"promote-symbol promote-symbol-"+t.key},e.createElement(s.symbol,{name:t.symbol})):null,t.img&&!t.symbol?e.createElement("div",{key:"promotionImg-"+t.key,className:"promote-image",style:{backgroundImage:"url("+t.img+")"}}):null,e.createElement("div",{className:"description"},t.description),e.createElement("a",{onClick:t.action},t.actionTitle))}.bind(this))]))}}),define("savePublish/panels/publish/content/shoutoutPanel",["lodash","create-react-class","prop-types","core","util","experiment","savePublish/panels/publish/content/postPublishPromotePanel.rt"],function(e,t,n,s,i,a,o){"use strict";return t({displayName:"shoutoutPanel",mixins:[s.mixins.editorAPIMixin],propTypes:{isUserPremium:n.bool,languageCode:n.string,metaSiteId:n.string.isRequired,sitePublicUrl:n.string,siteNameSEO:n.string,siteDescriptionSEO:n.string,isFirstPublish:n.bool,userStatus:n.string},getTitle:function(){return i.translate("PUBLISH_CONGRATULATIONS_WHATS_NEXT_TITLE")},getPanelContent:function(){var e={key:"facebook",symbol:"publishFacebook",description:i.translate("PUBLISH_CONGRATULATIONS_WHATS_NEXT_1_TITLE"),actionTitle:i.translate("PUBLISH_CONGRATULATIONS_WHATS_NEXT_1_LINK"),action:this.openFacebook},t={key:"seo",symbol:"publishSeo",description:i.translate("PUBLISH_CONGRATULATIONS_WHATS_NEXT_SEO_TITLE"),actionTitle:i.translate("PUBLISH_CONGRATULATIONS_WHATS_NEXT_SEO_LINK"),action:this.openSeoWizard},n={key:"twitter",symbol:"publishTwitter",description:i.translate("PUBLISH_CONGRATULATIONS_WHATS_NEXT_2_TITLE"),actionTitle:i.translate("PUBLISH_CONGRATULATIONS_WHATS_NEXT_2_LINK"),action:this.openTwitter},s={key:"shoutout",symbol:"publishShoutout",description:i.translate("PUBLISH_CONGRATULATIONS_WHATS_NEXT_3_TITLE"),actionTitle:i.translate("PUBLISH_CONGRATULATIONS_WHATS_NEXT_3_LINK"),action:this.openShoutout};return this.getEditorAPI().account.isWixSEOWizExperimentOpen()&&a.isOpen("se_seoWizard")?[t,n,s]:[e,n,s]},openFacebook:function(){this.sendSecondPublishBI(s.bi.events.publish.Second_Publish_facebook_Share_click),s.utils.social.openFacebook(this.props.sitePublicUrl,this.props.languageCode,this.props.siteNameSEO,this.props.siteDescriptionSEO)},openSeoWizard:function(){this.sendSecondPublishBI(s.bi.events.publish.Second_Publish_Seo_Wizard_click),this.getEditorAPI().account.openWixSEOWiz("EDITOR_POSTPUBLISH")},openTwitter:function(){this.sendSecondPublishBI(s.bi.events.publish.Second_Publish_Twitter_share_click),s.utils.social.openTwitter(this.props.sitePublicUrl,this.props.isUserPremium)},openShoutout:function(){this.sendSecondPublishBI(s.bi.events.publish.Second_Publish_ShoutOut_Share_click),s.utils.social.openShoutout(this.props.metaSiteId)},sendSecondPublishBI:function(e){!this.props.isFirstPublish&&this.props.userStatus&&this.getEditorAPI().bi.event(e,{user_status:this.props.userStatus})},render:o})}),define("savePublish/panels/publish/content/growBusinessPanel",["create-react-class","prop-types","core","util","experiment","savePublish/panels/publish/content/postPublishPromotePanel.rt"],function(e,t,n,s,i,a){"use strict";return e({displayName:"growBusinessPanel",mixins:[n.mixins.editorAPIMixin],propTypes:{metaSiteId:t.string.isRequired,isFirstPublish:t.bool,userStatus:t.string},getTitle:function(){return s.translate("PUBLISH_CONGRATULATIONS_NEXT_PROMOTE_TITLE")},getPanelContent:function(){var e={key:"seo",symbol:"publishSeo",description:s.translate("PUBLISH_CONGRATULATIONS_WHATS_NEXT_SEO_TITLE"),actionTitle:s.translate("PUBLISH_CONGRATULATIONS_WHATS_NEXT_SEO_LINK"),action:this.openSeoWizard},t={key:"newsletter",symbol:"publishShoutout",description:s.translate("PUBLISH_CONGRATULATIONS_NEXT_PROMOTE_1_TITLE"),actionTitle:s.translate("PUBLISH_CONGRATULATIONS_NEXT_PROMOTE_1_LINK"),action:this.openShoutout},n={key:"mail",symbol:"promoteMail",description:s.translate("PUBLISH_CONGRATULATIONS_NEXT_PROMOTE_2_TITLE"),actionTitle:s.translate("PUBLISH_CONGRATULATIONS_NEXT_PROMOTE_2_LINK"),action:this.getYourOwnMailbox},a={key:"traffic",symbol:"promoteContact",description:s.translate("PUBLISH_CONGRATULATIONS_NEXT_PROMOTE_3_TITLE"),actionTitle:s.translate("PUBLISH_CONGRATULATIONS_NEXT_PROMOTE_3_LINK"),action:this.getTrafficApps};return i.isOpen("newPublishPanel")?[t,n,e]:[t,n,a]},openSeoWizard:function(){this.props.userStatus&&this.getEditorAPI().bi.event(n.bi.events.publish.Second_Publish_Seo_Wizard_click,{user_status:this.props.userStatus}),this.getEditorAPI().account.openWixSEOWiz("EDITOR_POSTPUBLISH_PREMIUM")},openShoutout:function(){this.sendPublishBI(n.bi.events.publish.First_Publish_Send_ShoutOut_link_click,n.bi.events.publish.Second_Publish_ShoutOut_Share_click),n.utils.social.openShoutout(this.props.metaSiteId)},getYourOwnMailbox:function(){this.sendPublishBI(n.bi.events.publish.First_Publish_get_own_Mailbox_link_click,n.bi.events.publish.Second_Publish_get_own_Mailbox_click),window.open("https://premium.wix.com/wix/api/googleMailBoxConsole?referralAdditionalInfo=da_quick_actions")},getTrafficApps:function(){this.sendPublishBI(n.bi.events.publish.First_Publish_Traffic_Apps_link_click,n.bi.events.publish.Second_Publish_Traffic_Apps_click);var e=["//www.wix.com/my-account/sites/",this.props.metaSiteId,"/apps/all?referralInfo=premium_publish"].join("");window.open(e)},sendPublishBI:function(e,t){this.props.isFirstPublish&&this.props.userStatus?this.getEditorAPI().bi.event(e,{user_status:this.props.userStatus}):!this.props.isFirstPublish&&this.props.userStatus&&this.getEditorAPI().bi.event(t,{user_status:this.props.userStatus})},render:a})}),define("savePublish/panels/content/musicPromoContent.rt",["react","lodash","savePublish/panels/content/generalContent"],function(e,t,n){"use strict";return function(){return e.createElement(n,function(e,n){var s=t.assign({},e,n);return e.hasOwnProperty("style")&&(s.style=t.defaults(s.style,e.style)),e.hasOwnProperty("className")&&n.hasOwnProperty("className")&&(s.className=n.className+" "+e.className),s}({className:"music-promo-content "+this.props.className},this.getGeneralContentProps()))}}),define("savePublish/panels/content/musicPromoContent",["create-react-class","prop-types","lodash","core","util","staticAssets","savePublish/panels/content/musicPromoContent.rt"],function(e,t,n,s,i,a,o){"use strict";return e({displayName:"musicPromoContent",propTypes:{className:t.string,closePanel:t.func.isRequired},mixins:[s.mixins.editorAPIMixin],getGeneralContentProps:function(){var e=void 0,t=void 0;i.browserUtil.getDevicePixelRatio()>=2?(e=i.media.getMediaUrl(a.staticAssetsMap["savePublish/panels/content/musicPromotionRetina.png"]),t={width:110.5}):e=i.media.getMediaUrl(a.staticAssetsMap["savePublish/panels/content/musicPromotion.png"]);return{className:"",imageSrc:e,imageStyle:t,mainTitle:i.translate("SAVE_SITE_SAVED_WHATS_NEXT_LABEL"),title:i.translate("MUSIC_PROMOTION_PUBLISH_WHATS_NEXT_TITLE"),subtitle:i.translate("MUSIC_PROMOTION_PUBLISH_WHATS_NEXT_BODY1"),actionLabel:i.translate("MUSIC_PROMOTION_PUBLISH_WHATS_NEXT_BUTTON"),shouldTranslate:!1,actionCallback:this.handleActionClicked}},handleActionClicked:function(){var e=s.bi.events.musicPromotionPopup.submit_video_clicked;this.getEditorAPI().bi.event(e,{origin:"post-publish-link"});var t=i.translate("MUSIC_PROMOTION_PUBLISH_WHATS_NEXT_BUTTON_URL");this.props.closePanel(),window.open(t)},render:o})}),define("savePublish/panels/content/photographyPromoContent.rt",["react","lodash","savePublish/panels/content/generalContent"],function(e,t,n){"use strict";return function(){return e.createElement(n,function(e,n){var s=t.assign({},e,n);return e.hasOwnProperty("style")&&(s.style=t.defaults(s.style,e.style)),e.hasOwnProperty("className")&&n.hasOwnProperty("className")&&(s.className=n.className+" "+e.className),s}({className:"photo-promo-content "+this.props.className},this.getGeneralContentProps()))}}),define("savePublish/panels/content/photographyPromoContent",["create-react-class","prop-types","lodash","core","util","staticAssets","savePublish/panels/content/photographyPromoContent.rt"],function(e,t,n,s,i,a,o){"use strict";return e({displayName:"photographyPromoContent",propTypes:{className:t.string,closePanel:t.func.isRequired},mixins:[s.mixins.editorAPIMixin],getGeneralContentProps:function(){var e=void 0,t=void 0;return i.browserUtil.getDevicePixelRatio()>=2?(e=i.media.getMediaUrl(a.staticAssetsMap["savePublish/panels/content/photoPromotionRetina.gif"]),t={width:"100%"}):e=i.media.getMediaUrl(a.staticAssetsMap["savePublish/panels/content/photoPromotion.gif"]),{className:"",imageSrc:e,imageStyle:t,mainTitle:i.translate("SAVE_SITE_SAVED_WHATS_NEXT_LABEL"),title:i.translate("PHOTO_PROMO_PUBLISH_HEADER"),subtitle:i.translate("PHOTO_PROMO_PUBLISH_TEXT"),actionLabel:i.translate("PHOTO_PROMO_PUBLISH_CTA"),shouldTranslate:!1,actionCallback:this.handleActionClicked}},handleActionClicked:function(){var e=s.bi.events.photographyPromotionPopup.submit_video_clicked;this.getEditorAPI().bi.event(e,{origin:"post-publish-link"});var t=i.translate("PHOTO_PROMO_PUBLISH_CTA_URL");this.props.closePanel(),window.open(t)},render:o})}),define("savePublish/panels/publish/publishSuccessPanel.rt",["react","lodash","panels","util","baseUI","baseUILib","symbols"],function(e,t,n,s,i,a,o){"use strict";return function(){function r(){var r=this.getInnerPanel();return e.createElement(n.frames.focusPanelFrame,function(e,n){var s=t.assign({},e,n);return e.hasOwnProperty("style")&&(s.style=t.defaults(s.style,e.style)),e.hasOwnProperty("className")&&n.hasOwnProperty("className")&&(s.className=n.className+" "+e.className),s}({className:this.getFrameClass(),frameClassName:"save-publish-panel-frame",keyboardShortcuts:this.getShortcuts()},this.getFrameProps()),e.createElement("header",{className:"save-publish-panel-header"},e.createElement("button",{className:"close",onClick:this.props.closePanel},e.createElement(o.symbol,{name:"headerCloseButton"})),e.createElement("span",{className:"title"},s.translate("PUBLISH_CONGRATULATIONS_TITLE_TITLE")),e.createElement("span",{className:"subtitle"},s.translate("PUBLISH_CONGRATULATIONS_TITLE_SUBTITLE"))),e.createElement("div",{className:"address-bar-wrapper"},e.createElement("span",{className:"address"},e.createElement(i.domainInput,{value:this.getSiteUrl(),isEditable:!1,biHandler:this.domainInputBiReporter})),e.createElement(i.button,{className:"view-site-button",label:"SAVE_PUBLISH_BUTTON_VIEW",onClick:this.viewYourSite})),null!==r?e.createElement("div",{key:"innerPanel",className:"publish-inner-panel"},r):null,e.createElement("div",{className:"publish-success-footer"},this.isDontShowAgainCheckboxVisible()&&null!==r?e.createElement(a.Checkbox,{key:"dontShowAgain",className:"dont-show-again",label:"SAVE_PUBLISH_DO_NOT_SHOW_AGAIN_LABEL",value:this.state.dontShowAgain,onChange:this.toggleDontShowAgain,labelAfterSymbol:!0}):null,e.createElement("div",{className:"footer-buttons"},this.isSecondaryButtonDisplayed()?e.createElement(i.button,{key:"secondaryFooterButton",className:"btn-confirm-secondary",label:this.getSecondaryButtonText(),onClick:this.handleSecondaryButtonClicked}):null,e.createElement(i.button,{className:"btn-confirm-primary",label:this.getPrimaryButtonText(),onClick:this.handlePrimaryButtonClicked}))))}return r.apply(this,[])}}),define("savePublish/panels/publish/publishSuccessPanel",["react","create-react-class","lodash","prop-types","core","stateManagement","savePublish/panels/publish/publishInnerPanelTypes","savePublish/panels/publish/content/shoutoutPanel","savePublish/panels/publish/content/growBusinessPanel","savePublish/panels/content/connectDomain","savePublish/panels/content/musicPromoContent","savePublish/panels/content/photographyPromoContent","savePublish/panels/publish/publishSuccessPanel.rt","experiment"],function(e,t,n,s,i,a,o,r,l,c,u,p,h,m){"use strict";var d=a.domain.selectors;return t({displayName:"publishSuccessPanel",mixins:[e.addons.LinkedStateMixin,i.mixins.editorAPIMixin],propTypes:{isFakePanel:s.bool,contentPanelType:function(e,t,s){if(!e[t]||!n.some(o,e[t]))return new Error("Invalid prop `"+t+"` supplied to "+s+". Validation failed.")},configuration:s.object.isRequired,currentDomain:s.string.isRequired,setDontShowPanelValue:s.func.isRequired,sitePublicUrl:s.string.isRequired,closePanel:s.func.isRequired,panelName:s.string},componentDidMount:function(){this.sendPanelMountedBI()},getInitialState:function(){return{dontShowAgain:!1}},getShortcuts:function(){return{esc:this.onClose,enter:this.handlePrimaryButtonClicked}},onClose:function(){this.getEditorAPI().panelManager.closePanelByName(this.props.panelName)},getFrameProps:function(){return{panelName:this.props.panelName,shouldHideHeader:!0}},getInnerContentClass:function(){if(this.props.contentPanelType===o.EMPTY)return null;switch(this.props.contentPanelType.name){case o.SHOUTOUT.name:return"grow-business-inner-panel";case o.CONNECT_DOMAIN.name:return"connect-domain-inner-panel";case o.GROW_BUSINESS.name:return"grow-business-inner-panel";case o.MUSIC_PROMO.name:return"music-promo-inner-panel";case o.PHOTOGRAPHY_PROMO.name:return"photo-promo-inner-panel";default:return""}},getFrameClass:function(){var e="publish-success-panel save-publish-panel",t=this.getInnerContentClass();return e+=t?" contains-"+t:""},onDoneAndBI:function(e){this.sendActionButtonClickedBI(e),this.onDone()},onDone:function(){if(this.state.dontShowAgain||this.props.isFakePanel){if(this.props.contentPanelType.userPref){var e=this.state.dontShowAgain;this.props.setDontShowPanelValue(e)}}this.props.closePanel()},isDontShowAgainCheckboxVisible:function(){return!this.props.configuration.isFirstPublish&&!n.isEqual(this.props.contentPanelType,o.EMPTY)},isSecondaryButtonDisplayed:function(){return m.isOpen("publishUpgradeButtons")&&!this.props.configuration.isDomainConnected&&this.props.contentPanelType.name===o.CONNECT_DOMAIN.name},viewYourSite:function(){this.sendViewSiteBI();var e=this.getEditorAPI().site.getSitePublicUrl();this.props.configuration.isDomainConnected&&(e=this.props.configuration.sitePremiumDomain),window.open(e)},getSiteUrl:function(){var e=this.getEditorAPI(),t=e.store.getState(),n=d.getSiteProtocol(t,e.documentServices),s=d.isDomainConnected(t,e.documentServices);return(this.props.configuration.sitePremiumDomain||this.props.sitePublicUrl).replace(/(?:^https?:\/\/)?(?:www\.)?(.*)/i,n+(s?"://www.$1":"://$1"))},getInnerPanel:function(){if(this.props.contentPanelType===o.EMPTY)return null;var t=null,n=null;switch(this.props.contentPanelType.name){case o.SHOUTOUT.name:t=r,n=this.getShoutoutPanelProps();break;case o.CONNECT_DOMAIN.name:t=c,n=this.getConnectDomainPanelProps(this.props.configuration);break;case o.GROW_BUSINESS.name:t=l,n={metaSiteId:this.getEditorAPI().documentServices.generalInfo.getMetaSiteId(),userStatus:this.getUserStatus(),isFirstPublish:this.props.configuration.isFirstPublish};break;case o.MUSIC_PROMO.name:t=u,n={closePanel:this.onDone};break;case o.PHOTOGRAPHY_PROMO.name:t=p,n={closePanel:this.onDone}}return t?e.createElement(t,n):null},getShoutoutPanelProps:function(){var e=this.getEditorAPI();return{isUserPremium:this.props.configuration.isPremiumUser,languageCode:e.getLanguageCode(),metaSiteId:e.documentServices.generalInfo.getMetaSiteId(),sitePublicUrl:this.props.sitePublicUrl,siteNameSEO:e.documentServices.seo.title.get(),siteDescriptionSEO:e.documentServices.seo.description.get(),userStatus:this.getUserStatus(),isFirstPublish:this.props.configuration.isFirstPublish}},getConnectDomainPanelProps:function(e){return{isFirstPublish:e.isFirstPublish,isDomainConnected:e.isDomainConnected,currentDomain:this.props.sitePublicUrl,sitePublishedDomain:e.sitePremiumDomain,isSitePremium:e.isPremiumUser,isFirstSave:e.isFirstSave,closePanel:this.onDone,flowId:i.constants.CONNECT_DOMAIN.FLOWS.PUBLISH,actionCallback:this.sendConnectDomainClickedBI}},getPrimaryButtonText:function(){return this.isSecondaryButtonDisplayed()?this.props.configuration.isPremiumUser?"Save_Publish_POST_CONNECT_NOW":(m.isOpen("spanishUpgradeText"),"Save_Publish_POST_UPGRADE_NOW"):"SAVE_PUBLISH_BUTTON_DONE"},getSecondaryButtonText:function(){return"Save_Publish_POST_CONNECT_LATER"},handlePrimaryButtonClicked:function(){var e=this.props.configuration.isFirstPublish,t=i.bi.events.publish,n=e?t.First_Publish_Done_click:t.Second_Publish_Done_click;if(this.isSecondaryButtonDisplayed())if(this.isConnectDomainInProgress())this.openConnectDomainInProgressPanel(),n=t.publish_flow_connect_domain_now_button_click;else if(this.props.configuration.isPremiumUser)this.getEditorAPI().account.openConnectDomain(i.constants.CONNECT_DOMAIN.FLOWS.PUBLISH_BUTTON,e),n=t.publish_flow_connect_domain_now_button_click;else{var s="edhtml_PUBLISH_FLOW_UPGRADE_BUTTON_"+(e?"FIRST_PUBLISH":"SECOND_PUBLISH");this.getEditorAPI().account.upgrade(s),n=t.publish_flow_upgrade_now_button_click}this.onDoneAndBI(n)},handleSecondaryButtonClicked:function(){var e=this.props.configuration.isFirstPublish,t=i.bi.events.publish,n=e?t.First_Publish_Done_click:t.Second_Publish_Done_click;this.isSecondaryButtonDisplayed()&&(n=this.props.configuration.isPremiumUser?t.publish_flow_connect_domain_later_button_click:t.publish_flow_upgrade_later_button_click),this.onDoneAndBI(n)},isConnectDomainInProgress:function(){var e=this.props.configuration.sitePremiumDomain,t=this.props.configuration.isDomainConnected,s=this.props.configuration.isPremiumUser,i=!n.isEmpty(e)&&!n.includes(e,"wix.com");return s&&i&&!t},openConnectDomainInProgressPanel:function(){this.getEditorAPI().panelManager.openPanel("savePublish.panels.connectDomainInProgress",{connectedDomainURL:this.props.configuration.sitePremiumDomain,currentPublicURL:this.props.sitePublicUrl},!0)},sendPanelMountedBI:function(){var e=i.bi.events.publish.publish_success_panel_opened_with_content,t={is_first_publish:this.props.configuration.isFirstPublish,message:this.props.contentPanelType.name};this.sendBI(e,t)},sendConnectDomainClickedBI:function(){var e=null,t=null;e=this.props.configuration.isFirstPublish?i.bi.events.publish.First_Publish_connect_domain_click:i.bi.events.publish.Second_Publish_connect_domain_click,this.props.configuration.isSitePremium&&!this.props.configuration.isDomainConnected?t={user_status:"Not Connected Premium"}:this.props.configuration.isSitePremium||(t={user_status:"free user"}),e.fields.message&&(t.message=this.props.contentPanelType.name),e&&t&&this.sendBI(e,t)},sendActionButtonClickedBI:function(e){var t=this.props.configuration.isFirstPublish,n={user_status:this.getUserStatus()};e.fields.is_first_publish&&(n.is_first_publish=t),e.fields.message&&(n.message=this.props.contentPanelType.name),this.sendBI(e,n)},sendViewSiteBI:function(){this.sendBI(i.bi.events.publish.publish_view_your_site_click,{is_first_publish:this.props.configuration.isFirstPublish?1:0,panel_name:"savePublish.panels.publish.publishSuccessPanel",user_status:this.getUserStatus()})},getUserStatus:function(){var e=this.props.configuration.isPremiumUser,t=this.props.configuration.isDomainConnected,n=null;return e?e&&t?n="Connected Premium":e&&!t&&(n="Not Connected Premium"):n="free user",n},toggleDontShowAgain:function(){var e=!this.state.dontShowAgain;this.sendToggleDontShowAgainBI(e),this.setState({dontShowAgain:e})},sendToggleDontShowAgainBI:function(e){e=e?1:0,this.props.configuration.isFirstPublish?this.sendBI(i.bi.events.publish.First_Publish_dont_show_again_click,{toggle:e,user_status:this.getUserStatus()}):this.sendBI(i.bi.events.publish.Second_Publish_dont_show_again_click,{toggle:e})},domainInputBiReporter:function(e){var t={user_status:this.getUserStatus(),panel_name:this.props.panelName,save_or_publish:"publish",is_first_save_or_publish:this.props.configuration.isFirstPublish?1:0};this.sendBI(i.bi.events.domainInput[e],t)},sendBI:function(e,t){this.getEditorAPI().bi.event(e,t)},render:h})}),define("savePublish/panels/publish/publishPanels",["savePublish/panels/publish/config/publishConfigurationPanel","savePublish/panels/publish/publishSuccessPanel","savePublish/panels/publish/content/shoutoutPanel"],function(e,t,n){"use strict";return{config:{publishConfigurationPanel:e},publishSuccessPanel:t,shoutOut:n}}),define("savePublish",["lodash","savePublish/managers/saveManagerWrapper","savePublish/managers/autosaveManager","savePublish/managers/mockSaveManager","savePublish/managers/publishManager","savePublish/panels/connectDomain/connectDomainPanel","savePublish/panels/connectDomain/connectDomainInProgress","savePublish/panels/common/commonPanels","savePublish/panels/save/savePanels","savePublish/panels/publish/publishPanels"],function(e,t,n,s,i,a,o,r,l,c){"use strict";return{createSaveManager:t,createPublishManager:i,createAutosaveManager:n,configureSave:s.save,panels:{connectDomain:a,connectDomainInProgress:o,common:r,publish:c,save:l}}});
//# sourceMappingURL=savePublish.min.js.map