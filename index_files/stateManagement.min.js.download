function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}define("stateManagement/store/combineReducers",["lodash","wixImmutable"],function(e,t){"use strict";return function(n,r){return r?function(n){var r=function(e){return t.Iterable.isIterable(e)}(n)?n:t.Map(n),a=r.map(function(){});return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,n=arguments[1],s=!1,o=t.map(function(t,a){var o=(r.get(a)||e.identity)(t,n);return o!==t&&(s=!0),o});return s?o:t}}(n):function(t){return function(n,r){var a=!1,s=e.mapValues(n,function(n,s){var o=(t[s]||e.identity)(n,r);return o!==n&&(a=!0),o});return a?s:n}}(n)}}),define("stateManagement/panels/panelsActionTypes",[],function(){"use strict";return{OPEN_PANEL:"openPanel",UPDATE_PANEL:"updatePanel",CLOSE_ALL_PANELS:"closeAllPanels",CLOSE_PANEL_BY_NAME:"closePanelByName",CLOSE_PANEL_BY_PROP:"closePanelByProp",STAGE_MOUSE_DOWN:"STAGE_MOUSE_DOWN",OPEN_HELP_CENTER:"openHelpCenter",CLOSE_HELP_CENTER:"closeHelpCenter"}}),define("stateManagement/panels/panelsReducer",["lodash","stateManagement/panels/panelsActionTypes","constants"],function(e,t,n){"use strict";var r=t.OPEN_PANEL,a=t.UPDATE_PANEL,s=t.CLOSE_ALL_PANELS,o=t.CLOSE_PANEL_BY_NAME,i=t.CLOSE_PANEL_BY_PROP,u=t.STAGE_MOUSE_DOWN,l=[n.PANEL_TYPES.LEFT,n.PANEL_TYPES.PAGES,n.PANEL_TYPES.TPA_SETTINGS];return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments[1];switch(n.type){case r:return t.concat(n.panelDescriptor);case a:return e.map(t,function(t){return t.name===n.panelDescriptor.name?e.assign({},t,n.panelDescriptor,{props:e.assign({},t.props,n.panelDescriptor.props)}):t});case o:return e.reject(t,{name:n.panelName});case i:return e.reject(t,function(e){return e.props[n.prop]===n.propValue});case s:return t.length?[]:t;case u:return e.reject(t,function(t){return e.includes(l,t.frameType)});default:return t}}}),define("stateManagement/selection/selectionActionTypes",[],function(){"use strict";return{SELECT_COMPONENTS:"selectComponents",ADD_TO_SELECTION:"addToSelection",CLEAR_SELECTED_COMPONENTS:"clearSelectedComponents",SET_SELECTED_COMPS_RESTRICTIONS:"setSelectedCompsRestrictions"}}),define("stateManagement/selection/selectionReducer",["lodash","coreUtilsLib","stateManagement/selection/selectionActionTypes"],function(e,t,n){"use strict";var r=n.SELECT_COMPONENTS,a=n.ADD_TO_SELECTION,s=n.CLEAR_SELECTED_COMPONENTS,o=n.SET_SELECTED_COMPS_RESTRICTIONS,i={selectedComponents:[],compRestrictions:{}};return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i,u=arguments[1];switch(u.type){case r:return e.isArray(u.compRefs)?e.defaults({selectedComponents:u.compRefs},n):(t.log.error("selected comps must be an array"),n);case a:return e.isArray(u.compRefs)?e.defaults({selectedComponents:n.selectedComponents.concat(u.compRefs)},n):(t.log.error("selected comps must be an array"),n);case s:return e.defaults({selectedComponents:[]},n);case o:return e.defaults({compRestrictions:u.restrictions},n);default:return n}}}),define("stateManagement/userProfile/userProfileActionTypes",[],function(){"use strict";return{SET_USER_PROFILE:"setUserProfile"}}),define("stateManagement/userProfile/userProfileReducer",["stateManagement/userProfile/userProfileActionTypes"],function(e){"use strict";var t=e.SET_USER_PROFILE;return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments[1];switch(n.type){case t:return n.userProfile;default:return e}}}),define("stateManagement/highlights/highlightsActionTypes",[],function(){"use strict";return{ADD_TO_HIGHLIGHTS:"addToHighlights",REMOVE_COMPS_FROM_HIGHLIGHTS:"removeCompsFromHighlights",SET_HIGHLIGHTS:"setHighlights",CLEAR_HIGHLIGHTS:"clearHighlights",REMOVE_FROM_HIGHLIGHTS_BY_HIGHLIGHT_TYPE:"removeFromHighlightsByHighlightType"}}),define("stateManagement/highlights/highlightsReducer",["lodash","coreUtilsLib","stateManagement/highlights/highlightsActionTypes"],function(e,t,n){"use strict";var r=n.ADD_TO_HIGHLIGHTS,a=n.REMOVE_COMPS_FROM_HIGHLIGHTS,s=n.SET_HIGHLIGHTS,o=n.CLEAR_HIGHLIGHTS,i=n.REMOVE_FROM_HIGHLIGHTS_BY_HIGHLIGHT_TYPE;return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],u=arguments[1];switch(u.type){case r:return e.isArray(u.highlightsDefs)?n.concat(u.highlightsDefs):(t.log.error("highlights must be an array"),n);case a:return e.isArray(u.compRefs)?e.reject(n,function(t){return e.find(u.compRefs,t.compRef)}):(t.log.error("highlights must be an array"),n);case i:return e.isArray(u.highlightTypes)?e.reject(n,function(t){return e.includes(u.highlightTypes,t.type)}):(t.log.error("highlightTypes must be an array"),n);case s:return e.isArray(u.highlightsDefs)?u.highlightsDefs:(t.log.error("highlights must be an array"),n);case o:return[];default:return n}}}),define("stateManagement/pinMode/pinModeActionTypes",[],function(){"use strict";return{OPEN_PIN_MODE:"openPinMode",CLOSE_PIN_MODE:"closePinMode",SHOW_PIN_PREVIEW_RECT:"showPinPreviewRect",HIDE_COMPONENT_PREVIEW_RECT:"hideComponentPreviewRect"}}),define("stateManagement/pinMode/pinModeReducer",["lodash","stateManagement/pinMode/pinModeActionTypes"],function(e,t){"use strict";return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments[1];switch(r.type){case t.OPEN_PIN_MODE:return e.defaults({isOpen:!0},n);case t.CLOSE_PIN_MODE:return e.defaults({isOpen:!1},n);case t.SHOW_PIN_PREVIEW_RECT:return e.defaults({pinPreviewRectStyle:r.style},n);case t.HIDE_COMPONENT_PREVIEW_RECT:var a=e.defaults({opacity:0},n.pinPreviewRectStyle);return e.defaults({pinPreviewRectStyle:a},n);default:return n}}}),define("stateManagement/easterEggs/easterEggsActionTypes",[],function(){"use strict";return{SET_FLYING_MUSA_STYLE:"setFlyingMusaStyle",CLEAR_FLYING_MUSA_STYLE:"clearFlyingMusaStyle"}}),define("stateManagement/easterEggs/easterEggsActions",["lodash","stateManagement/easterEggs/easterEggsActionTypes"],function(e,t){"use strict";var n=function(e){return{type:t.SET_FLYING_MUSA_STYLE,musaData:e}},r=function(e){return{type:t.CLEAR_FLYING_MUSA_STYLE,id:e}};return{showFlyingMusa:function(t){return function(a){var s=e.uniqueId(),o=8+Math.floor(5*Math.random()),i=-200,u=72+Math.random()*(t.height-144),l=72+Math.random()*(t.height-144),c=Math.abs(u-l)*(o/t.width);l<u&&(c*=-1);var p=u,d=0,f={height:3608,width:143};a(n({id:s,style:{top:u+"px",right:i+"px",backgroundPosition:"0 "+d+"px;"}}));var g=setInterval(function(){a(n({id:s,style:{right:(i+=o)+"px",top:(p+=c)+"px",backgroundPosition:"0 -"+d+"px"}})),d=(d+82)%f.height,i>t.width+f.width&&(clearInterval(g),clearTimeout(E),a(r(s)))},33),m=33*(10+(t.width+f.width)/o),E=setTimeout(function(){clearInterval(g),a(r(s))},m)}}}}),define("stateManagement/easterEggs/easterEggsSelectors",[],function(){"use strict";return{getFlyingMusaStyle:function(e,t){return e.easterEggs.flyingMusa[t].style}}}),define("stateManagement/easterEggs/easterEggsReducer",["lodash","stateManagement/easterEggs/easterEggsActionTypes"],function(e,t){"use strict";return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments[1];switch(r.type){case t.SET_FLYING_MUSA_STYLE:var a=e.defaults(_defineProperty({},r.musaData.id,r.musaData),n.flyingMusa);return e.defaults({flyingMusa:a},n);case t.CLEAR_FLYING_MUSA_STYLE:return e.defaults({flyingMusa:e.omit(n.flyingMusa,[r.id])},n);default:return n}}}),define("stateManagement/easterEggs/easterEggs",["stateManagement/easterEggs/easterEggsActions","stateManagement/easterEggs/easterEggsSelectors","stateManagement/easterEggs/easterEggsReducer"],function(e,t,n){"use strict";return{actions:e,selectors:t,reducer:n}}),define("stateManagement/contextMenu/contextMenuActionTypes",[],function(){"use strict";return{OPEN_CONTEXT_MENU:"openContextMenu"}}),define("stateManagement/contextMenu/contextMenuReducer",["lodash","stateManagement/pinMode/pinModeActionTypes","stateManagement/contextMenu/contextMenuActionTypes"],function(e,t,n){"use strict";return function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=arguments[1];switch(a.type){case n.OPEN_CONTEXT_MENU:return e.defaults({editorMousePosition:{x:a.editorPositionX,y:a.editorPositionY},viewerPosition:{x:a.viewerPositionX,y:a.viewerPositionY}},r);case t.OPEN_PIN_MODE:return null;default:return r}}}),define("stateManagement/panels/helpPropsReducer",["lodash","stateManagement/panels/panelsActionTypes"],function(e,t){"use strict";var n=t.OPEN_HELP_CENTER,r=t.CLOSE_HELP_CENTER;return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments[1];switch(t.type){case n:return t.helpPanelProps;case r:return null;default:return e}}}),define("stateManagement/legacy/legacyActionTypes",[],function(){"use strict";return{SET_STATE:"set-state"}}),define("stateManagement/legacy/setStateReducer",["lodash","stateManagement/legacy/legacyActionTypes"],function(e,t){"use strict";var n=t.SET_STATE,r=e.assign;return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];switch(t.type){case n:return r({},e,t.state);default:return e}}}),define("stateManagement/legacy/legacyReducer",["lodash","stateManagement/legacy/setStateReducer"],function(e,t){"use strict";return function(e){return function(n,r){var a=t(n,r);return e(a,r)}}}),define("stateManagement/devMode/devModeActionTypes",[],function(){"use strict";return{RESET_CONTEXT:"resetContext"}}),define("stateManagement/devMode/devModeReducer",["lodash","constants","stateManagement/devMode/devModeActionTypes"],function(e,t,n){"use strict";var r={type:t.DEVELOPER_MODE.CONTEXT_TYPES.PAGE,data:void 0},a=n.RESET_CONTEXT;return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r;switch(arguments[1].type){case a:return r;default:return e}}}),define("stateManagement/store/initialEditorState",["constants"],function(e){"use strict";return{editorIsInit:!1,previewReady:!1,config:{topBarHeight:e.UI.TOPBAR_HEIGHT,previewHeight:null,previewWidth:null,languages:["latin"],extraSiteHeight:40},navControlsSize:null,previewPosition:{top:e.UI.TOPBAR_HEIGHT,left:0,height:0,width:0},editingAreaPosition:{top:0,left:0,height:0,width:0,right:0,bottom:0},wixCodeLoaded:!1,devModeContext:{type:e.DEVELOPER_MODE.CONTEXT_TYPES.PAGE,data:void 0},contextMenu:null,performingMouseMoveAction:!1,selection:{selectedComponents:[],compRestrictions:{}},userProfile:{},stage:{highlights:[]},uploadedFonts:{list:[],queue:[],uploadedItems:{},timeOutTokens:[]},focusedContainer:null,lastSelectionClickPos:null,previewMode:!1,isMobileEditor:!1,isLayoutTractorOpen:!1,snapData:null,lassoLayout:null,candidates:null,clipboard:{},site:{premiumPackage:void 0},topBar:{modeSwitchAnimationProgress:e.TOP_BAR.EDITOR_MODE_SWITCH.ANIMATION_PROGRESS.IDLE,openedDropPanel:null,dropPanelDisabled:!1,shouldDropPanelRemainOpen:!1},viewTools:{toolbarEnabled:void 0,developerToolBarEnabled:void 0,platformToolBarEnabled:void 0,guidelinesEnabled:void 0,sectionsHandlesEnabled:void 0,snapToEnabled:void 0,rulersEnabled:void 0,rulers:{guidesState:void 0,selectedGuide:void 0,isHovered:void 0,isDragging:null}},hasDatabaseCollections:null,platformToolBarPanelProps:void 0,helpProps:null,attachCandidate:null,constraintArea:null,openPanels:[],previewingStatus:e.PROGRESS_STATUS.IDLE,savingStatus:e.PROGRESS_STATUS.IDLE,publishingStatus:e.PROGRESS_STATUS.IDLE,savePublish:{isSaveInProgress:!1,isPublishInProgress:!1,isDiffSaveInProgress:!1,publishPanelPromotionIndex:0},sitePremiumState:null,portalComps:{},mobile:{isHiddenItemsCounterVisible:!0,reAddedHiddenElement:{compRef:null,addingPhase:e.LEFT_BAR.MOBILE_HIDDEN_ELEMENTS.PROGRESS.IDLE}},applyModeFromClipboardSuggestion:null,leftBar:{isCollapsed:!1,isMobileCollapsed:!1,notifications:{},superApps:{desktop:[],mobile:[]},buttonsBoundingRect:{}},topBarPagesFilter:"",topBarCustomization:{tooltipOverrides:{UNDO:null,SAVE:null}},pageSections:{sections:null,selectedSection:null},siteScale:1,pinMode:{isOpen:!1,pinPreviewRectStyle:{opacity:0}},hideTools:!1,hideToolsAndMaintainStagePosition:!1,shouldHideToolsBtnBlink:!1,halfOpacityTools:!1,unreadComments:0,isOpenTextEditor:!1,imageCrop:{isOn:!1,cropArea:null,cropOriginArea:null},shouldOverlayUpdate:!0,tabIndicationState:{indication:"INACTIVE",activeMode:void 0},floatingBubble:{value:null,targetLayout:null,bubbleProps:{},shouldNotHideOnMouseLeaveTarget:!1},tpa:{appsIdsToRefreshOnDashboardClose:[]},scrollTo:null,animateScrollTo:null,eventCounters:{focus:0,clearTextSelection:0,forceOpenPagesQuickNavigation:0,forcePageSettingsTab:0},viewerRendersCounter:0,userPreferences:{siteId:null,dontSaveUserPrefs:!1,session:{},site:{},global:null},easterEggs:{flyingMusa:null},__renderCounter:0}}),define("stateManagement/store/stateFreezer",["util"],function(e){"use strict";var t=e.deepFreeze;return function(e){return function(n,r){return t(e(n,r))}}}),define("stateManagement/leftBar/leftBarActionTypes",[],function(){"use strict";return{COLLAPSE_DESKTOP_MENU:"collapse-desktop-menu",COLLAPSE_MOBILE_MENU:"collapse-mobile-menu",EXPAND_BUTTON:"expand-button",COLLAPSE_BUTTON:"collapse-button",UPDATE_BUTTONS_BOUNDING_RECT:"update-buttons-bounding-rect",SET_NOTIFICATION_COUNT:"set-notification-count",INCREASE_NOTIFICATION_COUNT:"increase-notification-count",DECREASE_NOTIFICATION_COUNT:"decrease-notification-count",REMOVE_PANEL_NOTIFICATIONS:"removePanelNotifications",UPDATE_DESKTOP_SUPERAPP_BUTTON:"updateDesktopSuperappButton",UPDATE_MOBILE_SUPERAPP_BUTTON:"updatemobileSuperappButton",REMOVE_SUPERAPP_BUTTON:"removeSuperAppButton"}}),define("stateManagement/leftBar/leftBarReducer",["lodash","stateManagement/leftBar/leftBarActionTypes"],function(e,t){"use strict";var n=t.COLLAPSE_DESKTOP_MENU,r=t.COLLAPSE_MOBILE_MENU,a=t.EXPAND_BUTTON,s=t.COLLAPSE_BUTTON,o=t.UPDATE_BUTTONS_BOUNDING_RECT,i=t.SET_NOTIFICATION_COUNT,u=t.INCREASE_NOTIFICATION_COUNT,l=t.DECREASE_NOTIFICATION_COUNT,c=t.REMOVE_PANEL_NOTIFICATIONS,p=t.UPDATE_DESKTOP_SUPERAPP_BUTTON,d=t.UPDATE_MOBILE_SUPERAPP_BUTTON,f=t.REMOVE_SUPERAPP_BUTTON,g=function(t){return function(n,r){return e.defaults({superApps:e.defaults(_defineProperty({},t,r),n.superApps)},n)}},m=function(t){return function(n,r){var a=e.find(n.superApps[t],{panelName:r.panelName});if(a){var s=e.map(n.superApps[t],function(t){return t===a?e.defaults(r,t):t});return g(t)(n,s)}return g(t)(n,n.superApps[t].concat(r))}};return function(t,g){switch(g.type){case n:return e.assign({},t,{isCollapsed:!0});case r:return e.assign({},t,{isMobileCollapsed:!0});case a:return e.defaults({collapseOnClick:e.union(t.collapseOnClick,[g.panelName])},t);case s:return e.assign({},t,{collapseOnClick:e.without(t.collapseOnClick,g.panelName)});case o:var E=["left","right","top","bottom"],P=e.pick(t.buttonsBoundingRect,E),_=e.pick(g.boundingRect,E);return e.isEqual(P,_)?t:e.assign({},t,{buttonsBoundingRect:_});case i:return e.assign({},t,{notifications:e.assign({},t.notifications,_defineProperty({},g.panelName,g.count))});case u:return e.assign({},t,{notifications:e.assign({},t.notifications,_defineProperty({},g.panelName,t.notifications[g.panelName]+(g.count||1)))});case l:return e.assign({},t,{notifications:e.assign({},t.notifications,_defineProperty({},g.panelName,t.notifications[g.panelName]-(g.count||1)))});case f:var M={desktop:e.reject(t.superApps.desktop,{panelName:g.panelName}),mobile:e.reject(t.superApps.mobile,{panelName:g.panelName})};return e.defaults({superApps:M},t);case c:return e.defaults({notifications:e.omit(t.notifications,g.panelName)},t);case p:return m("desktop")(t,g.buttonParams);case d:return m("mobile")(t,g.buttonParams);default:return t}}}),define("stateManagement/userPreferences/userPreferencesActionTypes",[],function(){"use strict";return{SET_SITE_ID:"set-site-id",SET_PREFERENCES:"set-preferences",SET_PREFERENCE:"set-preference",MARK_SITE_PREFERENCES_NOT_DIRTY:"mark-site-preferences-not-dirty",DONT_SAVE_USER_PREFERENCES:"dont-save-user-preferences"}}),define("stateManagement/userPreferences/userPreferencesReducer",["lodash","stateManagement/userPreferences/userPreferencesActionTypes","stateManagement/store/initialEditorState"],function(e,t,n){"use strict";var r=t.SET_SITE_ID,a=t.SET_PREFERENCES,s=t.SET_PREFERENCE,o=t.MARK_SITE_PREFERENCES_NOT_DIRTY,i=t.DONT_SAVE_USER_PREFERENCES;return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n.userPreferences,u=arguments[1];switch(u.type){case r:return e.assign({},t,{siteId:u.siteId});case a:return e.assign({},t,_defineProperty({},u.typeId,u.preferences));case s:return e.assign({},t,_defineProperty({},u.typeId,e.assign({},t[u.typeId],_defineProperty({},u.key,u.value))));case o:return e.assign({},t,{site:e.mapValues(t.site,function(t){return e.assign({},t,{isDirty:!1})})});case i:return e.assign({},t,{dontSaveUserPrefs:!0});default:return t}}}),define("stateManagement/tpa/tpaActionTypes",[],function(){"use strict";return{ADD_APP_IDS_TO_REFRESH_ON_DASHBOARD_CLOSE:"ADD_APP_IDS_TO_REFRESH_ON_DASHBOARD_CLOSE",SET_APP_IDS_TO_REFRESH_ON_DASHBOARD_CLOSE:"SET_APP_IDS_TO_REFRESH_ON_DASHBOARD_CLOSE"}}),define("stateManagement/tpa/tpaReducer",["lodash","coreUtilsLib","stateManagement/tpa/tpaActionTypes"],function(e,t,n){"use strict";var r=n.ADD_APP_IDS_TO_REFRESH_ON_DASHBOARD_CLOSE,a=n.SET_APP_IDS_TO_REFRESH_ON_DASHBOARD_CLOSE,s=function(t){return e.reduce(t,function(e,t){return e[t]=!0,e},{})},o=function(e){return!i(e)},i=function(t){return e.isArray(t)&&t.every(function(t){return e.isNumber(t)&&t>0||e.isNumber(parseInt(t,10))&&parseInt(t,10)>0})};return function(n,i){switch(e.isNil(n)&&(n={appsIdsToRefreshOnDashboardClose:{}}),i.type){case r:if(o(i.appIds))return t.log.error("appIds found for appDefIds must be an array of numbers"),n;var u=n.appsIdsToRefreshOnDashboardClose,l=s(i.appIds),c=e.merge({},u,l);return e.assign({},n,{appsIdsToRefreshOnDashboardClose:c});case a:return o(i.appIds)?(t.log.error("appIds found for appDefIds must be an array of numbers"),n):e.assign({},n,{appsIdsToRefreshOnDashboardClose:s(i.appIds)});default:return n}}}),define("stateManagement/uploadedFonts/uploadedFontsActionTypes",[],function(){"use strict";return{SET_LIST:"setList",SET_QUEUE:"setQueue",SET_FLAG_TO_QUEUE_ITEM:"setFlagToQueueItem",SET_UPLOADED_ITEMS:"setUploadedItems",ADD_TIME_OUT_TOKEN:"addTimeOutToken",CLEAR_TIME_OUT_TOKENS:"clearTimeOutTokens"}}),define("stateManagement/uploadedFonts/uploadedFontsReducer",["lodash","stateManagement/uploadedFonts/uploadedFontsActionTypes"],function(e,t){"use strict";var n=t.SET_LIST,r=t.SET_QUEUE,a=t.SET_FLAG_TO_QUEUE_ITEM,s=t.SET_UPLOADED_ITEMS,o=t.ADD_TIME_OUT_TOKEN,i=t.CLEAR_TIME_OUT_TOKENS;return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{list:[],queue:[],uploadedItems:{},timeOutTokens:[]},u=arguments[1];switch(u.type){case n:return e.assign({},t,{list:u.list});case r:return e.assign({},t,{queue:u.queue});case a:var l=e.assign({},t.queue[u.queueItemIndex],u.flag),c=e.map(t.queue,function(e,t){return t===u.queueItemIndex?l:e});return e.assign({},t,{queue:c});case s:return e.assign({},t,{uploadedItems:u.uploadedItems});case o:var p=[].concat(_toConsumableArray(t.timeOutTokens),[u.timeOutToken]);return e.assign({},t,{timeOutTokens:p});case i:return e.assign({},t,{timeOutTokens:[]});default:return t}}}),define("stateManagement/store/createEditorStore",["lodash","reduxLibs","util","stateManagement/store/combineReducers","stateManagement/panels/panelsReducer","stateManagement/selection/selectionReducer","stateManagement/userProfile/userProfileReducer","stateManagement/highlights/highlightsReducer","stateManagement/pinMode/pinModeReducer","stateManagement/easterEggs/easterEggs","stateManagement/contextMenu/contextMenuReducer","stateManagement/panels/helpPropsReducer","stateManagement/legacy/legacyReducer","stateManagement/devMode/devModeReducer","stateManagement/store/initialEditorState","stateManagement/store/stateFreezer","stateManagement/leftBar/leftBarReducer","stateManagement/userPreferences/userPreferencesReducer","stateManagement/tpa/tpaReducer","stateManagement/uploadedFonts/uploadedFontsReducer"],function(e,t,n,r,a,s,o,i,u,l,c,p,d,f,g,m,E,P,_,M){"use strict";var T=t.redux,S=t.reduxThunk;return function(e,t){var h=d(r({openPanels:a,helpProps:p,devModeContext:f,stage:r({highlights:i}),contextMenu:c,pinMode:u,uploadedFonts:M,userProfile:o,selection:s,leftBar:E,tpa:_,userPreferences:P,easterEggs:l.reducer})),O=e?m(h):h,y=S.withExtraArgument(t),A=n.url.getParameterByName("debug")&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:T.compose;return T.createStore(O,g,A(T.applyMiddleware(y)))}}),define("stateManagement/store/throttledStore",["lodash","util"],function(e,t){"use strict";var n=function(e){return e()},r=t.animationFrameRenderer;return function(t,a,s){var o=[],i=function(){return e.forEach(o,n)},u=r(t,a,i),l=e.noop;s.subscribe(function(){l=u()});return e.defaults({subscribe:function(t){return o=e.concat(o,t),function(){o=e.without(o,t)}},dispatch:s.dispatch,getState:s.getState,flush:function(){l(),i()}},s)}}),define("stateManagement/legacy/setStateAction",["stateManagement/legacy/legacyActionTypes"],function(e){"use strict";var t=e.SET_STATE;return function(e){return{type:t,state:e}}}),define("stateManagement/preview/previewSelectors",[],function(){"use strict";return{isPreviewReady:function(e){return e.previewReady}}}),define("stateManagement/preview/preview",["stateManagement/preview/previewSelectors"],function(e){"use strict";return{selectors:e}}),define("stateManagement/popups/popupsSelectors",["stateManagement/preview/preview"],function(e){"use strict";var t=e.selectors.isPreviewReady;return{isPopUpMode:function(e,n){return Boolean(t(e)&&n.pages.popupPages.getCurrentPopupId())}}}),define("stateManagement/popups/popups",["stateManagement/popups/popupsSelectors"],function(e){"use strict";return{selectors:e}}),define("stateManagement/leftBar/leftBarActions",["stateManagement/leftBar/leftBarActionTypes"],function(e){"use strict";return{collapseDesktopMenu:function(){return{type:e.COLLAPSE_DESKTOP_MENU}},collapseMobileMenu:function(){return{type:e.COLLAPSE_MOBILE_MENU}},expandButton:function(t){return{type:e.EXPAND_BUTTON,panelName:t}},collapseButton:function(t){return{type:e.COLLAPSE_BUTTON,panelName:t}},updateButtonsBoundingRect:function(t){return{type:e.UPDATE_BUTTONS_BOUNDING_RECT,boundingRect:t}},setNotificationsCount:function(t,n){return{type:e.SET_NOTIFICATION_COUNT,panelName:t,count:n}},increaseNotificationsCount:function(t,n){return{type:e.INCREASE_NOTIFICATION_COUNT,panelName:t,count:n}},decreaseNotificationsCount:function(t,n){return{type:e.DECREASE_NOTIFICATION_COUNT,panelName:t,count:n}},removePanelNotifications:function(t){return{type:e.REMOVE_PANEL_NOTIFICATIONS,panelName:t}},updateDesktopSuperAppButton:function(t){return{type:e.UPDATE_DESKTOP_SUPERAPP_BUTTON,buttonParams:t}},updateMobileSuperAppButton:function(t){return{type:e.UPDATE_MOBILE_SUPERAPP_BUTTON,buttonParams:t}},removeSuperAppButton:function(t){return{type:e.REMOVE_SUPERAPP_BUTTON,panelName:t}}}}),define("stateManagement/leftBar/leftBarData",["util","coreBi","constants","experiment"],function(e,t,n,r){"use strict";return{desktop:function(){var a=[{panelName:"addPanelInfra.addPanel",panelProps:{},label:"LEFTBAR_ADD_LABEL",className:"add-panel",symbolName:"leftBarAddPanel",hintProps:{id:"AddPanel"}},{panelName:"tpa.compPanels.appMarketPanel",panelProps:{urlParams:{openMarketOrigin:"market_button"},openPanelBiEvent:e.bi.events.OPEN_MARKET_CLICK,openPanelBiParams:{referral_info:"market_button"}},label:"app_market_button_text",className:"app-market-panel",symbolName:"leftBarAppMarketPanel",hintProps:{id:"AppMarket"}},{panelName:"rEditor.panels.myMediaPanel",panelProps:{},label:"LEFTBAR_MY_UPLOADS_LABEL",className:"my-uploads-panel",symbolName:"leftBarMyUploadsPanel"}];r.isOpen("ChangeBG")||(a=[{panelName:"rEditor.panels.backgroundPanel",panelProps:{},label:n.ROOT_COMPS.LEFTBAR.BACKGROUND_LABEL,className:"bg-panel",symbolName:"leftBarBackgroundPanel",hintProps:{id:"ChangeBackgrounds"}}].concat(a));r.isOpen("newPagesPanel")&&(a=[{panelName:"pages.pagesPanel",panelProps:{openPanelBiEvent:t.events.pages.click_on_pages_panel_open,openPanelBiParams:{origin:"left_bar"}},label:"LEFTBAR_PAGES_LABEL",className:"pages-panel-pp",symbolName:"leftBarPagesPanelManager"}].concat(a));r.isOpen("us_addPages_leftBar")&&(a=[{panelName:"rEditor.panels.pagesAndPopupsPanel",panelProps:{},label:"Pages_Menu_Title_Title",className:"bg-panel",symbolName:"leftBarPagesPanel",hintProps:{id:"PagesPanel"}}].concat(a));return a}(),mobile:function(){var e=[];r.isOpen("newPagesPanel")&&e.push({panelName:"pages.pagesPanel",panelProps:{},label:"LEFTBAR_PAGES_LABEL",className:"pages-panel-pp",symbolName:"leftBarPagesPanelManager"});var t={panelName:"rEditor.panels.backgroundPanel",panelProps:{},label:n.ROOT_COMPS.LEFTBAR.BACKGROUND_LABEL,className:"bg-panel",symbolName:"leftBarBackgroundPanel",hintProps:{id:"ChangeBackgrounds"}},a={panelName:"mobileEditor.mobileElementsPanel",panelProps:{},label:"mobile_features_section_title_mobile_tools",className:"mobile-elements-panel",symbolName:"mobileView",tooltips:[{id:"mobileElementsPanel_quickActionBar_afterRemove",value:"mobile_quick_actions_hide_tooltip",width:"240px"}]};return r.isOpen("changeBG")?e.push(a,t):e.push(t,a),e=e.concat([{panelName:"mobileEditor.hiddenItemsPanel",panelProps:{},label:"mobile_hidden_items_panel_title",className:"hidden-items-panel",symbolName:"hiddenComp",hintProps:{id:"MobileEditorHiddenElements"}},{panelName:"mobileEditor.layoutOptimizerPanel",panelProps:{},label:"mobile_layoutoptimizer_title",className:"layout-optimizer-panel",symbolName:"mobile_left_bar_optimize_layout",hintProps:{id:"MobileLayoutOptimizer"}}])}(),myUploadsButton:{panelName:"rEditor.panels.myMediaPanel",panelProps:{},label:"LEFTBAR_MY_UPLOADS_LABEL",className:"my-uploads-panel",symbolName:"leftBarMyUploadsPanel"}}}),define("stateManagement/leftBar/leftBarSelectors",["lodash","reduxLibs","coreUtilsLib","stateManagement/leftBar/leftBarData","constants","experiment"],function(e,t,n,r,a,s){"use strict";var o=t.reselect.createSelector,i=function(e){return e.leftBar},u=function(e){return e.isMobileEditor},l=o(i,u,function(t,n){return e.get(t,n&&s.isOpen("se_mobileLeftBarNotCollapsed")?"isMobileCollapsed":"isCollapsed")}),c=o(i,function(e){return e.collapseOnClick});return{getLeftBar:i,isCollapsed:l,getCollapseOnClick:c,isMobileEditor:u,getDesktopSuperAppsCount:function(e){return e.leftBar.superApps.desktop.length},getMenuItems:function(t,o){var i=[],u=t.leftBar.superApps,l=[];return s.isOpen("enableMyUploadsButton")&&l.push(r.myUploadsButton),i=t.isMobileEditor?e.map(r.mobile,e.clone).concat(l,e.sortBy(n.objectUtils.cloneDeep(u.mobile),"order")):e.map(r.desktop,e.clone).concat(l,e.sortBy(n.objectUtils.cloneDeep(u.desktop),"order")),(i=o?function(t){var n=[a.ROOT_COMPS.LEFTBAR.BLOG_PANEL_NAME,a.ROOT_COMPS.LEFTBAR.BACKGROUND_PANEL_NAME];return e.filter(t,function(t){return!e.includes(n,t.panelName)})}(i):i).forEach(function(n,r){n.panelProps=n.panelProps||{},n.panelProps.panelIndex=r,n.collapseOnClick=function(t,n){return e.includes(t||[],n)}(c(t),n.panelName)}),e.compact(i).map(function(e){if("tpa.compPanels.appMarketPanel"===e.panelName){switch((s.getValue("se_appMarketIcons")||"old").toLowerCase()){case"icon1":e.symbolName="leftBarAppMarketPanel-B";break;case"icon2":e.symbolName="leftBarAppMarketPanel-C";break;case"icon3":e.symbolName="leftBarAppMarketPanel-D"}switch((s.getValue("se_appMarketLabels")||"old").toLowerCase()){case"add_apps":e.label="app_market_button_text_experiment_add_apps";break;case"get_apps":e.label="app_market_button_text_experiment_get_apps"}}return e})},getNotifications:function(e){return e.leftBar.notifications},getNotificationsCount:function(e,t){return e.leftBar.notifications[t]}}}),define("stateManagement/userPreferences/constants",[],function(){"use strict";return{EDITOR_APP_ID:"editorAppId"}}),define("stateManagement/userPreferences/getKeyFromAppId",["lodash","stateManagement/userPreferences/constants"],function(e,t){"use strict";return function(n,r){return e.defaultTo(n,t.EDITOR_APP_ID)+"_"+r}}),define("stateManagement/userPreferences/userPreferencesSelectors",["lodash","coreUtilsLib","stateManagement/userPreferences/constants","stateManagement/userPreferences/getKeyFromAppId"],function(e,t,n,r){"use strict";var a=function(e){return e.userPreferences.site},s=function(e){return e.userPreferences.global},o=function(e){return e.userPreferences.session},i=function(t,s){return function(o){if(s=s||n.EDITOR_APP_ID,!e.isString(t))throw new Error("Getting a user preference for the site expects a key of type string but received: "+t);var i=r(s,t),u=a(o);return u[i]&&u[i].value}},u=function(n){return function(r){var a=s(r);if(null===a)return t.log.error("Global user preferences failed to load!"),null;if(!e.isString(n))throw new Error("Getting a global user preference expects a key of type string but received: "+n);return a[n]}},l=function(t){return function(n){if(!e.isString(t))throw new Error("Getting a session user preference expects a key of type string but received: "+t);return o(n)[t]}};return{getSiteId:function(e){return e.userPreferences.siteId},getPreferences:function(e){return function(t){return t.userPreferences[e]}},arePreferencesEmpty:function(t){return function(n){return e.isEmpty(n.userPreferences[t])}},dontSaveUserPrefs:function(e){return e.userPreferences.dontSaveUserPrefs},getAllGlobalUserPreferences:function(e){var n=s(e);return null===n?(t.log.error("Global user preferences failed to load!"),null):n},getGlobalUserPreferences:u,getAllSiteUserPreferences:function(t){return function(t){return function(n){return e.transform(a(n),function(e,n,r){var a=r.split("_");a[0]===t&&(e[a[1]]=n.value)},{})}}(n.EDITOR_APP_ID)(t)},getSiteUserPreferences:i,getAllSessionUserPreferences:function(e){return o(e)},getSessionUserPreferences:l,getUserPreferences:function(e){switch(e){case"site":return i;case"session":return l;case"global":return u}},getMediaPath:function(e){return function(t){return l("last_media_path_"+e)(t)||""}}}}),define("stateManagement/userPreferences/userPreferencesActions",["stateManagement/userPreferences/userPreferencesActionTypes"],function(e){"use strict";return{setSiteId:function(t){return{type:e.SET_SITE_ID,siteId:t}},setPreferences:function(t,n){return{type:e.SET_PREFERENCES,typeId:t,preferences:n}},setPreference:function(t,n,r){return{type:e.SET_PREFERENCE,typeId:t,key:n,value:r}},markSitePreferencesNotDirty:function(){return{type:e.MARK_SITE_PREFERENCES_NOT_DIRTY}},dontSaveUserPreferences:function(){return{type:e.DONT_SAVE_USER_PREFERENCES}}}}),define("stateManagement/userPreferences/userPreferencesLogic",["lodash","jquery","coreUtilsLib","util","stateManagement/userPreferences/userPreferencesActions","stateManagement/userPreferences/userPreferencesSelectors","stateManagement/userPreferences/constants","stateManagement/userPreferences/getKeyFromAppId"],function(e,t,n,r,a,s,o,i){"use strict";var u,l=o.EDITOR_APP_ID,c=r.serviceTopology.premiumStateApiUrl,p=c?c.replace(/\/getTpaPremiumState/,"-user-preferences-webapp/"):"https://editor.wix.com/_api/wix-user-preferences-webapp/",d="site",f="global",g=(u={},_defineProperty(u,d,{load:function(e){return p+"getVolatilePrefsForSite/htmlEditor/"+e},SAVE:p+"bulkSet",DELETE:p+"delete"}),_defineProperty(u,f,{load:function(){return p+"getVolatilePrefForKey/htmlEditor/global_preferences"},SAVE:p+"set"}),u),m=function(){return r.url.isTrue("fakeUserPrefs")},E=function(e){return s.getSiteId(e())},P=function(t,n,r){return e.mapValues(t,function(t){return{value:e.isUndefined(r)?t:r,isDirty:n}})},_=function(e,t){t===d&&e(a.markSitePreferencesNotDirty())},M=function(r,o,i,u,l){if(null!==s.getPreferences(i)(o())){if(m()){var c=function(t,r){switch(r){case f:return{global_preferences:s.getPreferences(f)(t())};case d:var a={};return e.forEach(s.getPreferences(d)(t()),function(e,t){a[t]=e.value}),a.version=3,a;default:return n.log.error("unknown type ID"),{}}}(o,i);return window.sessionStorage.setItem("user_prefs_"+i,JSON.stringify(c)),_(i),void(u&&u())}if(!s.dontSaveUserPrefs(o())){var p=function(t,n){switch(n){case f:return{nameSpace:"htmlEditor",key:"global_preferences",blob:s.getPreferences(f)(t())};case d:return function(t,n){var r={nameSpace:"htmlEditor",siteId:E(t),data:{}};return e.forEach(n,function(e,t){e.isDirty&&(r.data[t]=e.value)}),r.data.version=3,r}(t,s.getPreferences(d)(t()))}}(o,i);p?t.ajax(g[i].SAVE,{type:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify(p),success:function(){_(i),u&&u()},error:function(e){413===e.status&&r(a.dontSaveUserPreferences()),l&&l(e)}}):u&&u()}}else l&&l("saving "+i+" preferences failed since they were not loaded")},T=function(o,u,c,p,_,T){o(a.setPreferences(c,p?function(r,a,s){switch(a){case f:return s.global_preferences;case d:return function(n,r){if(3===r.version)return P(r,!0);var a=e.assign({},e.omit(r,l,"version"),r[l]);return function(n,r){e.forEach(r,function(e,r){return function(e,n){m()||t.ajax(g.site.DELETE,{type:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify(function(e,t){return{nameSpace:"htmlEditor",key:t,siteId:E(e)}}(e,n))})}(n,r)})}(n,r),a=e.transform(a,function(e,t,n){e[i(l,n)]=t},{}),a.version=3,P(a,!0)}(r,s);default:return n.log.error("unknown type ID"),{}}}(u,c,p):{})),function(e){var t=r.url.getParameterByName("resetUserPrefs").toLowerCase();return"all"===t||t===e}(c)?function(e,t,n,r,o){switch(n){case f:return function(e,t,n,r){e(a.setPreferences(f,{})),M(e,t,f,n,r)}(e,t,r,o);case d:(function(e,t,n,r){e(a.setPreferences(d,P(s.getPreferences(d)(t()),!0,null))),M(e,t,d,n,r)})(e,t,r,o)}}(o,u,c,_,T):_&&_()},S=function(e,n,r,a,s){if(m()){var o=window.sessionStorage.getItem("user_prefs_"+r);T(e,n,r,JSON.parse(o),a,s)}else t.ajax(g[r].load(E(n)),{type:"GET",headers:{Accept:"application/json"},success:function(t){T(e,n,r,t,a,s)},error:function(e){s&&s(e)}})},h=function(t,r){return function(o,i){if(!e.isString(t))throw new Error("Setting a global user preference expects a key of type string but received: "+t);return new Promise(function(u,l){null===s.getPreferences(f)(i())?(n.log.error("Global user preferences failed to load!"),l("Global user preferences failed to load!")):(e.isUndefined(r)&&(r=null),o(a.setPreference(f,t,r)),M(o,i,f,u,l))})}},O=function(t,n,r){return function(s,o){if(!e.isString(t))throw new Error("Setting a user preference for the site expects a key of type string but received: "+t);return new Promise(function(u,c){r=r||l,e.isUndefined(n)&&(n=null);var p={value:n,isDirty:!0};t=i(r,t),s(a.setPreference(d,t,p)),E(o)?M(s,o,d,u,c):u()})}},y=function(t,n){return function(r){if(!e.isString(t))throw new Error("Setting a session user preference expects a key of type string but received: "+t);return r(a.setPreference("session",t,n)),n}};return{loadGlobalPreferences:function(){return function(t,r){return new Promise(function(s,o){S(t,r,f,s,function(r){if(r&&r.responseText&&3001===e.get(JSON.parse(r.responseText),"errorCode"))return t(a.setPreferences(f,{})),void s();t(a.setPreferences(f,null)),n.log.error("Global preferences failed to load!"),o("Global preferences failed to load!")})})}},loadSitePreferences:function(t,r){return function(o,i){return new Promise(function(u,l){var c=s.arePreferencesEmpty(d)(i());o(a.setSiteId(t));var p=e.partial(M,o,i,d,u,l);if(r)c||p();else if(c)S(o,i,d,p,function(){n.log.error("Site preferences failed to load!"),l("Site preferences failed to load!")});else{var f=s.getPreferences(d)(i());S(o,i,d,function(){o(a.setPreferences(d,e.merge(s.getPreferences(d)(i()),f))),p()},function(){n.log.error("Site preferences failed to load!"),p()})}})}},setGlobalUserPreferences:h,setSiteUserPreferences:O,setSessionUserPreferences:y,setSitePreferences:function(e){switch(e){case"site":return O;case"session":return y;case"global":return h}}}}),define("stateManagement/userPreferences/userPreferences",["stateManagement/userPreferences/userPreferencesSelectors","stateManagement/userPreferences/userPreferencesActions","stateManagement/userPreferences/userPreferencesLogic","stateManagement/userPreferences/userPreferencesReducer"],function(e,t,n,r){"use strict";return{logic:n,selectors:e,actions:t,reducer:r}}),define("stateManagement/panels/panelsActions",["stateManagement/panels/panelsActionTypes"],function(e){"use strict";var t=e.OPEN_PANEL,n=e.UPDATE_PANEL,r=e.CLOSE_ALL_PANELS,a=e.CLOSE_PANEL_BY_NAME,s=e.CLOSE_PANEL_BY_PROP,o=e.STAGE_MOUSE_DOWN,i=e.OPEN_HELP_CENTER,u=e.CLOSE_HELP_CENTER;return{openPanel:function(e){return{type:t,panelDescriptor:e}},updatePanel:function(e){return{type:n,panelDescriptor:e}},closeAllPanels:function(){return{type:r}},closePanelByName:function(e){return{type:a,panelName:e}},closePanelByPropKey:function(e,t){return{type:s,prop:e,propValue:t}},stageMouseDown:function(){return{type:o}},setPanelType:function(e,t,r){return{type:n,panelDescriptor:{name:e,frameType:t,singleInstance:r}}},openHelpCenter:function(e){return{type:i,helpPanelProps:e}},closeHelpCenter:function(){return{type:u}}}}),define("stateManagement/panels/panelsSelectors",["lodash","reduxLibs"],function(e,t){"use strict";var n=function(e){return e.openPanels};return{selectOpenPanels:n,selectOpenPlatformPanels:t.reselect.createSelector(n,function(t){return e.filter(t,{type:"platform"})}),selectHelpProps:function(e){return e.helpProps},isColorPickerClosed:t.reselect.createSelector(n,function(t){return!e.some(t,{name:"panels.toolPanels.colorPicker.colorPickerPanel"})}),isLinkDialogClosed:t.reselect.createSelector(n,function(t){return!e.some(t,{name:"panels.toolPanels.linkPanel"})})}}),define("stateManagement/devMode/devModeSelectors",[],function(){"use strict";return{selectDevModeContext:function(e){return e.devModeContext}}}),define("stateManagement/devMode/devModeActions",["stateManagement/devMode/devModeActionTypes"],function(e){"use strict";var t=e.RESET_CONTEXT;return{resetDevModeContext:function(){return{type:t}}}}),define("stateManagement/bi/bi",["lodash","util"],function(e,t){"use strict";return{event:function(n,r){return function(a,s,o){var i=o.dsWrite;if(i){n=e.defaults({},n,{src:38,endpoint:"editor",sampleRatio:0,esi:t.editorModel.editorSessionId}),r=[].concat(r)||[{}];var u=t.editorModel.permissionsInfo;if(u){var l=u.ownerId,c=e.map(u.loggedInUserRoles,"role").join(",");r=e.map(r,function(t){return e.assign({},t,{ownerId:l,roles:c})})}e.forEach(r,function(e){i.bi.event(n,e)})}}},error:function(e,t){return function(n,r,a){a.dsWrite.bi.error(e,t)}}}}),define("stateManagement/panels/panelsLogic",["lodash","util","stateManagement/panels/panelsSelectors","stateManagement/devMode/devModeSelectors","stateManagement/panels/panelsActions","stateManagement/devMode/devModeActions","stateManagement/bi/bi","coreUtilsLib","constants","coreBi"],function(e,t,n,r,a,s,o,i,u,l){"use strict";function c(t,n){return e.defaults({},n,{panelName:t,key:t+e.uniqueId()})}function p(t,n){t&&e.isFunction(t.resolve)&&t.resolve(n)}var d=r.selectDevModeContext,f=n.selectOpenPanels,g=n.selectOpenPlatformPanels,m=function(t){return function(n,r){var a=r(),o=f(a),i=e.difference(t,o),l=e.filter(i,{name:"platformPanels.fullStagePanel"});e.isEmpty(l)||d(a).type!==u.DEVELOPER_MODE.CONTEXT_TYPES.COLLECTION||n(s.resetDevModeContext())}},E=function(t,n,r){return function(s,o){r||s(_()),e.includes(t,"help")&&i.log.error("openPanel method is deprecated for help panels. Use openHelpCenter instead");var u=f(o()),l=e.find(u,{name:t});s(l&&l.singleInstance?a.updatePanel({name:t,props:n}):P(t,n))}},P=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(r){var s={name:t,props:c(t,n)};e.get(n,"token")&&e.assign(s,{token:e.get(n,"token")}),r(a.openPanel(s)),r(o.event(l.events.panels.PANEL_OPENED,{panel_name:t}))}},_=function(){return function(t,n){var r=n(),s=f(r);e.forEach(s,function(e){t(o.event(l.events.panels.PANEL_CLOSED,{panel_name:e.name}))}),function(t){e.forEach(t,function(e){p(e)})}(g(r)),t(a.closeAllPanels()),t(m(s))}},M=function(t,n){return function(r,s){var i=s(),u=f(i);e(i).thru(g).filter(function(e){return e.props[t]===n}).forEach(function(e){p(e)}),r(a.closePanelByPropKey(t,n));var c=f(s()),d=e.difference(u,c);e.forEach(d,function(e){r(o.event(l.events.panels.PANEL_CLOSED,{panel_name:e.props.panelName}))}),r(m(u))}},T=function(e){return function(t){t(M("panelName",e))}},S=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(r){r(_());var s={name:t,props:e.assign({},c(t,n),{useLastPanelPosition:!!n.useLastPanelPosition}),frameType:u.PANEL_TYPES.COMP};r(a.openPanel(s)),r(o.event(l.events.panels.PANEL_OPENED,{panel_name:t}))}};return{updateOrOpenPanel:E,openComponentPanel:S,openPlatformPanel:function(t){return function(n){var r=e.assign({name:t.panelName,props:c(t.panelName,t.panelProps),type:u.PANEL_TYPES.PLATFORM,token:t.panelProps.token},e.get(t,"panelMetaData",{}));n(E(r.name,r.props,!r.closeAllOtherPanels)),n(a.updatePanel(r))}},closeOpenedPanels:_,closePanelByPropKey:M,closePanelByName:T,openHelpCenter:function(n,r,s){return function(i){var c=[],p=function(){var n=t.editorModel.permissionsInfo;return n?"ownerId="+n.ownerId+"&roles="+e.map(n.loggedInUserRoles,"role").join(","):""}();p&&c.push(p),s&&s.component&&c.push("selectedCompType="+s.component);var d=n||u.GENERAL_HELP_KEY,f=c.length?d+"?"+c.join("&"):d,g=e.assign({},r,{helpUrl:f,biHelpParams:s,panelName:"panels.helpPanels.helpPanel"});i(a.openHelpCenter(g));var m=e.assign({learn_more:!1},s);i(o.event(l.events.help.HELP_CLICK,m))}},closeAllPanelsOfType:function(t){return function(n,r){var a=f(r());e(a).filter({frameType:t}).map("name").map(T).forEach(n)}},closePlatformPanel:function(t,n){return function(r,a){var s=f(a()),o=e.find(s,{token:t});o&&(p(o,n),r(T(o.name)))}},openFirstTimePanel:function(t){return function(n){if(e.includes(u.FIRST_TIME_PANEL_COMPONENTS,t)){var r="compPanels.panels."+t+".firstTime";n(S(r,{panelName:r,title:"firstTime"}))}}},updatePanel:function(e,t){return function(n){n(a.updatePanel({name:e,props:t}))}}}}),define("stateManagement/leftBar/leftBarLogic",["lodash","coreBi","constants","experiment","stateManagement/leftBar/leftBarActions","stateManagement/leftBar/leftBarSelectors","stateManagement/userPreferences/userPreferences","stateManagement/panels/panelsActions","stateManagement/panels/panelsLogic","stateManagement/bi/bi","stateManagement/userPreferences/userPreferencesSelectors"],function(e,t,n,r,a,s,o,i,u,l,c){"use strict";var p=l.event,d=function(){return function(e,t){e(s.isMobileEditor(t())&&r.isOpen("se_mobileLeftBarNotCollapsed")?a.collapseMobileMenu():a.collapseDesktopMenu())}};return{collapseMenu:d,collapseButton:function(e){return function(t){t(a.collapseButton(e)),t(o.logic.setSiteUserPreferences(e+n.LEFT_BAR.WAS_BUTTON_CLICKED_KEY,!0))}},openAddPanel:function(){return function(e){e(d()),e(u.updateOrOpenPanel("addPanelInfra.addPanel"))}},sendBIButtonsCount:function(r){return function(a,o,i){var u=i.dsRead,l=s.getMenuItems(o(),r),c=u&&u.generalInfo.getSiteId();if(c){var d=e.map(l,"panelName"),f={count:l.length,site_id:c,shoutout_bool:e.includes(d,n.SUPER_APPS.SHOUTOUT_PANEL_NAME),blog_bool:e.includes(d,n.SUPER_APPS.BLOG_PANEL_NAME),social_blog_bool:e.includes(d,n.SUPER_APPS.NEW_BLOG_PANEL_NAME),booking_bool:e.includes(d,n.SUPER_APPS.BOOKINGS_PANEL_NAME),ecomm_bool:e.includes(d,n.SUPER_APPS.WIX_STORE_PANEL_NAME),rest_bool:!1};a(p(t.events.leftBar.LEFT_BAR_NUMBER_OF_BUTTONS,f))}}},addSuperAppsButton:function(t,r,s,o,i,u,l,p){return function(d,f){var g=function(t,r,a,s,o,i){return{panelName:t,panelProps:r,label:a,className:s,symbolName:o,order:e.indexOf(n.LEFT_BAR.SUPER_APPS_ORDER.DESKTOP,t),isButtonOpen:i}}(t,r,s,o,i,p);d(a.updateDesktopSuperAppButton(g)),u&&d(a.updateMobileSuperAppButton(g));var m=c.getSiteUserPreferences(t+n.LEFT_BAR.WAS_BUTTON_CLICKED_KEY)(f());l&&!m&&d(a.expandButton(t))}},removeSuperAppsButton:function(e){return function(t){t(a.removeSuperAppButton(e)),t(a.removePanelNotifications(e)),t(i.closePanelByName(e))}}}}),define("stateManagement/leftBar/leftBar",["stateManagement/leftBar/leftBarLogic","stateManagement/leftBar/leftBarActions","stateManagement/leftBar/leftBarReducer","stateManagement/leftBar/leftBarSelectors","stateManagement/leftBar/leftBarData"],function(e,t,n,r,a){"use strict";return{logic:e,actions:t,reducer:n,selectors:r,leftBarData:a}}),define("stateManagement/dataFixers/dataFixers",["lodash","util","stateManagement/bi/bi","coreBi"],function(e,t,n,r){"use strict";return{runDataFixers:function(){return function(a){e.defer(function(){a(function(a,s,o){var i=o.dsRead,u=o.dsWrite,l=e.find(i.pages.getPagesData(),{appPageId:"7326bfbb-4b10-4a8e-84c1-73f776051e10"}),c=t.translate("Pages_Blog_Post_Title");l&&l.title!==c&&(u.pages.data.update(l.id,{title:c}),a(n.event(r.events.dataFixers.blogSinglePostFix,{msid:i.generalInfo.getMetaSiteId()})))})})}}}}),define("stateManagement/store/dsPaths.json",[],function(){return{read:["errors","generalInfo.getSiteId","generalInfo.getUserInfo","generalInfo.urlFormat.isSlash","generalInfo.isHttpsEnabled","generalInfo.getPublicUrl","generalInfo.getMetaSiteId","pages.getReference","pages.getFocusedPageId","pages.getPrimaryPageId","pages.getPagesData","pages.popupPages.getCurrentPopupId","components.isDescendantOfComp","components.getPage","components.data.get","components.getContainer","components.getAncestors","components.design.get","components.properties.get","components.getType","components.layout.getSnugLayout","components.layout.getSnugLayoutRelativeToScreen","components.layout.getSnugLayoutRelativeToScreenConsideringScroll","components.layout.getSnugLayoutRelativeToStructure","components.layout.canBeFixedPosition","components.layout.get","components.layout.getDock","components.layout.getRelativeToScreen","components.layout.isHorizontallyStretched","components.layout.isHorizontallyStretchedToScreen","components.is.horizontallyMovable","data.isItemValid","tpa.app.getDataByAppDefId","platform.controllers.connections.get","platform.controllers.getStageData","platform.controllers.connections.getConnectedComponents","platform.controllers.getStageData"],write:["waitForChangesApplied","components.setContainer","components.reparentComponentToPage","components.multiComponents.distribute","components.multiComponents.matchSize","bi.event","bi.error","renderPlugins.setCompsToShowOnTop","renderPlugins.setBlockingLayer","pages.data.update"]}}),define("stateManagement/legacy/legacyLogic",["lodash","stateManagement/popups/popups","stateManagement/leftBar/leftBar","stateManagement/dataFixers/dataFixers","stateManagement/store/dsPaths.json"],function(e,t,n,r,a){"use strict";var s=t.selectors.isPopUpMode;return{loadDocumentServices:function(t){return function(n,r,s){var o=e.pick(t,a.read),i=e.pick(t,a.write);e.assign(s,{dsRead:o,dsWrite:i})}},onPreviewReady:function(){return function(e,t,a){var o=a.dsRead,i=t();e(n.logic.sendBIButtonsCount(s(i,o))),e(r.runDataFixers())}}}}),define("stateManagement/legacy/legacy",["stateManagement/legacy/legacyReducer","stateManagement/legacy/setStateAction","stateManagement/legacy/legacyLogic"],function(e,t,n){"use strict";return{reducer:e,setState:t,logic:n}}),define("stateManagement/panels/panels",["stateManagement/panels/panelsActions","stateManagement/panels/panelsLogic","stateManagement/panels/panelsReducer","stateManagement/panels/helpPropsReducer","stateManagement/panels/panelsSelectors"],function(e,t,n,r,a){"use strict";return{actions:e,logic:t,reducer:n,helpPropsReducer:r,selectors:a}}),define("stateManagement/components/componentsSelectors",["lodash","constants"],function(e,t){"use strict";var n=function(n,r){if(n&&(e.isArray(n)&&n.length||n.id)){var a=e.isUndefined(n.length)&&n.id?[n]:n;return a.length>1?t.MULTISELECT.TYPE:r.components.getType(e.head(a))}return null},r=function(e,t){var n=function(e){return e.length?e:[e]}(e);return t.components.getContainer(n[0])};return{getCompType:n,getCompTypeSuffix:function(e,t){var r=n(e,t);return r&&r.split(".").pop()},getContainer:r,isRepeaterItem:function(e,t){if(!e)return!1;var a=r(e,t);return"wysiwyg.viewer.components.Repeater"===n(a,t)}}}),define("stateManagement/selection/selectionSelectors",["lodash","stateManagement/components/componentsSelectors"],function(e,t){"use strict";var n=function(e){return e.selection.selectedComponents};return{getSelectedCompsRefs:n,getSelectedComponentType:function(e,r){var a=n(e);return t.getCompTypeSuffix(a,r)},getSelectedCompRestrictions:function(t){return e.isEmpty(n(t))?{}:t.selection.compRestrictions}}}),define("stateManagement/selection/selectionActions",["stateManagement/selection/selectionActionTypes"],function(e){"use strict";var t=e.SELECT_COMPONENTS,n=e.ADD_TO_SELECTION,r=e.CLEAR_SELECTED_COMPONENTS,a=e.SET_SELECTED_COMPS_RESTRICTIONS;return{addToSelection:function(e){return{type:n,compRefs:e}},selectComponents:function(e){return{type:t,compRefs:e}},clearSelectedComponents:function(){return{type:r}},setSelectedCompsRestrictions:function(e){return{type:a,restrictions:e}}}}),define("stateManagement/highlights/highlightsActions",["stateManagement/highlights/highlightsActionTypes"],function(e){"use strict";var t=e.ADD_TO_HIGHLIGHTS,n=e.REMOVE_COMPS_FROM_HIGHLIGHTS,r=e.SET_HIGHLIGHTS,a=e.CLEAR_HIGHLIGHTS,s=e.REMOVE_FROM_HIGHLIGHTS_BY_HIGHLIGHT_TYPE;return{addToHighlights:function(e){return{type:t,highlightsDefs:e}},removeCompsFromHighlights:function(e){return{type:n,compRefs:e}},removeFromHighlightsByHighlightType:function(e){return{type:s,highlightTypes:e}},setHighlights:function(e){return{type:r,highlightsDefs:e}},clearHighlights:function(){return{type:a}}}}),define("stateManagement/highlights/highlightsSelectors",[],function(){"use strict";return{getHighlights:function(e){return e.stage.highlights}}}),define("stateManagement/stage/stageSelectors",[],function(){"use strict";return{isPerformingMouseMoveAction:function(e){return e.performingMouseMoveAction}}}),define("stateManagement/highlights/logic/itemHighlightsHelper",["lodash","uiConstants"],function(e,t){"use strict";return{getItemHighlight:function(e,n,r){return{compRef:n,layout:e.components.layout.getRelativeToScreen(n),type:r?t.HIGHLIGHTS.TYPES.THICK_WITH_OPACITY:t.HIGHLIGHTS.TYPES.THICK}},getManageItemsPanelHighlight:function(e,t,n){return{compRef:t,layout:e.components.layout.getRelativeToScreen(t),type:n}}}}),define("stateManagement/highlights/highlightsLogic",["lodash","uiConstants","stateManagement/highlights/highlightsActions","stateManagement/highlights/highlightsSelectors","stateManagement/selection/selectionSelectors","stateManagement/stage/stageSelectors","stateManagement/highlights/logic/itemHighlightsHelper"],function(e,t,n,r,a,s,o){"use strict";return{handleSelectionHighlights:function(){return function(r,s,i){var u=i.dsRead,l=[],c=a.getSelectedCompsRefs(s()),p=e.head(c);if(r(n.removeFromHighlightsByHighlightType([t.HIGHLIGHTS.TYPES.THICK_WITH_OPACITY,t.HIGHLIGHTS.TYPES.THICK])),p){var d=function(t,n){var r=t.platform.controllers.connections.get(n);if(e.isArray(r)){var a=e.find(r,function(n){var r=n.controllerRef,a=n.role,s=t.platform.controllers.getStageData(r);return e.get(s,["connections",a,"relatedToRole"])});if(a){var s=a.controllerRef,o=a.role,i=t.platform.controllers.connections.getConnectedComponents(s),u=t.platform.controllers.getStageData(s).connections[o];return e.filter(i,function(n){return e.head(t.platform.controllers.connections.get(n)).role===u.relatedToRole})}}}(u,p);if(!e.isEmpty(d))return d.forEach(function(e){return l.push(o.getItemHighlight(u,e,!1))}),void r(n.addToHighlights(l));if("wysiwyg.viewer.components.Repeater"===u.components.getType(u.components.getContainer(p)))return l.push(o.getItemHighlight(u,p,!1)),void r(n.addToHighlights(l));var f=u.components.getAncestors(p),g=e.find(f,function(e){return"wysiwyg.viewer.components.Repeater"===u.components.getType(u.components.getContainer(e))});g&&(l.push(o.getItemHighlight(u,g,!0)),r(n.addToHighlights(l)))}}},handleRepeaterManageItemsHighlights:function(e,r){return function(a,s,i){var u=i.dsRead,l=[],c=r?t.HIGHLIGHTS.TYPES.OVERLAY_WITH_OPACITY:t.HIGHLIGHTS.TYPES.OVERLAY;a(n.removeFromHighlightsByHighlightType([c])),l.push(o.getManageItemsPanelHighlight(u,e,c)),a(n.addToHighlights(l))}},updateHighlights:function(){return function(t,a,o){var i=o.dsRead,u=a(),l=r.getHighlights(u);if(!e.isEmpty(l)&&!s.isPerformingMouseMoveAction(u)){var c=e.map(l,function(t){return e.defaults({layout:i.components.layout.getRelativeToScreen(t.compRef)},t)});t(n.setHighlights(c))}}}}}),define("stateManagement/selection/selectionLogic",["lodash","stateManagement/selection/selectionSelectors","stateManagement/selection/selectionActions","stateManagement/highlights/highlightsLogic"],function(e,t,n,r){"use strict";return{selectComponents:function(a,s){return function(o,i){var u=t.getSelectedCompsRefs(i());e.isEqual(u,a)||(o(n.selectComponents(a)),o(r.handleSelectionHighlights()),o(n.setSelectedCompsRestrictions(s)))}}}}),define("stateManagement/selection/selection",["stateManagement/selection/selectionReducer","stateManagement/selection/selectionSelectors","stateManagement/selection/selectionActions","stateManagement/selection/selectionLogic"],function(e,t,n,r){"use strict";return{reducer:e,selectors:t,actions:n,logic:r}}),define("stateManagement/userProfile/userProfileSelectors",[],function(){"use strict";return{getUserProfile:function(e){return e.userProfile}}}),define("stateManagement/userProfile/userProfileActions",["stateManagement/userProfile/userProfileActionTypes"],function(e){"use strict";var t=e.SET_USER_PROFILE;return{setUserProfile:function(e){return{type:t,userProfile:e}}}}),define("stateManagement/userProfile/userProfile",["stateManagement/userProfile/userProfileReducer","stateManagement/userProfile/userProfileSelectors","stateManagement/userProfile/userProfileActions"],function(e,t,n){"use strict";return{reducer:e,selectors:t,actions:n}}),define("stateManagement/domain/domainSelectors",["lodash","util"],function(e,t){"use strict";var n=function(e){return e.generalInfo.urlFormat.isSlash()?"wixsite.com":"wix.com"},r=function(e,t){return t.generalInfo.isHttpsEnabled()?"https":"http"};return{getSiteProtocol:r,isDomainConnected:function(t,r){var a=r.generalInfo.getPublicUrl();return!e.isNil(a)&&!e.includes(a,n(r))},getFreeDomainPrefix:function(e,t){return r(0,t)+"://"+t.generalInfo.getUserInfo().name+"."+n(t)+"/"},doesUserOwnGoogleDomain:function(){var e=t.cookie.getCookie("wixClient");return e.indexOf("GOOGLE_DOMAIN")>0||e.indexOf("REGRU")>0}}}),define("stateManagement/domain/domain",["stateManagement/domain/domainSelectors"],function(e){"use strict";return{selectors:e}}),define("stateManagement/highlights/highlights",["stateManagement/highlights/highlightsLogic","stateManagement/highlights/highlightsReducer","stateManagement/highlights/highlightsSelectors","stateManagement/highlights/highlightsActions"],function(e,t,n,r){"use strict";return{logic:e,reducer:t,selectors:n,actions:r}}),define("stateManagement/tpa/tpaActions",["lodash","stateManagement/tpa/tpaActionTypes"],function(e,t){"use strict";var n=t.ADD_APP_IDS_TO_REFRESH_ON_DASHBOARD_CLOSE,r=t.SET_APP_IDS_TO_REFRESH_ON_DASHBOARD_CLOSE;return{addAppIdsToRefreshOnDashboardClose:function(e){return{type:n,appIds:e}},setAppIdsToRefreshOnDashboardClose:function(e){return{type:r,appIds:e}}}}),define("stateManagement/tpa/tpaLogic",["lodash","stateManagement/tpa/tpaActions"],function(e,t){"use strict";var n=function(t){return e.map(t,r)},r=function(e){return parseInt(e,10)},a=function(t,n){return e(t).map(n.tpa.app.getDataByAppDefId).map("applicationId").compact().value()};return{addAppDefIdsToRefreshOnDashboardClose:function(e){return function(r,s,o){var i=o.dsRead,u=a(e,i);r(t.addAppIdsToRefreshOnDashboardClose(n(u)))}},setAppDefIdsToRefreshOnDashboardClose:function(e){return function(r,s,o){var i=o.dsRead,u=a(e,i);r(t.setAppIdsToRefreshOnDashboardClose(n(u)))}}}}),define("stateManagement/tpa/tpaSelectors",["lodash"],function(e){"use strict";return{getAppIdsToRefreshAfterDashboardClose:function(t){return e.map(e.keys(t.tpa.appsIdsToRefreshOnDashboardClose),function(e){return parseInt(e,10)})}}}),define("stateManagement/tpa/tpa",["stateManagement/tpa/tpaLogic","stateManagement/tpa/tpaSelectors"],function(e,t){"use strict";return{logic:e,selectors:t}}),define("stateManagement/stage/stage",["stateManagement/stage/stageSelectors"],function(e){"use strict";return{selectors:e}}),define("stateManagement/uploadedFonts/logic/fontsUploader",["lodash","util"],function(e,t){"use strict";return{upload:function(n,r,a){if(r){var s=e.map(a,function(e){return{uploadFn:r.item.upload,source:{file:e,name:e.name,size:e.size,folderId:null,folderName:"All Media",mediaType:t.fontsManagerUtils.constants.FONTS_MEDIA_TYPE}}});n.Uploader.upload(s)}},clearUploadQueue:function(e){e.Uploader.uploadIsInProgress||e.Uploader.clearQueue()},getUploadQueue:function(e){return e.Uploader.uploadQueue},cancelUpload:function(e){var t=!1;if(e.canAbort())try{e.abort(),t=!0}catch(e){t=!1}return t},retryUpload:function(t){!e.isEmpty(t.Uploader.uploadQueue)&t.Uploader.uploadIsInProgress&&t.Uploader.upload()}}}),define("stateManagement/uploadedFonts/logic/uploadedFontsLogicUtils",["lodash","util","coreUtilsLib"],function(e,t,n){"use strict";var r=function(t){return e.map(t,function(t){return e.assign(t,{name:t.source.name})})},a=function(n){return e.map(n,function(n){if(n.status===t.fontsManagerUtils.constants.FONT_STATUS.SUCCEEDED){var r=e.get(n,"serverResponse.data");return e.assign({},n,t.fontsManagerUtils.getUploadedFontData(r))}return n})};return{getFontObject:function(n){return n=e.reject(n,function(e){return!e.fileInput}),e.map(n,function(e){return t.fontsManagerUtils.getUploadedFontData(e)})},buildUploadedItems:function(n){return e.transform(n,function(e,n){n.status===t.fontsManagerUtils.constants.FONT_STATUS.SUCCEEDED&&(e[n.id]={finished:!0})},{})},buildQueueItemForStore:function(t){var r=e.pick(t,["canceled","cssFontFamily","displayName","downloadUrl","error_code","fileUrl","fontFace","fontFamily","id","isAborted","name","removed","status","stillUploading"]);return r.source=n.objectUtils.cloneDeep(t.source),r.fileInput=n.objectUtils.cloneDeep(t.fileInput),r.fileOutput=n.objectUtils.cloneDeep(t.fileOutput),r.serverResponse=n.objectUtils.cloneDeep(t.serverResponse),r},getInitialQueueWithData:function(t){return e.flow([r,a])(t)},getNewQueueData:r}}),define("stateManagement/uploadedFonts/uploadedFontsActions",["stateManagement/uploadedFonts/uploadedFontsActionTypes"],function(e){"use strict";var t=e.SET_LIST,n=e.SET_QUEUE,r=e.SET_FLAG_TO_QUEUE_ITEM,a=e.SET_UPLOADED_ITEMS,s=e.ADD_TIME_OUT_TOKEN,o=e.CLEAR_TIME_OUT_TOKENS;return{setList:function(e){return{type:t,list:e}},setQueue:function(e){return{type:n,queue:e}},setFlagToQueueItem:function(e,t){return{type:r,queueItemIndex:e,flag:t}},setUploadedItems:function(e){return{type:a,uploadedItems:e}},addTimeOutToken:function(e){return{type:s,timeOutToken:e}},clearTimeOutTokens:function(){return{type:o}}}}),define("stateManagement/uploadedFonts/uploadedFontsSelectors",[],function(){"use strict";return{getList:function(e){return e.uploadedFonts.list},getQueue:function(e){return e.uploadedFonts.queue},getUploadedItems:function(e){return e.uploadedFonts.uploadedItems},getTimeOutTokens:function(e){return e.uploadedFonts.timeOutTokens}}}),define("stateManagement/uploadedFonts/logic/uploadedFontsLogic",["lodash","wixmp","coreBi","util","coreUtilsLib","stateManagement/bi/bi","stateManagement/uploadedFonts/logic/fontsUploader","stateManagement/uploadedFonts/logic/uploadedFontsLogicUtils","stateManagement/uploadedFonts/uploadedFontsActions","stateManagement/uploadedFonts/uploadedFontsSelectors"],function(e,t,n,r,a,s,o,i,u,l){"use strict";var c=l.getQueue,p=l.getUploadedItems,d=l.getTimeOutTokens,f=u.setList,g=u.setQueue,m=u.setFlagToQueueItem,E=u.setUploadedItems,P=u.addTimeOutToken,_=u.clearTimeOutTokens,M=r.fontsManagerUtils.constants,T=function(e,t){var n={mediaType:M.FONTS_MEDIA_TYPE};return n.paging={cursor:null,size:500},t.wixmpSource.items.list(null,n).then(function(t){var n=a.objectUtils.cloneDeep(t.data);e(f(i.getFontObject(n)))})},S=function(t,n){return function(r,a,s){var o=s.wixmpFonts;n.id&&e.assign(o.uploadQueue[t],{id:n.id}),r(m(t,n))}},h=function(){return function(n,r){var a=i.getInitialQueueWithData(e.map(o.getUploadQueue(t),i.buildQueueItemForStore)),s=i.buildUploadedItems(p(r()));n(g(a)),n(E(s)),O(n,r)}},O=function(t,n){var r=d(n());e.forEach(r,function(e){window.clearTimeout(e)}),t(_())},y=function(n,r){t.events.on(t.events.ITEMS.REMOVE,function(t){e.forEach(t,function(e){e.then(function(){return T(n,r)}).catch(function(e){a.log.error(e)})})})},A=function(n,a,s){t.Uploader.on("fileStatusChanged",function(t){t.currentFileProgress.status===M.FONT_STATUS.SUCCEEDED&&T(n,s);var o=c(a()),i={},u=t.currentFileQueueIdx,l=t.currentFileProgress.status;switch(i.status=l,l){case r.fontsManagerUtils.constants.FONT_STATUS.PROCESSING:I(n,o,u);break;case r.fontsManagerUtils.constants.FONT_STATUS.FAILED:var p=v(t,o,u);e.assign(i,p);break;case r.fontsManagerUtils.constants.FONT_STATUS.SUCCEEDED:var d=N(n,a,t,o,u);e.assign(i,d)}n(S(u,i))})},I=function(e,t,r){e(s.event(n.events.fontsUploadPanel.Start_Font_Upload_Process,{name:t[r].name}));var a=window.setTimeout(function(){e(S(r,{stillUploading:!0}))},3e4);e(P(a))},v=function(t,n,r){var s=e.get(t,"currentFileProgress.file.serverResponse.data"),o=e.get(s,"error_code")||"unknown";if(!n[r].canceled){var i=a.objectUtils.cloneDeep(n[r]);i.error_code=o,L(o,i)}return{error_code:o}},N=function(t,a,o,i,u){s.event(n.events.fontsUploadPanel.Fonts_Uploaded,{name:i[u].name});var l=e.get(o,"currentFileProgress.file.serverResponse.data"),c=_defineProperty({},l.id,!0),d=e.assign(_defineProperty({},l.id,{finished:!1}),p(a()),c);return t(E(d)),r.fontsManagerUtils.getUploadedFontData(l)},R=function(n,r,a){t.Uploader.on("queueChanged",function(t){a.uploadQueue=t;var s=c(r()),o=i.getNewQueueData(e.map(t,i.buildQueueItemForStore)),u=e.map(o,function(t,n){return e.defaults({},s[n],t)});n(g(u))})},C=function(){t.Uploader.on("uploadQueueFinished",function(){o.clearUploadQueue(t)})},L=function(e,t){var a=r.fontsManagerUtils.getErrorMessage(e).bi_msg;s.event(n.events.fontsUploadPanel.Upload_Failed,{message:a,name:t.name})};return{init:function(){return function(e,t,n){var r=n.wixmpFonts;T(e,r),e(h()),A(e,t,r),R(e,t,r),y(e,r),C()}},removeFonts:function(e){return function(t,n,r){r.wixmpFonts.wixmpSource.items.remove(e)}},assignFlagToQueueItem:S,cancelUpload:function(e){return function(t,n,r){var a=r.wixmpFonts;-1!==e&&o.cancelUpload(a.uploadQueue[e])&&t(S(e,{canceled:!0}))}},prepareUploadedFontsData:h,uploadItems:function(e){return function(n,r,a){var s=a.wixmpFonts;o.upload(t,s.wixmpSource,e)}},clearUploadQueue:function(){o.clearUploadQueue(t)}}}),define("stateManagement/uploadedFonts/uploadedFonts",["stateManagement/uploadedFonts/logic/uploadedFontsLogic","stateManagement/uploadedFonts/uploadedFontsReducer","stateManagement/uploadedFonts/uploadedFontsSelectors","stateManagement/uploadedFonts/uploadedFontsActions"],function(e,t,n,r){"use strict";return{logic:e,reducer:t,selectors:n,actions:r}}),define("stateManagement/componentMetaData/componentMetaData",["lodash","constants","experiment"],function(e,t,n){"use strict";var r=e.curryRight(e.every),a=function(t){return function(n,r){return!e.isEmpty(n)&&e.every(n,function(e){return t(e,r)})}},s=function(t){return!e.isUndefined(t.docked)&&t.fixedPosition},o=function(e,t){var n=t.components.layout.get(e);return n.docked=t.components.layout.getDock(e),s(n)};return{isHorizontallyMovable:a(function(e,t){return n.isOpen("layoutTractor")?t.components.is.horizontallyMovable(e)&&!o(e,t)&&!t.components.layout.isHorizontallyStretched(e):t.components.is.horizontallyMovable(e)&&!o(e,t)&&!t.components.layout.isHorizontallyStretchedToScreen(e)}),isPinnedBySerializedLayout:r(s),isPinned:a(o),isPlatformShowFocusBox:function(t,n){var r=n.platform.controllers.connections.get(t);if(!e.isEmpty(r))return e(r).map(function(t){return function(t,n){var r=n.controllerRef,a=n.role,s=t.platform.controllers.getStageData(r);return e.get(s,["connections",a,"showFocusBox"])}(n,t)}).find(e.isBoolean)},getPlatformFocusBoxNavType:function(){return t.UI.NAVIGATION_TYPES.TABS},getPlatformFocusBoxNavContent:function(e,t,n){return{tabs:[{id:"platform-tab",label:n,active:!0}],onTabClick:function(){return t.selection.selectComponentByCompRef(e)},translate:!1}}}}),define("stateManagement/applyModeFromClipboard/applyModeFromClipboardSelectors",[],function(){"use strict";return{selectApplyModeFromClipboardSuggestion:function(e){return e.applyModeFromClipboardSuggestion}}}),define("stateManagement/applyModeFromClipboard/applyModeFromClipboard",["stateManagement/applyModeFromClipboard/applyModeFromClipboardSelectors"],function(e){"use strict";return{selectors:e}}),define("stateManagement/pinMode/pinModeActions",["stateManagement/pinMode/pinModeActionTypes"],function(e){"use strict";return{openPinMode:function(){return{type:e.OPEN_PIN_MODE}},closePinMode:function(){return{type:e.CLOSE_PIN_MODE}},showPinPreviewRect:function(t){return{type:e.SHOW_PIN_PREVIEW_RECT,style:t}},hidePinPreviewRect:function(){return{type:e.HIDE_COMPONENT_PREVIEW_RECT}}}}),define("stateManagement/pinMode/pinModeSelectors",[],function(){"use strict";return{isOpen:function(e){return e.pinMode.isOpen},getPinnedCompType:function(e){return e.pinMode.pinnedCompType},getPinPreviewRectStyle:function(e){return e.pinMode.pinPreviewRectStyle}}}),define("stateManagement/pinMode/pinModeLogic",["lodash","constants","stateManagement/panels/panelsLogic","stateManagement/pinMode/pinModeActions","stateManagement/pinMode/pinModeSelectors","stateManagement/selection/selectionSelectors"],function(e,t,n,r,a,s){"use strict";var o={default:"compPanels.dynamicPanels.pinnedDockPanel",PopupContainer:t.COMP_PANELS.POPUP.CONTAINER.POPUP_GRID_LAYOUT_PANEL.NAME},i=t.EDITOR_API.BLOCKING_LAYER_STYLE,u=function(e){return o[e]||o.default};return{open:function(a,o){return function(l,c,p){var d=p.dsRead,f=p.tooltipManager,g=c(),m=s.getSelectedComponentType(g,d),E="WRichText"===m?["LEFT","MIDDLE","RIGHT"]:["MIDDLE"];f.hide(t.ROOT_COMPS.TOOLTIPS.FIRST_TIME_EXIT_POPUP_MODE);var P=e.assign({origin:a,selectedComponents:s.getSelectedCompsRefs(g),disabledValues:E},o);l(n.openComponentPanel(u(m),P)),l(function(t,n,r){var a=r.dsWrite,o=n();a.renderPlugins.setCompsToShowOnTop(e.map(s.getSelectedCompsRefs(o),"id")),a.renderPlugins.setBlockingLayer(i)}),l(r.openPinMode())}},close:function(){return function(e,t){var s=t();if(a.isOpen(s)){var o=a.getPinnedCompType(s);e(n.closePanelByName(u(o))),e(r.hidePinPreviewRect()),e(function(e,t,n){var r=n.dsWrite;r.renderPlugins.setCompsToShowOnTop(null),r.renderPlugins.setBlockingLayer(null)}),e(r.closePinMode())}}}}}),define("stateManagement/pinMode/pinMode",["stateManagement/pinMode/pinModeActions","stateManagement/pinMode/pinModeLogic","stateManagement/pinMode/pinModeReducer","stateManagement/pinMode/pinModeSelectors"],function(e,t,n,r){"use strict";return{actions:e,logic:t,reducer:n,selectors:r}}),define("stateManagement/contextMenu/contextMenuActions",["stateManagement/contextMenu/contextMenuActionTypes"],function(e){"use strict";return{openContextMenu:function(t){var n=t.editorPositionX,r=t.editorPositionY,a=t.viewerPositionX,s=t.viewerPositionY;return{type:e.OPEN_CONTEXT_MENU,editorPositionX:n,editorPositionY:r,viewerPositionX:a,viewerPositionY:s}}}}),define("stateManagement/contextMenu/contextMenuSelectors",[],function(){"use strict";var e=function(e){return e.pinMode.pinnedCompType};return{isOpen:function(t){return Boolean(e(t))},getPinnedCompType:e}}),define("stateManagement/contextMenu/contextMenu",["stateManagement/contextMenu/contextMenuActions","stateManagement/contextMenu/contextMenuReducer","stateManagement/contextMenu/contextMenuSelectors"],function(e,t,n){"use strict";return{actions:e,reducer:t,selectors:n}}),define("stateManagement/components/components",["stateManagement/components/componentsSelectors"],function(e){"use strict";return{selectors:e}}),define("stateManagement",["stateManagement/store/createEditorStore","stateManagement/store/throttledStore","stateManagement/legacy/legacy","stateManagement/panels/panels","stateManagement/leftBar/leftBar","stateManagement/selection/selection","stateManagement/userProfile/userProfile","stateManagement/domain/domain","stateManagement/highlights/highlights","stateManagement/tpa/tpa","stateManagement/stage/stage","stateManagement/uploadedFonts/uploadedFonts","stateManagement/componentMetaData/componentMetaData","stateManagement/applyModeFromClipboard/applyModeFromClipboard","stateManagement/bi/bi","stateManagement/pinMode/pinMode","stateManagement/easterEggs/easterEggs","stateManagement/contextMenu/contextMenu","stateManagement/components/components","stateManagement/store/combineReducers","stateManagement/dataFixers/dataFixers","stateManagement/userPreferences/userPreferences"],function(e,t,n,r,a,s,o,i,u,l,c,p,d,f,g,m,E,P,_,M,T,S){"use strict";return{createEditorStore:e,throttledStore:t,legacy:n,panels:r,leftBar:a,selection:s,userProfile:o,domain:i,highlights:u,tpa:l,stage:c,uploadedFonts:p,componentMetaData:d,applyModeFromClipboard:f,bi:g,pinMode:m,easterEggs:E,contextMenu:P,components:_,combineReducers:M,dataFixers:T,userPreferences:S}});
//# sourceMappingURL=stateManagement.min.js.map