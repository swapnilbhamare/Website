define("textCommon/mixins/textCompMixin",["lodash","prop-types","core","santaProps","utils"],function(t,e,n,i,o){"use strict";var s=o.xss.filterHtmlString;return{propTypes:{reportBI:i.Types.reportBI,id:i.Types.Component.id.isRequired,skin:i.Types.Component.skin.isRequired,style:i.Types.Component.style.isRequired,scale:i.Types.Component.scale.isRequired,title:e.string},mixins:[n.compMixins.skinBasedComp],componentWillMount:function(){this.updateHTML(this.props)},updateHTML:function(t){this._componentHtml=s(t.compData.text||"",{allowIframes:this.allowIframes}),this.convertCompDataTextToHTML(t)},componentWillReceiveProps:function(t){this.updateHTML(t)},getRootStyle:function(e){var n=t.clone(e||{});return"hidden"!==(n["overflow-y"]||n.overflowY)&&(n.height="auto"),n},getSkinProperties:function(){this.lastScale=this.props.scale||1;var e=this.props.skin,n={"":{style:this.getRootStyle(this.props.style)}},i=void 0;i="wysiwyg.viewer.skins.WRichTextSkin"===e||"wysiwyg.viewer.skins.WRichTextClickableSkin"===e?n.richTextContainer={}:n[""],t.isString(this._componentHtml)?i.dangerouslySetInnerHTML={__html:this._componentHtml||""}:i.children=this._componentHtml,this.props.title&&(n[""].title=this.props.title);var o=t.get(this.props,["compProp","overrideAlignment"]);return o&&(i.className=this.classSet(t.zipObject(["override-"+o],[!0]))),n}}}),define("textCommon/mixins/textScaleMixin",["lodash","skins","utils","santaProps","siteUtils","core"],function(t,e,n,i,o,s){"use strict";function r(t){return t.scale||1}var a=n.fonts.fontUtils;return{mixins:[s.compMixins.skinInfo],propTypes:{compTheme:i.Types.Component.theme,scale:i.Types.Component.scale,skin:i.Types.Component.skin,isMobileView:i.Types.isMobileView,fontsMap:i.Types.Fonts.fontsMap,isExperimentOpen:i.Types.isExperimentOpen},componentWillMount:function(){this.lastScale=r(this.props)},componentWillReceiveProps:function(){this.lastScale=r(this.props)},fontGetter:function(t){var e=t.split("_")[1];return this.props.fontsMap[e]},getFontSize:function(t,e){var n={};if(this.props.isMobileView){var i=this.getDesktopFontSize(t);if(i){var s=e||this.props.scale;n.fontSize=function(t,e){return o.mobileUtils.convertFontSizeToMobile(t,e)}(i,s)+"px"}}return n},getDesktopFontSize:function(n){var i=this.props.compTheme,o=n||"fnt",s=t.get(i,["style","properties",o])||t.get(e.skinsMap.get(this.props.skin,this.props.isExperimentOpen),["paramsDefaults",o])||function(){var n=e.skinsMap.get(this.props.skin,this.props.isExperimentOpen),i=n&&n.exports,o=t.find(i,function(e){var n=e.skin;return!t.isUndefined(this.getParamFromSkin("fnt",n).value)}.bind(this));return o&&this.getParamFromSkin("fnt",o.skin).value}.call(this);if(s){var r=this.fontGetter(s)||s;return parseInt(a.parseFontStr(r).size,10)}}}}),define("textCommon/mixins/baseTextInput",["lodash","prop-types","santaProps","core"],function(t,e,n,i){"use strict";function o(t){return{$label:t.compProp.label?"hasLabel":"noLabel"}}var s=i.compMixins,r={style:{display:"none"}},a=function(t){return i.compMixins.validatableMixin.getPublicState(t)};return{mixins:[s.skinBasedComp,s.runTimeCompData,s.validatableMixin.validatable,s.compStateMixin(a)],propTypes:{compData:n.Types.Component.compData.isRequired,compProp:n.Types.Component.compProp.isRequired,structure:n.Types.Component.structure.isRequired,shouldResetComponent:n.Types.RenderFlags.shouldResetComponent,isPreset:e.bool,onChange:e.func,message:e.string},BASE_TEXT_BEHAVIORS:t.assign({},i.compMixins.validatableMixin.VALIDATABLE_BEHAVIORS),getInitialState:function(){return t.assign(a(),o(this.props),{value:this.props.compData.value})},componentWillReceiveProps:function(e){e.shouldResetComponent&&e.shouldResetComponent!==this.props.shouldResetComponent&&this.hideValidityIndication();var n=o(e);t.has(e.compData,"value")&&e.compData.value!==this.state.value&&(n.value=e.compData.value),this.setState(n)},_handleClick:function(t){this.props.isPreset&&t.target.select()},setCustomValidity:function(t){this.refs.input.setCustomValidity(t)},_handleChange:function(t){var e=t.target.value;e!==this.state.value&&(this.setState({value:e},function(){this.updateData({value:e})}.bind(this)),this.latestChangeEvent=t)},_handleBlur:function(t){this.props.onChange&&this.props.onChange(t),this.handleAction("blur",t),this.latestChangeEvent&&(this.handleAction("change",this.latestChangeEvent),this.latestChangeEvent=null),this.showValidityIndication()},_handleFocus:function(t){this.handleAction("focus",t)},_handleKeyDown:function(t){this.handleAction("keyPress",t)},getBaseTextInputSkinProperties:function(){var e=this.props.compProp;return{label:e.label?{children:e.label}:r,input:function(){var e=this.props.compProp,n=this.props.compData,i={type:n.textType,name:n.name||this.props.structure.nickname,value:this.state.value,onChange:this._handleChange,onBlur:this._handleBlur,onFocus:this._handleFocus,onClick:this._handleClick,onKeyDown:this._handleKeyDown,disabled:e.isDisabled,required:e.required,readOnly:e.readOnly,placeholder:e.placeholder,tabIndex:e.tabIndex};return"number"===i.type&&t.assign(i,{min:n.min,max:n.max}),n.pattern&&t.assign(i,{pattern:n.pattern}),n.maxLength&&t.assign(i,{maxLength:n.maxLength}),e.autoComplete&&"password"!==i.type&&(i.autoComplete="on"),i}.call(this),message:this.props.message?{children:this.props.message,style:{whiteSpace:"normal"}}:r}}}}),define("textCommon/utils/textTransforms",["lodash","siteUtils","coreUtils","color"],function(t,e,n,i){"use strict";function o(t){var e=parseFloat(t);if(!isNaN(e))return e}function s(e){if(e)return t.head(e.split(","))}function r(t){if(t)return new i(y.normalizeColorStr(t))}function a(t,e,n){var i=t.getAttribute("style")||"",o=i.replace(new RegExp("(?:(^|;)\\s*)"+e+"\\s*:\\s*(?:.*?)\\s*(?:;|$)"),"$1")+(""!==i&&";"!==i[i.length-1]?";":"")+e+":"+n;t.setAttribute("style",o)}function l(t,n,i){if(n.fontSize&&n.fontSize%1==0&&(t.style.fontSize||h(t,i))){var o=parseFloat(i.scale);a(t,"font-size",Math.round(e.mobileUtils.convertFontSizeToMobile(n.fontSize,o))+"px")}}function p(e,n,i){if(function(e){if("a"!==e.tagName.toLowerCase())return;var n=c(e);if(n)!function(e,n){e.style.color=n,e.className=e.className.replace(/\bcolor_\d+\b/,""),t.isEmpty(e.className)&&e.removeAttribute("class")}(n,"#0000FF");else{var i=e.ownerDocument.createElement("span");i.style.color="#0000FF",function(t,e){var n=t.parentNode,i=function(t){for(var e=t.parentNode,n=0;n<e.childNodes.length;n++)if(e.childNodes[n]===t)return n}(t);e.appendChild(t),n.insertBefore(e,n.childNodes[i])}(e,i)}}(e),!function(e){return e&&t.includes(["ol","ul"],e.tagName.toLowerCase())}(e)){var o=h(e,i);o&&(t.includes(e.getAttribute("style"),"line-height")||a(e,"line-height",o.lineHeight))}}function c(e){var n=e.parentElement;return n&&"span"===n.tagName.toLowerCase()&&1===n.childNodes.length?function(e){return!t.isEmpty(e.style.color)||e.className.match(/\bcolor_\d+\b/)}(n)?n:c(n):null}function u(t,e,n){if(e.color){var o=h(t,n);if(t.style.color||f(t,o,n)){var s=parseFloat(n.brightness);a(t,"color",function(t,e){var n="#000000"!==t.hexString()?t.clone():new i("#121212");return n.lightness(n.hslArray()[2]*(e||1)),n}(e.color,s).rgbaString())}}}function m(t,e,n){var i=h(t,n);if(t.style.color||f(t,i,n)||function(t){return!(!t||!t.color)}(i)){a(t,"color",n.overrideColor.replace(/(^\d+,\d+,\d+,\d+$)/,"rgba($1)"))}}function h(t,e){var n=/(?:\s|^)(font_\d+)(?:\s|$)/g.exec(t.className);if(n){var i=e.fontGetter&&e.fontGetter(n[1]);return i?y.parseFontStr(i):void 0}}function f(e,n,i){var o=function(t){var e=/(?:\s|^)(color_\d+)(?:\s|$)/g.exec(t.className);if(e)return e[1]}(e)||function(e){var n=/^{(color_\d+)}$/.exec(t.get(e,"color"));if(n)return n[1]}(n);if(o){var s=i.colorGetter&&i.colorGetter(o);return s||void 0}}function d(e,n,i,a){var l=t.defaults(function(e){var n=t(e.style).pick(["fontSize","fontFamily","color"]).omitBy(t.isEmpty).value();return{fontSize:o(n.fontSize),fontName:s(n.fontFamily),color:r(n.color)}}(e),function(e,n){var i=h(e,n),a=f(e,i,n);return{fontSize:o(t.get(i,"size")),fontName:s(t.get(i,"family")),color:r(a)}}(e,a),n);t.forEach(e.children,function(t){d(t,l,i,a)}),t.invokeMap(i,"call",null,e,l)}function v(t,e,n){d(t,{characterCount:t.textContent.length},e,n)}function g(e,n){var i=function(e){var n=[];return e.overrideColor?n.push(t.partial(m,t,t,e)):e.brightness&&1!==parseFloat(e.brightness)&&n.push(t.partial(u,t,t,e)),e.scale&&n.push(t.partial(l,t,t,e)),e.fixMigratedStyle&&n.push(t.partial(p,t,t,e)),n}(n);if(0===i.length)return e;var o=x.document.createDocumentFragment().appendChild(x.document.createElement("div"));return o.innerHTML=e,t.forEach(o.children,t.partial(v,t,i,n)),o.innerHTML}var y=n.cssUtils,x=n.fragment;return"undefined"!=typeof window&&window.addEventListener("message",function(e){"show-always"===e.data&&(window.showAlways=!window.showAlways,t.forEach(window.document.getElementsByClassName("text-info-n47t"),function(t){window.showAlways?t.classList.add("show-always"):t.classList.remove("show-always")}))}),{applyMobileAdjustments:g,applyTextStyleMigrationAdjustments:function(t,e){return g(t,{fontGetter:e,fixMigratedStyle:!0})}}}),define("textCommon/utils/textComponentsUtils",["lodash","coreUtils","textCommon/utils/textTransforms","experiment","utils"],function(t,e,n,i,o){"use strict";var s=e.anchorTagsGenerator,r=o.xss.filterHtmlString;return{convertDataQueryLinksIntoHtmlAnchors:function(e,n,i){if(!n)return e;if(!i)return e.replace(/<a ([^>]*)dataquery="([^"]+)"([^>]*)>/g,function(e,i,o,s){return r("<a "+i+t.map(n[o],function(t,e){return e+'="'+t+'"'}).join(" ")+s+">")});var o=t.transform(n,function(t,e){t["#"+e.id]=e},{});return e.replace(/<a ([^>]*)dataquery="([^"]+)"([^>]*)>/g,function(e,n,s,a){var l=i(o[s]);return r("<a "+n+t.map(l,function(t,e){return e+'="'+t+'"'}).join(" ")+a+">")})},mobileTextTransformIfNeeded:function(t,e){return e.isMobileView?t=n.applyMobileAdjustments(t,e):t},createImpliedLinks:function(t){var e=s.getIncludedPatterns(i,t.isMobileView);return s.generateAnchorsInHtml(t.htmlContent,e)},applyTextStyleMigrationAdjustments:function(t,e){return n.applyTextStyleMigrationAdjustments(t,e)}}}),define("textCommon",["textCommon/mixins/textCompMixin","textCommon/mixins/textScaleMixin","textCommon/mixins/baseTextInput","textCommon/utils/textComponentsUtils"],function(t,e,n,i){"use strict";return{textCompMixin:t,textScaleMixin:e,textComponentsUtils:i,baseTextInput:n}});
//# sourceMappingURL=textCommon.min.js.map