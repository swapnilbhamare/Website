define("wixCodeInit/utils/urlBuilder",[],function(){"use strict";function e(e){return Object.keys(e).map(function(t){return encodeURIComponent(t)+"="+encodeURIComponent(e[t])}).join("&")}return{buildUrl:function(t,i,o){o=o||{};var n=!!t.publicModel,r=function(e,t,i,o){var n=o?"pub":"dev",r="//"+t.instanceId+"."+n+".",a=e.serviceTopology.wixCloudBaseDomain,s="node_modules/santa-wix-code/"+(i.useWixCodeFallback?"fallback.html":"index.html");return r+function(){for(var e=arguments[0],t=1;t<arguments.length;++t)e=e.replace(/\/$/,"")+"/"+arguments[t].replace(/^\//,"");return e}(a,"_partials",function(e,t){var i=e.serviceTopology,o=function(e){return/^https?:\/\/localhost(:[0-9]+)?\/?$/.test(e)}(e.santaBase)||function(e){return/^https?:\/\/s3.amazonaws.com\/integration-tests-statics\/(.+)\/SNAPSHOT\/santa?$/.test(e)}(e.santaBase)?i.scriptsLocationMap.santa:e.santaBase;return o=function(e,t){var i=e.lastIndexOf("/");return/^\d+\.\d+\.\d+$/.test(t)?e.substring(0,i+1)+t:e}(o,t),/(.*\/services\/)?(.*)/.exec(o)[2]}(e,i.runtimeSource),s)}(t,i,o,n),a="undefined"!=typeof window&&!window.clientSideRender,s="undefined"==typeof window||window.isPseudoWindow,c={compId:"wixCode_"+i.appDefinitionId,deviceType:o.isMobileView?"mobile":"desktop",viewMode:n?"site":t.renderFlags.componentViewMode||"preview",renderCycle:a&&!s?2:1,renderingEnv:s?"backend":"browser",locale:t.rendererModel.languageCode,wixCodeBase:t.santaBase+"/node_modules/santa-wix-code","wix-code-platform":t.serviceTopology.scriptsLocationMap["wix-code-platform"]};return o.sdkSource&&(c.sdkSource=o.sdkSource),o.semiNativeSDKSource&&(c.semiNativeSDKSource=o.semiNativeSDKSource),o.applications&&(c.applications=JSON.stringify(o.applications)),o.ReactSource&&(c.ReactSource=o.ReactSource),o.ReactLibSource&&(c.ReactLibSource=o.ReactLibSource),o.ReactDomSource&&(c.ReactDomSource=o.ReactDomSource),r+"?"+e(c)},buildStaticUrl:function(t,i){i=i||{};var o=t.santaBase+"/node_modules/santa-wix-code/"+(i.useWixCodeFallback?"fallback.html":"index.html"),n=!!t.publicModel,r={deviceType:i.isMobileView?"mobile":"desktop",viewMode:n?"site":t.renderFlags.componentViewMode||"preview",locale:t.rendererModel.languageCode};return i.sdkSource&&(r.sdkSource=i.sdkSource),i.semiNativeSDKSource&&(r.semiNativeSDKSource=i.semiNativeSDKSource),i.applications&&(r.applications=JSON.stringify(i.applications)),i.ReactSource&&(r.ReactSource=i.ReactSource),i.ReactLibSource&&(r.ReactLibSource=i.ReactLibSource),i.ReactDomSource&&(r.ReactDomSource=i.ReactDomSource),o+"?"+e(r)}}}),define("wixCodeInit/utils/iFrameUtils",["lodash"],function(e){"use strict";return{getIFrameForApp:function(t,i){var o=window.document.createElement("iframe");return o.style.cssText="position: fixed; left: 0; right: 0; top: 0; bottom: 0; width: 1px; height: 1px; background: transparent; border: 0",o.tabIndex=-1,o.setAttribute("aria-hidden","true"),o.src=t,e.get(i,"applicationId")&&e.get(i,"appDefinitionId")&&(o.setAttribute("data-app-id",i.applicationId),o.setAttribute("data-app-definition-id",i.appDefinitionId)),o},isIFrameEvent:function(e,t){return t.source===e.contentWindow}}}),define("wixCodeInit/api/wixCodeAppApi",["lodash","platformInit","wixCodeInit/utils/urlBuilder","wixCodeInit/utils/iFrameUtils"],function(e,t,i,o){"use strict";function n(t){var i=t.rendererModel.clientSpecMap.toJS?t.rendererModel.clientSpecMap.toJS():t.rendererModel.clientSpecMap;return!!t.rendererModel.wixCodeModel&&e.some(i,{type:"siteextension"})}function r(){function e(e,r,s){if(d)console.warn("Wix code is already initiated");else{var p=t.appsUtils.getAppsBaseInfo({clientSpecMap:r,serviceTopology:e.serviceTopology,rendererModel:e.rendererModel}).length>0,u=void 0;if(n(e)){var l=t.specMapUtils.getAppSpec(r);u=i.buildUrl(e,l,s),f=o.getIFrameForApp(u,l)}else{if(!p)return;u=i.buildStaticUrl(e,s),f=o.getIFrameForApp(u,{})}var m=function(e,i){o.isIFrameEvent(e,i)&&(function(e){return("PLATFORM_IFRAME"===e.intent||"WIX_CODE"===e.intent)&&"wix_code_iframe_loaded"===e.type}(i.data)&&c.setMessageHandler(function(t){e.contentWindow.postMessage(t,"*")}),t.biUtils.shouldUseFallbackReportBI(i.data,a)&&t.biUtils.reportBiWithWixBiSession(i.data),a.forEach(function(e){e(i.data)}))}.bind(null,f);window.addEventListener("message",m,!1),function(e){function t(){var t=window.document.body;t.insertBefore(e,t.firstChild),window&&window.performance&&window.performance.mark&&window.performance.mark("platform-iframe-added-to-dom")}"loading"!==window.document.readyState?t():window.document.addEventListener("DOMContentLoaded",function(){t()})}(f),d=!0}}function r(e){e&&c.sendOrHoldMessage(function(e){return s.reduce(function(e,t){return t(e)},e)}(e))}var a=[],s=[],c=t.messageProxy.get(),d=!1,p=!0,u=null,l=null,m=null,f=void 0;return{init:e,destroyAppsContainer:function(){f&&(f.remove(),d=!1,c=t.messageProxy.get(),f=void 0)},sendMessage:r,registerMessageHandler:function(e){a.push(e)},registerMessageModifier:function(e){s.push(e)},unregisterMessageHandler:function(e){var t=a.indexOf(e);-1!==t&&a.splice(t,1)},preLoadWidgets:function(e,i){!u&&n(e)&&t.widgetsPreLoader.asyncGetPreLoadMessage(e,i,function(e){p&&!u&&(u=e,c.sendOrHoldMessage(u))})},preLoadUserCode:function(e,i){(!l&&n(e)||t.appsUtils.getAppsBaseInfo({clientSpecMap:e.rendererModel.clientSpecMap,serviceTopology:e.serviceTopology,rendererModel:e.rendererModel}))&&t.widgetsPreLoader.asyncGetPreLoadUserCodeMessage(e,i,function(e){l||(l=e,c.sendOrHoldMessage(l))})},preInitWidgets:function(e,i){!m&&n(e)&&t.widgetsPreLoader.asyncGetPreInitMessage(e,i,function(e){m||(m=e,c.sendOrHoldMessage(m))})},isAppInitiated:function(){return d},getAppsIframe:function(){return f}}}return{getApi:r}}),define("wixCodeInit/api/initMainR",["lodash","platformInit"],function(e,t){"use strict";function i(i){function a(e){if(s.init(c,e,M),function(e){return t.specMapUtils.getAppSpec(e)||M.applications.length}(e)){s.preLoadUserCode(c,u);!!c.publicModel&&s.preLoadWidgets(c,u)}}var s=i.appApi,c=i.siteModel,d=i.isMobileView,p=i.queryUtil,u=i.currentUrl,l=i.isBot;u=u||window.document.location.href;var m=e.trimEnd(c.serviceTopology.scriptsLocationMap["js-wixcode-sdk"],"/")+"/lib/"+(p.getParameterByName("debug")?"wix.js":"wix.min.js"),f=o||e.trimEnd(c.serviceTopology.scriptsLocationMap["semi-native-sdk"],"/")+"/lib/"+(p.getParameterByName("debug")?"wix.js":"wix.min.js"),g=function(e){return"false"!==e&&("true"===e||!window.Worker||l)}(p.getParameterByName("useWixCodeFallback")),w=n+(p.getParameterByName("debug")?".development.js":".production.min.js"),S=r+(p.getParameterByName("debug")?".development.js":".production.min.js"),M={isMobileView:d,sdkSource:m,semiNativeSDKSource:f,runtimeSource:p.getParameterByName("WixCodeRuntimeSource"),ReactLibSource:w,ReactDomSource:S,ReactSource:p.getParameterByName("ReactSource"),useWixCodeFallback:g},v=p.getParameterByName("viewerPlatformAppSources");M.applications=t.appsUtils.getAppsBaseInfo({rendererModel:c.rendererModel,clientSpecMap:c.rendererModel.clientSpecMap,serviceTopology:c.serviceTopology,viewerPlatformAppSources:v,santaBase:c.santaBase}),a(c.rendererModel.clientSpecMap)}var o="//static.parastorage.com/services/semi-native-sdk/1.7.0/lib/wix.min.js",n="//unpkg.parastorage.com/react@16.0.0/umd/react",r="//unpkg.parastorage.com/react-dom@16.0.0/umd/react-dom";return i}),define("wixCodeInit",["wixCodeInit/api/wixCodeAppApi","wixCodeInit/api/initMainR","platformInit"],function(e,t,i){"use strict";return{getAppApi:e.getApi,initMainR:t,appsUtils:i.appsUtils,specMapUtils:i.specMapUtils,registerDeps:i.registerDeps}});
//# sourceMappingURL=wixCodeInit.min.js.map